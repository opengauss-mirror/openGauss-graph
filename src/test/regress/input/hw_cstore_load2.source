--
-- BULK LOAD
--
SET ENABLE_FAST_QUERY_SHIPPING=FALSE;
SET ENABLE_VECTOR_ENGINE=TRUE;
SET PARTITION_MAX_CACHE_SIZE='32MB';

CREATE TABLE LINEITEM_PART_DATE
(
    L_ORDERKEY    BIGINT NOT NULL
  , L_PARTKEY     BIGINT NOT NULL
  , L_SUPPKEY     BIGINT NOT NULL
  , L_LINENUMBER  BIGINT NOT NULL
  , L_QUANTITY    DECIMAL(15,2) NOT NULL
  , L_EXTENDEDPRICE  DECIMAL(15,2) NOT NULL
  , L_DISCOUNT    DECIMAL(15,2) NOT NULL
  , L_TAX         DECIMAL(15,2) NOT NULL
  , L_RETURNFLAG  CHAR(1) NOT NULL
  , L_LINESTATUS  CHAR(1) NOT NULL
  , L_SHIPDATE    DATE NOT NULL
  , L_COMMITDATE  DATE NOT NULL
  , L_RECEIPTDATE DATE NOT NULL
  , L_SHIPINSTRUCT CHAR(25) NOT NULL
  , L_SHIPMODE     CHAR(10) NOT NULL
  , L_COMMENT      VARCHAR(44) NOT NULL
)
with (orientation=column)
distribute by hash(L_ORDERKEY)
partition by range(L_SHIPDATE)
(
 partition p1 values less than('1992-01-09 00:20:00'),
 partition p2 values less than('1992-01-16 00:40:00'),
 partition p3 values less than('1992-01-23 01:00:00'),
 partition p4 values less than('1992-01-30 01:20:00'),
 partition p5 values less than('1992-02-06 01:40:00'),
 partition p6 values less than('1992-02-13 02:00:00'),
 partition p7 values less than('1992-02-20 02:20:00'),
 partition p8 values less than('1992-02-27 02:40:00'),
 partition p9 values less than('1992-03-05 03:00:00'),
 partition p10 values less than('1992-03-12 03:20:00'),
 partition p11 values less than('1992-03-19 03:40:00'),
 partition p12 values less than('1992-03-26 04:00:00'),
 partition p13 values less than('1992-04-02 04:20:00'),
 partition p14 values less than('1992-04-09 04:40:00'),
 partition p15 values less than('1992-04-16 05:00:00'),
 partition p16 values less than('1992-04-23 05:20:00'),
 partition p17 values less than('1992-04-30 05:40:00'),
 partition p18 values less than('1992-05-07 06:00:00'),
 partition p19 values less than('1992-05-14 06:20:00'),
 partition p20 values less than('1992-05-21 06:40:00'),
 partition p21 values less than('1992-05-28 07:00:00'),
 partition p22 values less than('1992-06-04 07:20:00'),
 partition p23 values less than('1992-06-11 07:40:00'),
 partition p24 values less than('1992-06-18 08:00:00'),
 partition p25 values less than('1992-06-25 08:20:00'),
 partition p26 values less than('1992-07-02 08:40:00'),
 partition p27 values less than('1992-07-09 09:00:00'),
 partition p28 values less than('1992-07-16 09:20:00'),
 partition p29 values less than('1992-07-23 09:40:00'),
 partition p30 values less than('1992-07-30 10:00:00'),
 partition p31 values less than('1992-08-06 10:20:00'),
 partition p32 values less than('1992-08-13 10:40:00'),
 partition p33 values less than('1992-08-20 11:00:00'),
 partition p34 values less than('1992-08-27 11:20:00'),
 partition p35 values less than('1992-09-03 11:40:00'),
 partition p36 values less than('1992-09-10 12:00:00'),
 partition p37 values less than('1992-09-17 12:20:00'),
 partition p38 values less than('1992-09-24 12:40:00'),
 partition p39 values less than('1992-10-01 13:00:00'),
 partition p40 values less than('1992-10-08 13:20:00'),
 partition p41 values less than('1992-10-15 13:40:00'),
 partition p42 values less than('1992-10-22 14:00:00'),
 partition p43 values less than('1992-10-29 14:20:00'),
 partition p44 values less than('1992-11-05 14:40:00'),
 partition p45 values less than('1992-11-12 15:00:00'),
 partition p46 values less than('1992-11-19 15:20:00'),
 partition p47 values less than('1992-11-26 15:40:00'),
 partition p48 values less than('1992-12-03 16:00:00'),
 partition p49 values less than('1992-12-10 16:20:00'),
 partition p50 values less than('1992-12-17 16:40:00'),
 partition p51 values less than('1992-12-24 17:00:00'),
 partition p52 values less than('1992-12-31 17:20:00'),
 partition p53 values less than('1993-01-07 17:40:00'),
 partition p54 values less than('1993-01-14 18:00:00'),
 partition p55 values less than('1993-01-21 18:20:00'),
 partition p56 values less than('1993-01-28 18:40:00'),
 partition p57 values less than('1993-02-04 19:00:00'),
 partition p58 values less than('1993-02-11 19:20:00'),
 partition p59 values less than('1993-02-18 19:40:00'),
 partition p60 values less than('1993-02-25 20:00:00'),
 partition p61 values less than('1993-03-04 20:20:00'),
 partition p62 values less than('1993-03-11 20:40:00'),
 partition p63 values less than('1993-03-18 21:00:00'),
 partition p64 values less than('1993-03-25 21:20:00'),
 partition p65 values less than('1993-04-01 21:40:00'),
 partition p66 values less than('1993-04-08 22:00:00'),
 partition p67 values less than('1993-04-15 22:20:00'),
 partition p68 values less than('1993-04-22 22:40:00'),
 partition p69 values less than('1993-04-29 23:00:00'),
 partition p70 values less than('1993-05-06 23:20:00'),
 partition p71 values less than('1993-05-13 23:40:00'),
 partition p72 values less than('1993-05-21 00:00:00'),
 partition p73 values less than('1993-05-28 00:20:00'),
 partition p74 values less than('1993-06-04 00:40:00'),
 partition p75 values less than('1993-06-11 01:00:00'),
 partition p76 values less than('1993-06-18 01:20:00'),
 partition p77 values less than('1993-06-25 01:40:00'),
 partition p78 values less than('1993-07-02 02:00:00'),
 partition p79 values less than('1993-07-09 02:20:00'),
 partition p80 values less than('1993-07-16 02:40:00'),
 partition p81 values less than('1993-07-23 03:00:00'),
 partition p82 values less than('1993-07-30 03:20:00'),
 partition p83 values less than('1993-08-06 03:40:00'),
 partition p84 values less than('1993-08-13 04:00:00'),
 partition p85 values less than('1993-08-20 04:20:00'),
 partition p86 values less than('1993-08-27 04:40:00'),
 partition p87 values less than('1993-09-03 05:00:00'),
 partition p88 values less than('1993-09-10 05:20:00'),
 partition p89 values less than('1993-09-17 05:40:00'),
 partition p90 values less than('1993-09-24 06:00:00'),
 partition p91 values less than('1993-10-01 06:20:00'),
 partition p92 values less than('1993-10-08 06:40:00'),
 partition p93 values less than('1993-10-15 07:00:00'),
 partition p94 values less than('1993-10-22 07:20:00'),
 partition p95 values less than('1993-10-29 07:40:00'),
 partition p96 values less than('1993-11-05 08:00:00'),
 partition p97 values less than('1993-11-12 08:20:00'),
 partition p98 values less than('1993-11-19 08:40:00'),
 partition p99 values less than('1993-11-26 09:00:00'),
 partition p100 values less than('1993-12-03 09:20:00'),
 partition p101 values less than('1993-12-10 09:40:00'),
 partition p102 values less than('1993-12-17 10:00:00'),
 partition p103 values less than('1993-12-24 10:20:00'),
 partition p104 values less than('1993-12-31 10:40:00'),
 partition p105 values less than('1994-01-07 11:00:00'),
 partition p106 values less than('1994-01-14 11:20:00'),
 partition p107 values less than('1994-01-21 11:40:00'),
 partition p108 values less than('1994-01-28 12:00:00'),
 partition p109 values less than('1994-02-04 12:20:00'),
 partition p110 values less than('1994-02-11 12:40:00'),
 partition p111 values less than('1994-02-18 13:00:00'),
 partition p112 values less than('1994-02-25 13:20:00'),
 partition p113 values less than('1994-03-04 13:40:00'),
 partition p114 values less than('1994-03-11 14:00:00'),
 partition p115 values less than('1994-03-18 14:20:00'),
 partition p116 values less than('1994-03-25 14:40:00'),
 partition p117 values less than('1994-04-01 15:00:00'),
 partition p118 values less than('1994-04-08 15:20:00'),
 partition p119 values less than('1994-04-15 15:40:00'),
 partition p120 values less than('1994-04-22 16:00:00'),
 partition p121 values less than('1994-04-29 16:20:00'),
 partition p122 values less than('1994-05-06 16:40:00'),
 partition p123 values less than('1994-05-13 17:00:00'),
 partition p124 values less than('1994-05-20 17:20:00'),
 partition p125 values less than('1994-05-27 17:40:00'),
 partition p126 values less than('1994-06-03 18:00:00'),
 partition p127 values less than('1994-06-10 18:20:00'),
 partition p128 values less than('1994-06-17 18:40:00'),
 partition p129 values less than('1994-06-24 19:00:00'),
 partition p130 values less than('1994-07-01 19:20:00'),
 partition p131 values less than('1994-07-08 19:40:00'),
 partition p132 values less than('1994-07-15 20:00:00'),
 partition p133 values less than('1994-07-22 20:20:00'),
 partition p134 values less than('1994-07-29 20:40:00'),
 partition p135 values less than('1994-08-05 21:00:00'),
 partition p136 values less than('1994-08-12 21:20:00'),
 partition p137 values less than('1994-08-19 21:40:00'),
 partition p138 values less than('1994-08-26 22:00:00'),
 partition p139 values less than('1994-09-02 22:20:00'),
 partition p140 values less than('1994-09-09 22:40:00'),
 partition p141 values less than('1994-09-16 23:00:00'),
 partition p142 values less than('1994-09-23 23:20:00'),
 partition p143 values less than('1994-09-30 23:40:00'),
 partition p144 values less than('1994-10-08 00:00:00'),
 partition p145 values less than('1994-10-15 00:20:00'),
 partition p146 values less than('1994-10-22 00:40:00'),
 partition p147 values less than('1994-10-29 01:00:00'),
 partition p148 values less than('1994-11-05 01:20:00'),
 partition p149 values less than('1994-11-12 01:40:00'),
 partition p150 values less than('1994-11-19 02:00:00'),
 partition p151 values less than('1994-11-26 02:20:00'),
 partition p152 values less than('1994-12-03 02:40:00'),
 partition p153 values less than('1994-12-10 03:00:00'),
 partition p154 values less than('1994-12-17 03:20:00'),
 partition p155 values less than('1994-12-24 03:40:00'),
 partition p156 values less than('1994-12-31 04:00:00'),
 partition p157 values less than('1995-01-07 04:20:00'),
 partition p158 values less than('1995-01-14 04:40:00'),
 partition p159 values less than('1995-01-21 05:00:00'),
 partition p160 values less than('1995-01-28 05:20:00'),
 partition p161 values less than('1995-02-04 05:40:00'),
 partition p162 values less than('1995-02-11 06:00:00'),
 partition p163 values less than('1995-02-18 06:20:00'),
 partition p164 values less than('1995-02-25 06:40:00'),
 partition p165 values less than('1995-03-04 07:00:00'),
 partition p166 values less than('1995-03-11 07:20:00'),
 partition p167 values less than('1995-03-18 07:40:00'),
 partition p168 values less than('1995-03-25 08:00:00'),
 partition p169 values less than('1995-04-01 08:20:00'),
 partition p170 values less than('1995-04-08 08:40:00'),
 partition p171 values less than('1995-04-15 09:00:00'),
 partition p172 values less than('1995-04-22 09:20:00'),
 partition p173 values less than('1995-04-29 09:40:00'),
 partition p174 values less than('1995-05-06 10:00:00'),
 partition p175 values less than('1995-05-13 10:20:00'),
 partition p176 values less than('1995-05-20 10:40:00'),
 partition p177 values less than('1995-05-27 11:00:00'),
 partition p178 values less than('1995-06-03 11:20:00'),
 partition p179 values less than('1995-06-10 11:40:00'),
 partition p180 values less than('1995-06-17 12:00:00'),
 partition p181 values less than('1995-06-24 12:20:00'),
 partition p182 values less than('1995-07-01 12:40:00'),
 partition p183 values less than('1995-07-08 13:00:00'),
 partition p184 values less than('1995-07-15 13:20:00'),
 partition p185 values less than('1995-07-22 13:40:00'),
 partition p186 values less than('1995-07-29 14:00:00'),
 partition p187 values less than('1995-08-05 14:20:00'),
 partition p188 values less than('1995-08-12 14:40:00'),
 partition p189 values less than('1995-08-19 15:00:00'),
 partition p190 values less than('1995-08-26 15:20:00'),
 partition p191 values less than('1995-09-02 15:40:00'),
 partition p192 values less than('1995-09-09 16:00:00'),
 partition p193 values less than('1995-09-16 16:20:00'),
 partition p194 values less than('1995-09-23 16:40:00'),
 partition p195 values less than('1995-09-30 17:00:00'),
 partition p196 values less than('1995-10-07 17:20:00'),
 partition p197 values less than('1995-10-14 17:40:00'),
 partition p198 values less than('1995-10-21 18:00:00'),
 partition p199 values less than('1995-10-28 18:20:00'),
 partition p200 values less than('1995-11-04 18:40:00'),
 partition p201 values less than('1995-11-11 19:00:00'),
 partition p202 values less than('1995-11-18 19:20:00'),
 partition p203 values less than('1995-11-25 19:40:00'),
 partition p204 values less than('1995-12-02 20:00:00'),
 partition p205 values less than('1995-12-09 20:20:00'),
 partition p206 values less than('1995-12-16 20:40:00'),
 partition p207 values less than('1995-12-23 21:00:00'),
 partition p208 values less than('1995-12-30 21:20:00'),
 partition p209 values less than('1996-01-06 21:40:00'),
 partition p210 values less than('1996-01-13 22:00:00'),
 partition p211 values less than('1996-01-20 22:20:00'),
 partition p212 values less than('1996-01-27 22:40:00'),
 partition p213 values less than('1996-02-03 23:00:00'),
 partition p214 values less than('1996-02-10 23:20:00'),
 partition p215 values less than('1996-02-17 23:40:00'),
 partition p216 values less than('1996-02-25 00:00:00'),
 partition p217 values less than('1996-03-03 00:20:00'),
 partition p218 values less than('1996-03-10 00:40:00'),
 partition p219 values less than('1996-03-17 01:00:00'),
 partition p220 values less than('1996-03-24 01:20:00'),
 partition p221 values less than('1996-03-31 01:40:00'),
 partition p222 values less than('1996-04-07 02:00:00'),
 partition p223 values less than('1996-04-14 02:20:00'),
 partition p224 values less than('1996-04-21 02:40:00'),
 partition p225 values less than('1996-04-28 03:00:00'),
 partition p226 values less than('1996-05-05 03:20:00'),
 partition p227 values less than('1996-05-12 03:40:00'),
 partition p228 values less than('1996-05-19 04:00:00'),
 partition p229 values less than('1996-05-26 04:20:00'),
 partition p230 values less than('1996-06-02 04:40:00'),
 partition p231 values less than('1996-06-09 05:00:00'),
 partition p232 values less than('1996-06-16 05:20:00'),
 partition p233 values less than('1996-06-23 05:40:00'),
 partition p234 values less than('1996-06-30 06:00:00'),
 partition p235 values less than('1996-07-07 06:20:00'),
 partition p236 values less than('1996-07-14 06:40:00'),
 partition p237 values less than('1996-07-21 07:00:00'),
 partition p238 values less than('1996-07-28 07:20:00'),
 partition p239 values less than('1996-08-04 07:40:00'),
 partition p240 values less than('1996-08-11 08:00:00'),
 partition p241 values less than('1996-08-18 08:20:00'),
 partition p242 values less than('1996-08-25 08:40:00'),
 partition p243 values less than('1996-09-01 09:00:00'),
 partition p244 values less than('1996-09-08 09:20:00'),
 partition p245 values less than('1996-09-15 09:40:00'),
 partition p246 values less than('1996-09-22 10:00:00'),
 partition p247 values less than('1996-09-29 10:20:00'),
 partition p248 values less than('1996-10-06 10:40:00'),
 partition p249 values less than('1996-10-13 11:00:00'),
 partition p250 values less than('1996-10-20 11:20:00'),
 partition p251 values less than('1996-10-27 11:40:00'),
 partition p252 values less than('1996-11-03 12:00:00'),
 partition p253 values less than('1996-11-10 12:20:00'),
 partition p254 values less than('1996-11-17 12:40:00'),
 partition p255 values less than('1996-11-24 13:00:00'),
 partition p256 values less than('1996-12-01 13:20:00'),
 partition p257 values less than('1996-12-08 13:40:00'),
 partition p258 values less than('1996-12-15 14:00:00'),
 partition p259 values less than('1996-12-22 14:20:00'),
 partition p260 values less than('1996-12-29 14:40:00'),
 partition p261 values less than('1997-01-05 15:00:00'),
 partition p262 values less than('1997-01-12 15:20:00'),
 partition p263 values less than('1997-01-19 15:40:00'),
 partition p264 values less than('1997-01-26 16:00:00'),
 partition p265 values less than('1997-02-02 16:20:00'),
 partition p266 values less than('1997-02-09 16:40:00'),
 partition p267 values less than('1997-02-16 17:00:00'),
 partition p268 values less than('1997-02-23 17:20:00'),
 partition p269 values less than('1997-03-02 17:40:00'),
 partition p270 values less than('1997-03-09 18:00:00'),
 partition p271 values less than('1997-03-16 18:20:00'),
 partition p272 values less than('1997-03-23 18:40:00'),
 partition p273 values less than('1997-03-30 19:00:00'),
 partition p274 values less than('1997-04-06 19:20:00'),
 partition p275 values less than('1997-04-13 19:40:00'),
 partition p276 values less than('1997-04-20 20:00:00'),
 partition p277 values less than('1997-04-27 20:20:00'),
 partition p278 values less than('1997-05-04 20:40:00'),
 partition p279 values less than('1997-05-11 21:00:00'),
 partition p280 values less than('1997-05-18 21:20:00'),
 partition p281 values less than('1997-05-25 21:40:00'),
 partition p282 values less than('1997-06-01 22:00:00'),
 partition p283 values less than('1997-06-08 22:20:00'),
 partition p284 values less than('1997-06-15 22:40:00'),
 partition p285 values less than('1997-06-22 23:00:00'),
 partition p286 values less than('1997-06-29 23:20:00'),
 partition p287 values less than('1997-07-06 23:40:00'),
 partition p288 values less than('1997-07-14 00:00:00'),
 partition p289 values less than('1997-07-21 00:20:00'),
 partition p290 values less than('1997-07-28 00:40:00'),
 partition p291 values less than('1997-08-04 01:00:00'),
 partition p292 values less than('1997-08-11 01:20:00'),
 partition p293 values less than('1997-08-18 01:40:00'),
 partition p294 values less than('1997-08-25 02:00:00'),
 partition p295 values less than('1997-09-01 02:20:00'),
 partition p296 values less than('1997-09-08 02:40:00'),
 partition p297 values less than('1997-09-15 03:00:00'),
 partition p298 values less than('1997-09-22 03:20:00'),
 partition p299 values less than('1997-09-29 03:40:00'),
 partition p300 values less than('1997-10-06 04:00:00'),
 partition p301 values less than('1997-10-13 04:20:00'),
 partition p302 values less than('1997-10-20 04:40:00'),
 partition p303 values less than('1997-10-27 05:00:00'),
 partition p304 values less than('1997-11-03 05:20:00'),
 partition p305 values less than('1997-11-10 05:40:00'),
 partition p306 values less than('1997-11-17 06:00:00'),
 partition p307 values less than('1997-11-24 06:20:00'),
 partition p308 values less than('1997-12-01 06:40:00'),
 partition p309 values less than('1997-12-08 07:00:00'),
 partition p310 values less than('1997-12-15 07:20:00'),
 partition p311 values less than('1997-12-22 07:40:00'),
 partition p312 values less than('1997-12-29 08:00:00'),
 partition p313 values less than('1998-01-05 08:20:00'),
 partition p314 values less than('1998-01-12 08:40:00'),
 partition p315 values less than('1998-01-19 09:00:00'),
 partition p316 values less than('1998-01-26 09:20:00'),
 partition p317 values less than('1998-02-02 09:40:00'),
 partition p318 values less than('1998-02-09 10:00:00'),
 partition p319 values less than('1998-02-16 10:20:00'),
 partition p320 values less than('1998-02-23 10:40:00'),
 partition p321 values less than('1998-03-02 11:00:00'),
 partition p322 values less than('1998-03-09 11:20:00'),
 partition p323 values less than('1998-03-16 11:40:00'),
 partition p324 values less than('1998-03-23 12:00:00'),
 partition p325 values less than('1998-03-30 12:20:00'),
 partition p326 values less than('1998-04-06 12:40:00'),
 partition p327 values less than('1998-04-13 13:00:00'),
 partition p328 values less than('1998-04-20 13:20:00'),
 partition p329 values less than('1998-04-27 13:40:00'),
 partition p330 values less than('1998-05-04 14:00:00'),
 partition p331 values less than('1998-05-11 14:20:00'),
 partition p332 values less than('1998-05-18 14:40:00'),
 partition p333 values less than('1998-05-25 15:00:00'),
 partition p334 values less than('1998-06-01 15:20:00'),
 partition p335 values less than('1998-06-08 15:40:00'),
 partition p336 values less than('1998-06-15 16:00:00'),
 partition p337 values less than('1998-06-22 16:20:00'),
 partition p338 values less than('1998-06-29 16:40:00'),
 partition p339 values less than('1998-07-06 17:00:00'),
 partition p340 values less than('1998-07-13 17:20:00'),
 partition p341 values less than('1998-07-20 17:40:00'),
 partition p342 values less than('1998-07-27 18:00:00'),
 partition p343 values less than('1998-08-03 18:20:00'),
 partition p344 values less than('1998-08-10 18:40:00'),
 partition p345 values less than('1998-08-17 19:00:00'),
 partition p346 values less than('1998-08-24 19:20:00'),
 partition p347 values less than('1998-08-31 19:40:00'),
 partition p348 values less than('1998-09-07 20:00:00'),
 partition p349 values less than('1998-09-14 20:20:00'),
 partition p350 values less than('1998-09-21 20:40:00'),
 partition p351 values less than('1998-09-28 21:00:00'),
 partition p352 values less than('1998-10-05 21:20:00'),
 partition p353 values less than('1998-10-12 21:40:00'),
 partition p354 values less than('1998-10-19 22:00:00'),
 partition p355 values less than('1998-10-26 22:20:00'),
 partition p356 values less than('1998-11-02 22:40:00'),
 partition p357 values less than('1998-11-09 23:00:00'),
 partition p358 values less than('1998-11-16 23:20:00'),
 partition p359 values less than('1998-11-23 23:40:00'),
 partition p360 values less than('1998-12-01 00:00:00'),
 partition p361 values less than('1998-12-08 00:20:00'),
 partition p362 values less than('1998-12-15 00:40:00'),
 partition p363 values less than('1998-12-22 01:00:00'),
 partition p364 values less than('1998-12-29 01:20:00'),
 partition p365 values less than(maxvalue)
);

TRUNCATE LINEITEM_INSERT;
COPY LINEITEM_INSERT FROM '@abs_srcdir@/data/lineitem.data' DELIMITER '|';
INSERT INTO LINEITEM_PART_DATE SELECT * FROM LINEITEM_INSERT;
DROP TABLE LINEITEM_INSERT;
DROP TABLE LINEITEM_PART_DATE;
--
--
SET DATESTYLE='ISO, MDY';
CREATE TABLE TESTTABLE_TBL
(
C_INT INT,
c_timestamp timestamp,
c_timestamp_w timestamp without time zone
) distribute by hash(C_INT);
COPY TESTTABLE_TBL FROM STDIN with (delimiter ',',timestamp_format 'yy/mm/dd/hh24/mi/ss');
02,00/01/01/00/00/00,00/01/01/00/00/00
\.
SELECT * FROM TESTTABLE_TBL;
DROP TABLE TESTTABLE_TBL;

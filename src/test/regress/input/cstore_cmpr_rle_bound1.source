-- problem: test rle bound case with compression = high
CREATE TABLE cstore_cmpr_rle_bound1
(
	a1 bigint,
	a2 bigint,
	a3 bigint,
	a4 bigint,
	a5 bigint,
	a6 bigint,
	a7 bigint,
	a8 bigint,
	a9 bigint
) with ( orientation = column, compression = high );
COPY cstore_cmpr_rle_bound1 FROM '@abs_srcdir@/data/cstore_cmpr_rle_bound.data';
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a2 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a2 = 254;
SELECT DISTINCT a2 FROM cstore_cmpr_rle_bound1 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a3 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a3 = 65278;

SELECT DISTINCT a3 FROM cstore_cmpr_rle_bound1 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a4 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a4 = 16711422;
SELECT DISTINCT a4 FROM cstore_cmpr_rle_bound1 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a5 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a5 = 4278124286;
SELECT DISTINCT a5 FROM cstore_cmpr_rle_bound1 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a6 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a6 = 1095199817470;
SELECT DISTINCT a6 FROM cstore_cmpr_rle_bound1 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a7 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a7 = 280371153272574;
SELECT DISTINCT a7 FROM cstore_cmpr_rle_bound1 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a8 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a8 = 71775015237779198;
SELECT DISTINCT a8 FROM cstore_cmpr_rle_bound1 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a9 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound1 WHERE a9 = -72340172838076674;
SELECT DISTINCT a9 FROM cstore_cmpr_rle_bound1 ORDER BY 1;

SELECT DISTINCT * FROM cstore_cmpr_rle_bound1 ORDER BY 2;
DROP TABLE cstore_cmpr_rle_bound1;

-- problem: after optimize RLE compress, test its new bound
CREATE TABLE cstore_cmpr_rle_bound2
(
	distkey bigint,
	a1 bigint,
	a2 bigint,
	a3 bigint,
	a4 bigint,
	a5 bigint,
	a6 bigint,
	a7 bigint,
	a8 bigint
)with ( orientation = column, compression = low );
COPY cstore_cmpr_rle_bound2 FROM STDIN NULL 'null';
1	0	0	0	0	0	0	0	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
1	254	65278	16711422	4278124286	1095199817470	280371153272574	71775015237779198	-72340172838076674
1	100	10000	10000000	1000000000	1000000000000	100000000000000	10000000000000000	0
\.
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a1 = 100;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a1 = 254;
SELECT DISTINCT a1 FROM cstore_cmpr_rle_bound2 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a2 = 10000;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a2 = 65278;
SELECT DISTINCT a2 FROM cstore_cmpr_rle_bound2 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a3 = 10000000;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a3 = 16711422;
SELECT DISTINCT a3 FROM cstore_cmpr_rle_bound2 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a4 = 1000000000;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a4 = 4278124286;
SELECT DISTINCT a4 FROM cstore_cmpr_rle_bound2 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a5 = 1000000000000;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a5 = 1095199817470;
SELECT DISTINCT a5 FROM cstore_cmpr_rle_bound2 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a6 = 100000000000000;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a6 = 280371153272574;
SELECT DISTINCT a6 FROM cstore_cmpr_rle_bound2 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a7 = 10000000000000000;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a7 = 71775015237779198;
SELECT DISTINCT a7 FROM cstore_cmpr_rle_bound2 ORDER BY 1;

SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a8 = 0;
SELECT COUNT(*) FROM cstore_cmpr_rle_bound2 WHERE a8 = -72340172838076674;
SELECT DISTINCT a8 FROM cstore_cmpr_rle_bound2 ORDER BY 1;

SELECT DISTINCT * FROM cstore_cmpr_rle_bound2 ORDER BY 2;
DROP TABLE cstore_cmpr_rle_bound2;

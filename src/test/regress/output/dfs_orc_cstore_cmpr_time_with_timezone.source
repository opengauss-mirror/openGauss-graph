set enable_global_stats = true;
set enable_vector_engine=on;
-- Problem:
-- basic time with time zone type data compression, including DELTA method, min/max computation.
CREATE TABLE colcmpr_time_with_timezone
(
	distkey INT4,
	a time with time zone,
	b time with time zone,
	c time with time zone,
	d time with time zone,
	e time with time zone,
	f time with time zone
) with (orientation = orc) tablespace hdfs_ts  DISTRIBUTE BY HASH(distkey);
COPY colcmpr_time_with_timezone FROM '@abs_srcdir@/data/colcmpr_timestamp_with_timezone.data' delimiter ',';
SET DATESTYLE='SQL, DMY';
SELECT * FROM colcmpr_time_with_timezone;
 distkey |      a      |        b         |        c         |       d        |       e        |       f        
---------+-------------+------------------+------------------+----------------+----------------+----------------
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00+14:59 | 00:00:00+14:59 | 00:00:00-14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:59 | 00:00:00+14:58 | 00:00:00-14:58
       1 | 00:00:30+08 | 23:12:12.2356-07 | 13:12:12.2356-07 | 00:00:00+14:58 | 00:00:00+14:57 | 00:00:00-14:57
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00+14:57 | 00:00:00+14:56 | 00:00:00-14:56
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00+14:59 | 00:00:00+14:55 | 00:00:00-14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:58 | 00:00:00+14:58 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:57 | 00:00:00+14:57 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:56 | 00:00:00+14:56 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:59 | 00:00:00+14:55 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:59 | 00:00:00+14:58 | 11:38:45+08
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00+14:59 | 00:00:00+14:58 | 00:00:00-14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:59 | 00:00:00+14:58 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-07 | 13:12:12.2356-07 | 00:00:00+14:58 | 00:00:00+14:58 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00+14:57 | 00:00:00+14:58 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00+14:59 | 00:00:00+14:58 | 00:00:00-14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:58 | 00:00:00+14:58 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:57 | 00:00:00+14:58 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:56 | 00:00:00+14:58 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:59 | 00:00:00+14:58 | 00:00:00+14:59
       1 | 00:00:30+08 | 23:12:12.2356-08 | 13:12:12.2356-08 | 00:00:00-14:59 | 00:00:00+14:58 | 00:00:00+14:59
(20 rows)

DROP TABLE colcmpr_time_with_timezone;

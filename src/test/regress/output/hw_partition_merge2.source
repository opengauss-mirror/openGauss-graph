-- ALTER TABLE MERGE PARTITIONS INTO PARTITION
-- 0. Functional Test
-- 1. Abnormal Test
-- 2. Table has tablespace
-- 3. Table has toast
-- 4. Table has index
-- 5. Table has VM and FSM
-- 3. Table has toast
create table test_merge_toast (a int, b text) with(autovacuum_enabled = off)
partition by range (a)
(
	partition test_merge_toast_p1 values less than (10),
	partition test_merge_toast_p2 values less than (20),
	partition test_merge_toast_p3 values less than (30),
	partition test_merge_toast_p4 values less than (40)
);
insert into test_merge_toast values (1, lpad('a',409600,'b'));
insert into test_merge_toast values (11, lpad('a',409600,'b'));
alter table test_merge_toast merge partitions test_merge_toast_p1, test_merge_toast_p2 into partition test_merge_toast_px;
select count (*) from test_merge_toast;
 count 
-------
     2
(1 row)

select count (*) from test_merge_toast partition (test_merge_toast_px);
 count 
-------
     2
(1 row)

drop table test_merge_toast;
-- 4. Table has index
create table test_merge_index_test (c1 int, c2 int, c3 int) with(autovacuum_enabled = off)
partition by range (c2)
(
	partition test_merge_index_test_p1 values less than (10),
	partition test_merge_index_test_p2 values less than (20),
	partition test_merge_index_test_p3 values less than (30),
	partition test_merge_index_test_p4 values less than (40),
	partition test_merge_index_test_p5 values less than (50),
	partition test_merge_index_test_p6 values less than (60),
	partition test_merge_index_test_p7 values less than (70),
	partition test_merge_index_test_p8 values less than (80),
	partition test_merge_index_test_p9 values less than (90),
	partition test_merge_index_test_p10 values less than (100),
	partition test_merge_index_test_p11 values less than (110),
	partition test_merge_index_test_p12 values less than (120),
	partition test_merge_index_test_p13 values less than (130),
	partition test_merge_index_test_p14 values less than (140),
	partition test_merge_index_test_p15 values less than (150),
	partition test_merge_index_test_p16 values less than (160),
	partition test_merge_index_test_p17 values less than (170),
	partition test_merge_index_test_p18 values less than (180),
	partition test_merge_index_test_p19 values less than (190),
	partition test_merge_index_test_p20 values less than (200),
	partition test_merge_index_test_p21 values less than (210),
	partition test_merge_index_test_p22 values less than (220),
	partition test_merge_index_test_p23 values less than (230),
	partition test_merge_index_test_p24 values less than (240),
	partition test_merge_index_test_p25 values less than (250),
	partition test_merge_index_test_p26 values less than (260),
	partition test_merge_index_test_p27 values less than (270),
	partition test_merge_index_test_p28 values less than (280),
	partition test_merge_index_test_p29 values less than (290),
	partition test_merge_index_test_p30 values less than (300)
);
insert into test_merge_index_test values (generate_series(1, 299), generate_series(1, 299), generate_series(1, 299));
--create indexes
create index idx1_test_merge_index on test_merge_index_test(c1) local;
create index idx2_test_merge_index on test_merge_index_test(c1, c2) local;
create index idx3_test_merge_index on test_merge_index_test(c1, c2, c3) local;
create index idx4_test_merge_index on test_merge_index_test using hash (c1) local;
ERROR:  access method "hash" does not support row store
--4.1 merge 2 partitions into one
alter table test_merge_index_test merge partitions 
	test_merge_index_test_p1, test_merge_index_test_p2
	into partition test_merge_index_test_p2;
-- merged index check, seqscan
SET enable_seqscan = ON;
SET enable_indexscan = OFF;
SET enable_indexonlyscan = OFF;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Sort
         Sort Key: c1
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Sort
         Sort Key: c1, c2
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Sort
         Sort Key: c1, c2, c3
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

-- merged index check, indexcan
SET enable_seqscan = OFF;
SET enable_indexscan = ON;
SET enable_indexonlyscan = OFF;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Sort
         Sort Key: c1
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Sort
         Sort Key: c1, c2
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Sort
         Sort Key: c1, c2, c3
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

-- merged index check, indexonlycan
SET enable_seqscan = OFF;
SET enable_indexscan = OFF;
SET enable_indexonlyscan = ON;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Sort
         Sort Key: c1
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Sort
         Sort Key: c1, c2
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Sort
         Sort Key: c1, c2, c3
         ->  Partition Iterator
               Iterations: 29
               ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..29
(8 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

--4.2 merge 3 partitions into one
alter table test_merge_index_test merge partitions 
	test_merge_index_test_p2, test_merge_index_test_p3, test_merge_index_test_p4
	into partition test_merge_index_test_p4;
-- merged index check, seqscan
SET enable_seqscan = ON;
SET enable_indexscan = OFF;
SET enable_indexonlyscan = OFF;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Sort
         Sort Key: c1
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Sort
         Sort Key: c1, c2
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Sort
         Sort Key: c1, c2, c3
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

-- merged index check, indexcan
SET enable_seqscan = OFF;
SET enable_indexscan = ON;
SET enable_indexonlyscan = OFF;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Sort
         Sort Key: c1
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Sort
         Sort Key: c1, c2
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                                          QUERY PLAN                                           
-----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Sort
         Sort Key: c1, c2, c3
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

-- merged index check, indexonlycan
SET enable_seqscan = OFF;
SET enable_indexscan = OFF;
SET enable_indexonlyscan = ON;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Sort
         Sort Key: c1
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Sort
         Sort Key: c1, c2
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                                             QUERY PLAN                                             
----------------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Sort
         Sort Key: c1, c2, c3
         ->  Partition Iterator
               Iterations: 27
               ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
                     Selected Partitions:  1..27
(8 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

--4.3 merge multiple partitions into one
alter table test_merge_index_test merge partitions 
	test_merge_index_test_p4, 
	test_merge_index_test_p5, 
	test_merge_index_test_p6,
	test_merge_index_test_p7, 
	test_merge_index_test_p8, 
	test_merge_index_test_p9,
	test_merge_index_test_p10, 
	test_merge_index_test_p11, 
	test_merge_index_test_p12,
	test_merge_index_test_p13, 
	test_merge_index_test_p14, 
	test_merge_index_test_p15,
	test_merge_index_test_p16, 
	test_merge_index_test_p17, 
	test_merge_index_test_p18,
	test_merge_index_test_p19, 
	test_merge_index_test_p20, 
	test_merge_index_test_p21,
	test_merge_index_test_p22, 
	test_merge_index_test_p23, 
	test_merge_index_test_p24,
	test_merge_index_test_p25, 
	test_merge_index_test_p26, 
	test_merge_index_test_p27,
	test_merge_index_test_p28, 
	test_merge_index_test_p29,
	test_merge_index_test_p30
	into partition test_merge_index_test_pone;
-- merged index check, seqscan
SET enable_seqscan = ON;
SET enable_indexscan = OFF;
SET enable_indexonlyscan = OFF;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Sort
         Sort Key: c1
         ->  Partition Iterator
               Iterations: 1
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1
(8 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Sort
         Sort Key: c1, c2
         ->  Partition Iterator
               Iterations: 1
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1
(8 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                           QUERY PLAN                            
-----------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Sort
         Sort Key: c1, c2, c3
         ->  Partition Iterator
               Iterations: 1
               ->  Partitioned Seq Scan on test_merge_index_test
                     Selected Partitions:  1
(8 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

-- merged index check, indexcan
SET enable_seqscan = OFF;
SET enable_indexscan = ON;
SET enable_indexonlyscan = OFF;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Partition Iterator
         Iterations: 1
         ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
               Selected Partitions:  1
(6 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Partition Iterator
         Iterations: 1
         ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
               Selected Partitions:  1
(6 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                                       QUERY PLAN                                        
-----------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Partition Iterator
         Iterations: 1
         ->  Partitioned Index Scan using idx3_test_merge_index on test_merge_index_test
               Selected Partitions:  1
(6 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

-- merged index check, indexonlycan
SET enable_seqscan = OFF;
SET enable_indexscan = OFF;
SET enable_indexonlyscan = ON;
SET enable_bitmapscan = OFF;
EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1;
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1
   ->  Partition Iterator
         Iterations: 1
         ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
               Selected Partitions:  1
(6 rows)

select * from test_merge_index_test order by c1;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2;
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2
   ->  Partition Iterator
         Iterations: 1
         ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
               Selected Partitions:  1
(6 rows)

select * from test_merge_index_test order by c1, c2;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

EXPLAIN (COSTS OFF, NODES OFF) select * from test_merge_index_test order by c1, c2, c3;
                                          QUERY PLAN                                          
----------------------------------------------------------------------------------------------
 Streaming (type: GATHER)
   Merge Sort Key: c1, c2, c3
   ->  Partition Iterator
         Iterations: 1
         ->  Partitioned Index Only Scan using idx3_test_merge_index on test_merge_index_test
               Selected Partitions:  1
(6 rows)

select * from test_merge_index_test order by c1, c2, c3;
 c1  | c2  | c3  
-----+-----+-----
   1 |   1 |   1
   2 |   2 |   2
   3 |   3 |   3
   4 |   4 |   4
   5 |   5 |   5
   6 |   6 |   6
   7 |   7 |   7
   8 |   8 |   8
   9 |   9 |   9
  10 |  10 |  10
  11 |  11 |  11
  12 |  12 |  12
  13 |  13 |  13
  14 |  14 |  14
  15 |  15 |  15
  16 |  16 |  16
  17 |  17 |  17
  18 |  18 |  18
  19 |  19 |  19
  20 |  20 |  20
  21 |  21 |  21
  22 |  22 |  22
  23 |  23 |  23
  24 |  24 |  24
  25 |  25 |  25
  26 |  26 |  26
  27 |  27 |  27
  28 |  28 |  28
  29 |  29 |  29
  30 |  30 |  30
  31 |  31 |  31
  32 |  32 |  32
  33 |  33 |  33
  34 |  34 |  34
  35 |  35 |  35
  36 |  36 |  36
  37 |  37 |  37
  38 |  38 |  38
  39 |  39 |  39
  40 |  40 |  40
  41 |  41 |  41
  42 |  42 |  42
  43 |  43 |  43
  44 |  44 |  44
  45 |  45 |  45
  46 |  46 |  46
  47 |  47 |  47
  48 |  48 |  48
  49 |  49 |  49
  50 |  50 |  50
  51 |  51 |  51
  52 |  52 |  52
  53 |  53 |  53
  54 |  54 |  54
  55 |  55 |  55
  56 |  56 |  56
  57 |  57 |  57
  58 |  58 |  58
  59 |  59 |  59
  60 |  60 |  60
  61 |  61 |  61
  62 |  62 |  62
  63 |  63 |  63
  64 |  64 |  64
  65 |  65 |  65
  66 |  66 |  66
  67 |  67 |  67
  68 |  68 |  68
  69 |  69 |  69
  70 |  70 |  70
  71 |  71 |  71
  72 |  72 |  72
  73 |  73 |  73
  74 |  74 |  74
  75 |  75 |  75
  76 |  76 |  76
  77 |  77 |  77
  78 |  78 |  78
  79 |  79 |  79
  80 |  80 |  80
  81 |  81 |  81
  82 |  82 |  82
  83 |  83 |  83
  84 |  84 |  84
  85 |  85 |  85
  86 |  86 |  86
  87 |  87 |  87
  88 |  88 |  88
  89 |  89 |  89
  90 |  90 |  90
  91 |  91 |  91
  92 |  92 |  92
  93 |  93 |  93
  94 |  94 |  94
  95 |  95 |  95
  96 |  96 |  96
  97 |  97 |  97
  98 |  98 |  98
  99 |  99 |  99
 100 | 100 | 100
 101 | 101 | 101
 102 | 102 | 102
 103 | 103 | 103
 104 | 104 | 104
 105 | 105 | 105
 106 | 106 | 106
 107 | 107 | 107
 108 | 108 | 108
 109 | 109 | 109
 110 | 110 | 110
 111 | 111 | 111
 112 | 112 | 112
 113 | 113 | 113
 114 | 114 | 114
 115 | 115 | 115
 116 | 116 | 116
 117 | 117 | 117
 118 | 118 | 118
 119 | 119 | 119
 120 | 120 | 120
 121 | 121 | 121
 122 | 122 | 122
 123 | 123 | 123
 124 | 124 | 124
 125 | 125 | 125
 126 | 126 | 126
 127 | 127 | 127
 128 | 128 | 128
 129 | 129 | 129
 130 | 130 | 130
 131 | 131 | 131
 132 | 132 | 132
 133 | 133 | 133
 134 | 134 | 134
 135 | 135 | 135
 136 | 136 | 136
 137 | 137 | 137
 138 | 138 | 138
 139 | 139 | 139
 140 | 140 | 140
 141 | 141 | 141
 142 | 142 | 142
 143 | 143 | 143
 144 | 144 | 144
 145 | 145 | 145
 146 | 146 | 146
 147 | 147 | 147
 148 | 148 | 148
 149 | 149 | 149
 150 | 150 | 150
 151 | 151 | 151
 152 | 152 | 152
 153 | 153 | 153
 154 | 154 | 154
 155 | 155 | 155
 156 | 156 | 156
 157 | 157 | 157
 158 | 158 | 158
 159 | 159 | 159
 160 | 160 | 160
 161 | 161 | 161
 162 | 162 | 162
 163 | 163 | 163
 164 | 164 | 164
 165 | 165 | 165
 166 | 166 | 166
 167 | 167 | 167
 168 | 168 | 168
 169 | 169 | 169
 170 | 170 | 170
 171 | 171 | 171
 172 | 172 | 172
 173 | 173 | 173
 174 | 174 | 174
 175 | 175 | 175
 176 | 176 | 176
 177 | 177 | 177
 178 | 178 | 178
 179 | 179 | 179
 180 | 180 | 180
 181 | 181 | 181
 182 | 182 | 182
 183 | 183 | 183
 184 | 184 | 184
 185 | 185 | 185
 186 | 186 | 186
 187 | 187 | 187
 188 | 188 | 188
 189 | 189 | 189
 190 | 190 | 190
 191 | 191 | 191
 192 | 192 | 192
 193 | 193 | 193
 194 | 194 | 194
 195 | 195 | 195
 196 | 196 | 196
 197 | 197 | 197
 198 | 198 | 198
 199 | 199 | 199
 200 | 200 | 200
 201 | 201 | 201
 202 | 202 | 202
 203 | 203 | 203
 204 | 204 | 204
 205 | 205 | 205
 206 | 206 | 206
 207 | 207 | 207
 208 | 208 | 208
 209 | 209 | 209
 210 | 210 | 210
 211 | 211 | 211
 212 | 212 | 212
 213 | 213 | 213
 214 | 214 | 214
 215 | 215 | 215
 216 | 216 | 216
 217 | 217 | 217
 218 | 218 | 218
 219 | 219 | 219
 220 | 220 | 220
 221 | 221 | 221
 222 | 222 | 222
 223 | 223 | 223
 224 | 224 | 224
 225 | 225 | 225
 226 | 226 | 226
 227 | 227 | 227
 228 | 228 | 228
 229 | 229 | 229
 230 | 230 | 230
 231 | 231 | 231
 232 | 232 | 232
 233 | 233 | 233
 234 | 234 | 234
 235 | 235 | 235
 236 | 236 | 236
 237 | 237 | 237
 238 | 238 | 238
 239 | 239 | 239
 240 | 240 | 240
 241 | 241 | 241
 242 | 242 | 242
 243 | 243 | 243
 244 | 244 | 244
 245 | 245 | 245
 246 | 246 | 246
 247 | 247 | 247
 248 | 248 | 248
 249 | 249 | 249
 250 | 250 | 250
 251 | 251 | 251
 252 | 252 | 252
 253 | 253 | 253
 254 | 254 | 254
 255 | 255 | 255
 256 | 256 | 256
 257 | 257 | 257
 258 | 258 | 258
 259 | 259 | 259
 260 | 260 | 260
 261 | 261 | 261
 262 | 262 | 262
 263 | 263 | 263
 264 | 264 | 264
 265 | 265 | 265
 266 | 266 | 266
 267 | 267 | 267
 268 | 268 | 268
 269 | 269 | 269
 270 | 270 | 270
 271 | 271 | 271
 272 | 272 | 272
 273 | 273 | 273
 274 | 274 | 274
 275 | 275 | 275
 276 | 276 | 276
 277 | 277 | 277
 278 | 278 | 278
 279 | 279 | 279
 280 | 280 | 280
 281 | 281 | 281
 282 | 282 | 282
 283 | 283 | 283
 284 | 284 | 284
 285 | 285 | 285
 286 | 286 | 286
 287 | 287 | 287
 288 | 288 | 288
 289 | 289 | 289
 290 | 290 | 290
 291 | 291 | 291
 292 | 292 | 292
 293 | 293 | 293
 294 | 294 | 294
 295 | 295 | 295
 296 | 296 | 296
 297 | 297 | 297
 298 | 298 | 298
 299 | 299 | 299
(299 rows)

--clean up
drop table test_merge_index_test;
-- 5. Table has VM and FSM
create table test_merge_VM (a int, b int)with(autovacuum_enabled = off) partition by range (b)
(
	partition test_merge_VM_p1 values less than (10),
	partition test_merge_VM_p2 values less than (20),
	partition test_merge_VM_p3 values less than (30),
	partition test_merge_VM_p4 values less than (40)
);
insert into test_merge_VM values (0, 5), (0, 15), (0, 25); 
update test_merge_VM set b=6 where b=5;
vacuum test_merge_VM;
alter table test_merge_VM merge partitions test_merge_VM_p1, test_merge_VM_p2 into partition test_merge_VM_px;
select * from test_merge_VM partition (test_merge_VM_px);
 a | b  
---+----
 0 |  6
 0 | 15
(2 rows)

vacuum test_merge_VM;
select * from test_merge_VM partition (test_merge_VM_px);
 a | b  
---+----
 0 |  6
 0 | 15
(2 rows)

alter table test_merge_VM merge partitions test_merge_VM_px, test_merge_VM_p3 into partition test_merge_VM_p1;
select * from test_merge_VM partition (test_merge_VM_p1);
 a | b  
---+----
 0 |  6
 0 | 15
 0 | 25
(3 rows)

drop table test_merge_VM;

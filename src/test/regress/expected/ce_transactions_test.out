\! gs_ktool -d all
DELETE ALL

\! gs_ktool -g
GENERATE
1
DROP CLIENT MASTER KEY IF EXISTS MyCMK CASCADE;
NOTICE:  client master key "mycmk" does not exist
CREATE CLIENT MASTER KEY MyCMK WITH ( KEY_STORE = gs_ktool , KEY_PATH = "gs_ktool/1" , ALGORITHM = AES_256_CBC);
CREATE COLUMN ENCRYPTION KEY MyCEK770 WITH VALUES (CLIENT_MASTER_KEY = MyCMK, ALGORITHM = AEAD_AES_256_CBC_HMAC_SHA256);
CREATE TABLE IF NOT EXISTS tr2(i1 INT ENCRYPTED WITH (COLUMN_ENCRYPTION_KEY = MyCEK770, ENCRYPTION_TYPE = DETERMINISTIC) , i2 INT);
BEGIN;
INSERT INTO tr2 (i1, i2) VALUES (12, 13);
INSERT INTO tr2 VALUES (15,16);
COMMIT;
SELECT * from tr2 ORDER BY i2;
 i1 | i2 
----+----
 12 | 13
 15 | 16
(2 rows)

BEGIN;
INSERT INTO tr2 (i1, i2) VALUES (22, 23), (24, 25), (26,27);
INSERT INTO tr2 VALUES (35,36), (36,37), (38,39);
COMMIT;
SELECT * from tr2 ORDER BY i2;
 i1 | i2 
----+----
 12 | 13
 15 | 16
 22 | 23
 24 | 25
 26 | 27
 35 | 36
 36 | 37
 38 | 39
(8 rows)

DROP TABLE tr2;
DROP COLUMN ENCRYPTION KEY MyCEK770;
DROP CLIENT MASTER KEY MyCMK;
\! gs_ktool -d all
DELETE ALL
 1

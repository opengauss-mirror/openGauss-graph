--id generator
set enable_compress_hll = on;
create schema hll_misc;
set current_schema = hll_misc;
create table t_id(id int);
insert into t_id values(generate_series(1,500));
--------------CONTENTS--------------------
--     hyperloglog test cases
------------------------------------------
--1. create table using hll type
--2. check if inplace upgrade sanity
------------------------------------------
------------------------------------------
-- 1. create table
------------------------------------------
-- column store
create table t_hll(a int, b hll) with (orientation = column);
insert into t_hll select mod(id, 2) a, hll_add_agg(hll_hash_integer(id)) from t_id group by a;
select a, #b from t_hll order by 1;
 a |     ?column?     
---+------------------
 0 | 251.872313909218
 1 | 253.003493170231
(2 rows)

drop table t_hll;
-- row store
create table t_hll(a int, b hll);
insert into t_hll select mod(id, 2) a, hll_add_agg(hll_hash_integer(id)) from t_id group by a;
select a, #b from t_hll order by 1;
 a |     ?column?     
---+------------------
 0 | 251.872313909218
 1 | 253.003493170231
(2 rows)

drop table t_hll;
------------------------------------------
-- 2. check inplace upgrade sanity
------------------------------------------
select oid, * from pg_proc where proname like 'hll%' order by oid;
 oid  |      proname       | pronamespace | proowner | prolang | procost | prorows | provariadic | protransform | proisagg | proiswindow | prosecdef | proleakproof | proisstrict | proretset | provolatile | pronargs | pronargdefaults | prorettype |      proargtypes      | proallargtypes | proargmodes |        proargnames         | proargdefaults |       prosrc       | probin | proconfig | proacl | prodefaultargpos | fencedmode | proshippable | propackage 
------+--------------------+--------------+----------+---------+---------+---------+-------------+--------------+----------+-------------+-----------+--------------+-------------+-----------+-------------+----------+-----------------+------------+-----------------------+----------------+-------------+----------------------------+----------------+--------------------+--------+-----------+--------+------------------+------------+--------------+------------
 4305 | hll_in             |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        3 |               0 |       4301 | 2275 26 23            |                |             |                            |                | hll_in             |        |           |        |                  | f          | f            | f
 4306 | hll_out            |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       2275 | 4301                  |                |             |                            |                | hll_out            |        |           |        |                  | f          | f            | f
 4307 | hll_recv           |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4301 | 2281                  |                |             |                            |                | hll_recv           |        |           |        |                  | f          | f            | f
 4308 | hll_send           |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |         17 | 4301                  |                |             |                            |                | hll_send           |        |           |        |                  | f          | f            | f
 4309 | hll_typmod_in      |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |         23 | 1263                  |                |             |                            |                | hll_typmod_in      |        |           |        |                  | f          | f            | f
 4310 | hll_typmod_out     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       2275 | 23                    |                |             |                            |                | hll_typmod_out     |        |           |        |                  | f          | f            | f
 4311 | hll                |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        3 |               0 |       4301 | 4301 23 16            |                |             |                            |                | hll                |        |           |        |                  | f          | f            | f
 4312 | hll_hashval_in     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        3 |               0 |       4303 | 2275 26 23            |                |             |                            |                | hll_hashval_in     |        |           |        |                  | f          | f            | f
 4313 | hll_hashval_out    |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       2275 | 4303                  |                |             |                            |                | hll_hashval_out    |        |           |        |                  | f          | f            | f
 4314 | hll_hashval_eq     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |         16 | 4303 4303             |                |             |                            |                | hll_hashval_eq     |        |           |        |                  | f          | f            | f
 4315 | hll_hashval_ne     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |         16 | 4303 4303             |                |             |                            |                | hll_hashval_ne     |        |           |        |                  | f          | f            | f
 4316 | hll_hashval        |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 20                    |                |             |                            |                | hll_hashval        |        |           |        |                  | f          | f            | f
 4317 | hll_hashval_int4   |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 23                    |                |             |                            |                | hll_hashval_int4   |        |           |        |                  | f          | f            | f
 4318 | hll_eq             |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |         16 | 4301 4301             |                |             |                            |                | hll_eq             |        |           |        |                  | f          | f            | f
 4319 | hll_ne             |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |         16 | 4301 4301             |                |             |                            |                | hll_ne             |        |           |        |                  | f          | f            | f
 4320 | hll_cardinality    |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |        701 | 4301                  |                |             |                            |                | hll_cardinality    |        |           |        |                  | f          | f            | f
 4321 | hll_union          |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4301 | 4301 4301             |                |             |                            |                | hll_union          |        |           |        |                  | f          | f            | f
 4322 | hll_add            |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4301 | 4301 4303             |                |             |                            |                | hll_add            |        |           |        |                  | f          | f            | f
 4323 | hll_add_rev        |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4301 | 4303 4301             |                |             |                            |                | hll_add_rev        |        |           |        |                  | f          | f            | f
 4324 | hll_print          |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       2275 | 4301                  |                |             |                            |                | hll_print          |        |           |        |                  | f          | f            | f
 4325 | hll_empty          |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        0 |               0 |       4301 |                       |                |             |                            |                | hll_empty0         |        |           |        |                  | f          | f            | f
 4326 | hll_empty          |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4301 | 23                    |                |             |                            |                | hll_empty1         |        |           |        |                  | f          | f            | f
 4327 | hll_empty          |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4301 | 23 23                 |                |             |                            |                | hll_empty2         |        |           |        |                  | f          | f            | f
 4328 | hll_empty          |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        3 |               0 |       4301 | 23 23 20              |                |             |                            |                | hll_empty3         |        |           |        |                  | f          | f            | f
 4329 | hll_empty          |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        4 |               0 |       4301 | 23 23 20 23           |                |             |                            |                | hll_empty4         |        |           |        |                  | f          | f            | f
 4330 | hll_schema_version |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |         23 | 4301                  |                |             |                            |                | hll_schema_version |        |           |        |                  | f          | f            | f
 4331 | hll_type           |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |         23 | 4301                  |                |             |                            |                | hll_type           |        |           |        |                  | f          | f            | f
 4332 | hll_log2m          |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |         23 | 4301                  |                |             |                            |                | hll_log2m          |        |           |        |                  | f          | f            | f
 4333 | hll_regwidth       |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |         23 | 4301                  |                |             |                            |                | hll_regwidth       |        |           |        |                  | f          | f            | f
 4334 | hll_expthresh      |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       2249 | 4301                  | {4301,20,20}   | {i,o,o}     | {data,specified,effective} |                | hll_expthresh      |        |           |        |                  | f          | f            | f
 4335 | hll_sparseon       |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |         23 | 4301                  |                |             |                            |                | hll_sparseon       |        |           |        |                  | f          | f            | f
 4336 | hll_add_trans1     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | f           | f         | v           |        3 |               0 |       4370 | 4370 4303 23          |                |             |                            |                | hll_add_trans1     |        |           |        |                  | f          | f            | f
 4337 | hll_add_trans2     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | f           | f         | v           |        4 |               0 |       4370 | 4370 4303 23 23       |                |             |                            |                | hll_add_trans2     |        |           |        |                  | f          | f            | f
 4338 | hll_add_trans3     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | f           | f         | v           |        5 |               0 |       4370 | 4370 4303 23 23 20    |                |             |                            |                | hll_add_trans3     |        |           |        |                  | f          | f            | f
 4339 | hll_hash_boolean   |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 16                    |                |             |                            |                | hll_hash_1byte     |        |           |        |                  | f          | f            | f
 4340 | hll_hash_smallint  |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 21                    |                |             |                            |                | hll_hash_2byte     |        |           |        |                  | f          | f            | f
 4341 | hll_hash_integer   |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 23                    |                |             |                            |                | hll_hash_4byte     |        |           |        |                  | f          | f            | f
 4342 | hll_hash_bigint    |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 20                    |                |             |                            |                | hll_hash_8byte     |        |           |        |                  | f          | f            | f
 4343 | hll_hash_bytea     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 17                    |                |             |                            |                | hll_hash_varlena   |        |           |        |                  | f          | f            | f
 4344 | hll_hash_text      |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 25                    |                |             |                            |                | hll_hash_varlena   |        |           |        |                  | f          | f            | f
 4345 | hll_hash_any       |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4303 | 2283                  |                |             |                            |                | hll_hash_any       |        |           |        |                  | f          | f            | f
 4346 | hll_union_trans    |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | f           | f         | v           |        2 |               0 |       4370 | 4370 4301             |                |             |                            |                | hll_union_trans    |        |           |        |                  | f          | f            | f
 4348 | hll_union_collect  |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | f           | f         | v           |        2 |               0 |       4370 | 4370 4370             |                |             |                            |                | hll_union_collect  |        |           |        |                  | f          | f            | f
 4351 | hll_add_trans0     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | f           | f         | v           |        2 |               0 |       4370 | 4370 4303             |                |             |                            |                | hll_add_trans0     |        |           |        |                  | f          | f            | f
 4352 | hll_pack           |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | f           | f         | v           |        1 |               0 |       4301 | 4370                  |                |             |                            |                | hll_pack           |        |           |        |                  | f          | f            | f
 4353 | hll_hash_boolean   |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4303 | 16 23                 |                |             |                            |                | hll_hash_1bytes    |        |           |        |                  | f          | f            | f
 4354 | hll_hash_smallint  |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4303 | 21 23                 |                |             |                            |                | hll_hash_2bytes    |        |           |        |                  | f          | f            | f
 4355 | hll_hash_integer   |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4303 | 23 23                 |                |             |                            |                | hll_hash_4bytes    |        |           |        |                  | f          | f            | f
 4356 | hll_hash_bigint    |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4303 | 20 23                 |                |             |                            |                | hll_hash_8bytes    |        |           |        |                  | f          | f            | f
 4357 | hll_hash_bytea     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4303 | 17 23                 |                |             |                            |                | hll_hash_varlenas  |        |           |        |                  | f          | f            | f
 4358 | hll_hash_text      |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4303 | 25 23                 |                |             |                            |                | hll_hash_varlenas  |        |           |        |                  | f          | f            | f
 4359 | hll_hash_any       |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        2 |               0 |       4303 | 2283 23               |                |             |                            |                | hll_hash_anys      |        |           |        |                  | f          | f            | f
 4360 | hll_add_trans4     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | f           | f         | v           |        6 |               0 |       4370 | 4370 4303 23 23 20 23 |                |             |                            |                | hll_add_trans4     |        |           |        |                  | f          | f            | f
 4362 | hll_trans_recv     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4370 | 2281                  |                |             |                            |                | hll_trans_recv     |        |           |        |                  | f          | f            | f
 4363 | hll_trans_send     |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |         17 | 4370                  |                |             |                            |                | hll_trans_send     |        |           |        |                  | f          | f            | f
 4364 | hll_trans_in       |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       4370 | 2275                  |                |             |                            |                | hll_trans_in       |        |           |        |                  | f          | f            | f
 4365 | hll_trans_out      |           11 |       10 |      12 |       1 |       0 |           0 | -            | f        | f           | f         | f            | t           | f         | i           |        1 |               0 |       2275 | 4370                  |                |             |                            |                | hll_trans_out      |        |           |        |                  | f          | f            | f
 4366 | hll_add_agg        |           11 |       10 |      12 |       1 |       0 |           0 | -            | t        | f           | f         | f            | f           | f         | i           |        1 |               0 |       4301 | 4303                  |                |             |                            |                | aggregate_dummy    |        |           |        |                  | f          | f            | f
 4367 | hll_union_agg      |           11 |       10 |      12 |       1 |       0 |           0 | -            | t        | f           | f         | f            | f           | f         | i           |        1 |               0 |       4301 | 4301                  |                |             |                            |                | aggregate_dummy    |        |           |        |                  | f          | f            | f
 4380 | hll_add_agg        |           11 |       10 |      12 |       1 |       0 |           0 | -            | t        | f           | f         | f            | f           | f         | i           |        2 |               0 |       4301 | 4303 23               |                |             |                            |                | aggregate_dummy    |        |           |        |                  | f          | f            | f
 4381 | hll_add_agg        |           11 |       10 |      12 |       1 |       0 |           0 | -            | t        | f           | f         | f            | f           | f         | i           |        3 |               0 |       4301 | 4303 23 23            |                |             |                            |                | aggregate_dummy    |        |           |        |                  | f          | f            | f
 4382 | hll_add_agg        |           11 |       10 |      12 |       1 |       0 |           0 | -            | t        | f           | f         | f            | f           | f         | i           |        4 |               0 |       4301 | 4303 23 23 20         |                |             |                            |                | aggregate_dummy    |        |           |        |                  | f          | f            | f
 4383 | hll_add_agg        |           11 |       10 |      12 |       1 |       0 |           0 | -            | t        | f           | f         | f            | f           | f         | i           |        5 |               0 |       4301 | 4303 23 23 20 23      |                |             |                            |                | aggregate_dummy    |        |           |        |                  | f          | f            | f
(63 rows)

select oid, * from pg_type where typname in 
	('hll', '_hll',
	'hll_hashval', '_hll_hashval',
	'hll_trans_type', '_hll_trans_type') order by oid;
 oid  |     typname     | typnamespace | typowner | typlen | typbyval | typtype | typcategory | typispreferred | typisdefined | typdelim | typrelid | typelem | typarray |    typinput    |    typoutput    |   typreceive   |    typsend     |   typmodin    |   typmodout    |    typanalyze    | typalign | typstorage | typnotnull | typbasetype | typtypmod | typndims | typcollation | typdefaultbin | typdefault | typacl 
------+-----------------+--------------+----------+--------+----------+---------+-------------+----------------+--------------+----------+----------+---------+----------+----------------+-----------------+----------------+----------------+---------------+----------------+------------------+----------+------------+------------+-------------+-----------+----------+--------------+---------------+------------+--------
 4301 | hll             |           11 |       10 |     -1 | f        | b       | U           | f              | t            | ,        |        0 |       0 |     4302 | hll_in         | hll_out         | hll_recv       | hll_send       | hll_typmod_in | hll_typmod_out | -                | i        | e          | f          |           0 |        -1 |        0 |            0 |               |            | 
 4302 | _hll            |           11 |       10 |     -1 | f        | p       | P           | f              | t            | ,        |        0 |    4301 |        0 | array_in       | array_out       | array_recv     | array_send     | hll_typmod_in | hll_typmod_out | array_typanalyze | i        | x          | f          |           0 |        -1 |        0 |            0 |               |            | 
 4303 | hll_hashval     |           11 |       10 |      8 | t        | p       | P           | f              | t            | ,        |        0 |       0 |     4304 | hll_hashval_in | hll_hashval_out | -              | -              | -             | -              | -                | d        | p          | f          |           0 |        -1 |        0 |            0 |               |            | 
 4304 | _hll_hashval    |           11 |       10 |     -1 | f        | p       | P           | f              | t            | ,        |        0 |    4303 |        0 | array_in       | array_out       | array_recv     | array_send     | -             | -              | array_typanalyze | d        | x          | f          |           0 |        -1 |        0 |            0 |               |            | 
 4370 | hll_trans_type  |           11 |       10 |     -1 | f        | p       | P           | f              | t            | ,        |        0 |       0 |     4371 | hll_trans_in   | hll_trans_out   | hll_trans_recv | hll_trans_send | -             | -              | -                | i        | e          | f          |           0 |        -1 |        0 |            0 |               |            | 
 4371 | _hll_trans_type |           11 |       10 |     -1 | f        | p       | P           | f              | t            | ,        |        0 |    4370 |        0 | array_in       | array_out       | array_recv     | array_send     | -             | -              | array_typanalyze | i        | x          | f          |           0 |        -1 |        0 |            0 |               |            | 
(6 rows)

with type_oids as
(
	select oid  from pg_type where typname in 
	('hll', '_hll',
	'hll_hashval', '_hll_hashval',
	'hll_trans_type', '_hll_trans_type')
)
select oid, * from pg_operator where oprleft in (select * from type_oids)
								or oprright in  (select * from type_oids)
								order by oid;
 oid  | oprname | oprnamespace | oprowner | oprkind | oprcanmerge | oprcanhash | oprleft | oprright | oprresult | oprcom | oprnegate |     oprcode     | oprrest |  oprjoin   
------+---------+--------------+----------+---------+-------------+------------+---------+----------+-----------+--------+-----------+-----------------+---------+------------
 4372 | =       |           11 |       10 | b       | f           | f          |    4301 |     4301 |        16 |   4372 |      4373 | hll_eq          | eqsel   | eqjoinsel
 4373 | <>      |           11 |       10 | b       | f           | f          |    4301 |     4301 |        16 |   4373 |      4372 | hll_ne          | neqsel  | neqjoinsel
 4374 | ||      |           11 |       10 | b       | f           | f          |    4301 |     4301 |      4301 |      0 |         0 | hll_union       | -       | -
 4375 | ||      |           11 |       10 | b       | f           | f          |    4301 |     4303 |      4301 |      0 |         0 | hll_add         | -       | -
 4376 | ||      |           11 |       10 | b       | f           | f          |    4303 |     4301 |      4301 |      0 |         0 | hll_add_rev     | -       | -
 4377 | #       |           11 |       10 | l       | f           | f          |       0 |     4301 |       701 |      0 |         0 | hll_cardinality | -       | -
 4378 | =       |           11 |       10 | b       | f           | f          |    4303 |     4303 |        16 |   4378 |      4379 | hll_hashval_eq  | eqsel   | eqjoinsel
 4379 | <>      |           11 |       10 | b       | f           | f          |    4303 |     4303 |        16 |   4379 |      4378 | hll_hashval_ne  | neqsel  | neqjoinsel
(8 rows)

select * from pg_aggregate where aggtranstype = (select oid from pg_type where typname = 'hll_trans_type') order by 1;
        aggfnoid        |   aggtransfn    |   aggcollectfn    | aggfinalfn | aggsortop | aggtranstype | agginitval | agginitcollect | aggkind | aggnumdirectargs 
------------------------+-----------------+-------------------+------------+-----------+--------------+------------+----------------+---------+------------------
 pg_catalog.hll_add_agg | hll_add_trans0  | hll_union_collect | hll_pack   |         0 |         4370 |            |                | n       |                0
 hll_union_agg          | hll_union_trans | hll_union_collect | hll_pack   |         0 |         4370 |            |                | n       |                0
 pg_catalog.hll_add_agg | hll_add_trans1  | hll_union_collect | hll_pack   |         0 |         4370 |            |                | n       |                0
 pg_catalog.hll_add_agg | hll_add_trans2  | hll_union_collect | hll_pack   |         0 |         4370 |            |                | n       |                0
 pg_catalog.hll_add_agg | hll_add_trans3  | hll_union_collect | hll_pack   |         0 |         4370 |            |                | n       |                0
 pg_catalog.hll_add_agg | hll_add_trans4  | hll_union_collect | hll_pack   |         0 |         4370 |            |                | n       |                0
(6 rows)

with type_oids as
(
	select oid  from pg_type where typname in 
	('hll', '_hll',
	'hll_hashval', '_hll_hashval',
	'hll_trans_type', '_hll_trans_type')
)
select * from pg_cast where castsource in ( select * from type_oids )
						or casttarget in ( select * from type_oids ) order by 1;
 castsource | casttarget | castfunc | castcontext | castmethod 
------------+------------+----------+-------------+------------
         17 |       4301 |        0 | e           | b
         20 |       4303 |        0 | e           | b
         23 |       4303 |     4317 | e           | f
       4301 |       4301 |     4311 | i           | f
(4 rows)

--final cleaning
drop table t_id;
drop schema hll_misc cascade;
reset current_schema;

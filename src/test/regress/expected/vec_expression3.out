/*
 * This file is used to test the function of vecexpression.cpp --- test(3)
 */
/*******************************
Expression Type:
	T_Var,
	T_Const,
	T_Param,
	T_Aggref,
	T_WindowFunc,
	T_ArrayRef,
	T_FuncExpr,
	T_NamedArgExpr,
	T_OpExpr,
	T_DistinctExpr,
	T_NullIfExpr,
	T_ScalarArrayOpExpr,
	T_BoolExpr,
	T_SubLink,
	T_SubPlan,
	T_AlternativeSubPlan,
	T_FieldSelect,
	T_FieldStore,
	T_RelabelType,
	T_CoerceViaIO,
	T_ArrayCoerceExpr,
	T_ConvertRowtypeExpr,
	T_CollateExpr,
	T_CaseExpr,
	T_CaseWhen,
	T_CaseTestExpr,
	T_ArrayExpr,
	T_RowExpr,
	T_RowCompareExpr,
	T_CoalesceExpr,
	T_MinMaxExpr,
	T_XmlExpr,
	T_NullTest,
	T_BooleanTest
	
Using Type:
	qual
	targetlist
*********************************/
----
--- test 16: tidout for column table
----
CREATE TABLE tidout_table(a INT) WITH (ORIENTATION=COLUMN);
INSERT INTO tidout_table VALUES(1);
SELECT ctid FROM tidout_table;
   ctid   
----------
 (1001,1)
(1 row)

SELECT ctid::TEXT FROM tidout_table;
   ctid   
----------
 (1001,1)
(1 row)

SELECT ctid||'aa' FROM tidout_table;
  ?column?  
------------
 (1001,1)aa
(1 row)

SELECT ctid||a FROM tidout_table;
 ?column?  
-----------
 (1001,1)1
(1 row)

SELECT ctid,a FROM tidout_table;
   ctid   | a 
----------+---
 (1001,1) | 1
(1 row)

DROP TABLE tidout_table;
----
--- case ICBC: Special Case
----
SELECT Agt_Num,Agt_Modif_Num, Party_id, Int_Org_Num, Curr_Cd, Open_Dt, avgbal
FROM
(SELECT
   T1.Agt_Num
   ,T1.Agt_Modif_Num
   ,T1.Party_id
   ,CASE WHEN T1.Proc_Org_Num <> '' AND SUBSTR(T1.Proc_Org_Num,9,4) NOT IN ('0000','9999')
           THEN T1.Proc_Org_Num 
           ELSE T1.Int_Org_Num 
    END AS Int_Org_Num
   ,T1.Curr_Cd
   ,T1.Open_Dt
   ,CAST(T1.Year_Dpsit_Accum/(TO_DATE('20140825', 'YYYYMMDD')-TO_DATE('20131231', 'YYYYMMDD')) AS DECIMAL(18,2)) AS avgbal
FROM dwSumData_act.C03_SEMI_CRDT_CARD_ACCT T1
WHERE T1.Data_Dt<=TO_DATE('20140825', 'YYYYMMDD')
   AND T1.Data_Dt>=TO_DATE('20140101', 'YYYYMMDD')
   AND T1.Party_Class_Cd=0
) A  order by 1,2,3,4,5,6,7;
     agt_num      |  agt_modif_num   |     party_id     | int_org_num | curr_cd |         open_dt          | avgbal 
------------------+------------------+------------------+-------------+---------+--------------------------+--------
 test_varchar_0   | test_varchar_0   | test_varchar_0   | t0          | t0      | Sat Aug 16 00:00:00 2014 |   0.00
 test_varchar_1   | test_varchar_1   |                  | t1          | t1      | Fri Aug 22 00:00:00 2014 |   0.00
 test_varchar_101 | test_varchar_101 |                  | t101        | t101    | Mon Jul 14 00:00:00 2014 |    .43
 test_varchar_104 | test_varchar_104 |                  | t104        | t104    | Sat Jul 12 00:00:00 2014 |    .44
 test_varchar_105 | test_varchar_105 | test_varchar_105 | t105        | t105    | Sun Jul 06 00:00:00 2014 |    .44
 test_varchar_106 | test_varchar_106 | test_varchar_106 | t106        | t106    | Thu Jul 10 00:00:00 2014 |    .45
 test_varchar_107 | test_varchar_107 |                  | t107        | t107    | Fri Jul 18 00:00:00 2014 |    .45
 test_varchar_108 | test_varchar_108 | test_varchar_108 | t108        | t108    | Mon Jul 07 00:00:00 2014 |    .46
 test_varchar_108 | test_varchar_108 |                  | t108        | t108    | Mon Jul 28 00:00:00 2014 |    .46
 test_varchar_110 | test_varchar_110 |                  | t110        | t110    | Fri Aug 08 00:00:00 2014 |    .46
 test_varchar_112 | test_varchar_112 |                  | t112        | t112    | Fri Aug 15 00:00:00 2014 |    .47
 test_varchar_113 | test_varchar_113 | test_varchar_113 | t113        | t113    | Fri Aug 08 00:00:00 2014 |    .48
 test_varchar_117 | test_varchar_117 | test_varchar_117 | t117        | t117    | Thu Jul 17 00:00:00 2014 |    .49
 test_varchar_118 | test_varchar_118 | test_varchar_118 | t118        | t118    | Sat Aug 23 00:00:00 2014 |    .50
 test_varchar_12  | test_varchar_12  |                  | t12         | t12     | Tue Jul 01 00:00:00 2014 |    .05
 test_varchar_123 | test_varchar_123 |                  | t123        | t123    | Tue Aug 19 00:00:00 2014 |    .52
 test_varchar_128 | test_varchar_128 | test_varchar_128 | t128        | t128    | Mon Jul 21 00:00:00 2014 |    .54
 test_varchar_128 | test_varchar_128 | test_varchar_128 | t128        | t128    | Sun Jul 27 00:00:00 2014 |    .54
 test_varchar_13  | test_varchar_13  |                  | t13         | t13     | Sat Aug 23 00:00:00 2014 |    .05
 test_varchar_131 | test_varchar_131 | test_varchar_131 | t131        | t131    | Tue Jul 15 00:00:00 2014 |    .55
 test_varchar_131 | test_varchar_131 |                  | t131        | t131    | Mon Jul 07 00:00:00 2014 |    .55
 test_varchar_134 | test_varchar_134 |                  | t134        | t134    | Wed Jul 09 00:00:00 2014 |    .57
 test_varchar_14  | test_varchar_14  |                  | t14         | t14     | Sun Jul 13 00:00:00 2014 |    .06
 test_varchar_140 | test_varchar_140 | test_varchar_140 | t140        | t140    | Tue Jul 22 00:00:00 2014 |    .59
 test_varchar_140 | test_varchar_140 |                  | t140        | t140    | Wed Jul 02 00:00:00 2014 |    .59
 test_varchar_143 | test_varchar_143 | test_varchar_143 | t143        | t143    | Thu Aug 21 00:00:00 2014 |    .60
 test_varchar_143 | test_varchar_143 |                  | t143        | t143    | Mon Aug 18 00:00:00 2014 |    .60
 test_varchar_15  | test_varchar_15  | test_varchar_15  | t15         | t15     | Mon Jul 28 00:00:00 2014 |    .06
 test_varchar_150 | test_varchar_150 |                  | t150        | t150    | Sun Aug 24 00:00:00 2014 |    .63
 test_varchar_151 | test_varchar_151 |                  | t151        | t151    | Thu Jul 10 00:00:00 2014 |    .64
 test_varchar_153 | test_varchar_153 | test_varchar_153 | t153        | t153    | Wed Aug 06 00:00:00 2014 |    .65
 test_varchar_153 | test_varchar_153 |                  | t153        | t153    | Thu Jul 03 00:00:00 2014 |    .65
 test_varchar_157 | test_varchar_157 |                  | t157        | t157    | Thu Jul 17 00:00:00 2014 |    .66
 test_varchar_157 | test_varchar_157 |                  | t157        | t157    | Fri Jul 25 00:00:00 2014 |    .66
 test_varchar_159 | test_varchar_159 | test_varchar_159 | t159        | t159    | Mon Aug 25 00:00:00 2014 |    .67
 test_varchar_163 | test_varchar_163 | test_varchar_163 | t163        | t163    | Sun Jul 13 00:00:00 2014 |    .69
 test_varchar_166 | test_varchar_166 | test_varchar_166 | t166        | t166    | Sun Aug 10 00:00:00 2014 |    .70
 test_varchar_166 | test_varchar_166 |                  | t166        | t166    | Tue Aug 05 00:00:00 2014 |    .70
 test_varchar_167 | test_varchar_167 | test_varchar_167 | t167        | t167    | Wed Jul 09 00:00:00 2014 |    .70
 test_varchar_170 | test_varchar_170 |                  | t170        | t170    | Fri Aug 01 00:00:00 2014 |    .72
 test_varchar_172 | test_varchar_172 | test_varchar_172 | t172        | t172    | Thu Aug 14 00:00:00 2014 |    .73
 test_varchar_173 | test_varchar_173 | test_varchar_173 | t173        | t173    | Sat Jul 05 00:00:00 2014 |    .73
 test_varchar_174 | test_varchar_174 | test_varchar_174 | t174        | t174    | Fri Jul 18 00:00:00 2014 |    .73
 test_varchar_178 | test_varchar_178 | test_varchar_178 | t178        | t178    | Tue Jul 08 00:00:00 2014 |    .75
 test_varchar_185 | test_varchar_185 | test_varchar_185 | t185        | t185    | Fri Jul 04 00:00:00 2014 |    .78
 test_varchar_189 | test_varchar_189 | test_varchar_189 | t189        | t189    | Sat Jul 19 00:00:00 2014 |    .80
 test_varchar_194 | test_varchar_194 | test_varchar_194 | t194        | t194    | Wed Aug 20 00:00:00 2014 |    .82
 test_varchar_197 | test_varchar_197 |                  | t197        | t197    | Tue Jul 08 00:00:00 2014 |    .83
 test_varchar_2   | test_varchar_2   | test_varchar_2   | t2          | t2      | Sun Aug 03 00:00:00 2014 |    .01
 test_varchar_200 | test_varchar_200 |                  | t200        | t200    | Mon Jul 21 00:00:00 2014 |    .84
 test_varchar_205 | test_varchar_205 | test_varchar_205 | t205        | t205    | Wed Aug 13 00:00:00 2014 |    .87
 test_varchar_21  | test_varchar_21  |                  | t21         | t21     | Thu Jul 24 00:00:00 2014 |    .09
 test_varchar_210 | test_varchar_210 |                  | t210        | t210    | Mon Aug 25 00:00:00 2014 |    .89
 test_varchar_213 | test_varchar_213 |                  | t213        | t213    | Sun Jul 06 00:00:00 2014 |    .90
 test_varchar_213 | test_varchar_213 |                  | t213        | t213    | Fri Jul 11 00:00:00 2014 |    .90
 test_varchar_218 | test_varchar_218 |                  | t218        | t218    | Fri Jul 04 00:00:00 2014 |    .92
 test_varchar_219 | test_varchar_219 | test_varchar_219 | t219        | t219    | Thu Jul 03 00:00:00 2014 |    .92
 test_varchar_220 | test_varchar_220 |                  | t220        | t220    | Thu Aug 14 00:00:00 2014 |    .93
 test_varchar_224 | test_varchar_224 | test_varchar_224 | t224        | t224    | Mon Aug 11 00:00:00 2014 |    .95
 test_varchar_232 | test_varchar_232 |                  | t232        | t232    | Thu Aug 07 00:00:00 2014 |    .98
 test_varchar_234 | test_varchar_234 | test_varchar_234 | t234        | t234    | Sat Aug 02 00:00:00 2014 |    .99
 test_varchar_241 | test_varchar_241 | test_varchar_241 | t241        | t241    | Mon Aug 04 00:00:00 2014 |   1.02
 test_varchar_241 | test_varchar_241 |                  | t241        | t241    | Sat Aug 09 00:00:00 2014 |   1.02
 test_varchar_243 | test_varchar_243 | test_varchar_243 | t243        | t243    | Fri Aug 01 00:00:00 2014 |   1.03
 test_varchar_243 | test_varchar_243 |                  | t243        | t243    | Sat Jul 05 00:00:00 2014 |   1.03
 test_varchar_243 | test_varchar_243 |                  | t243        | t243    | Sun Aug 03 00:00:00 2014 |   1.03
 test_varchar_246 | test_varchar_246 |                  | t246        | t246    | Sat Jul 19 00:00:00 2014 |   1.04
 test_varchar_248 | test_varchar_248 | test_varchar_248 | t248        | t248    | Fri Jul 11 00:00:00 2014 |   1.05
 test_varchar_250 | test_varchar_250 |                  | t250        | t250    | Thu Aug 21 00:00:00 2014 |   1.05
 test_varchar_253 | test_varchar_253 |                  | t253        | t253    | Sun Aug 17 00:00:00 2014 |   1.07
 test_varchar_258 | test_varchar_258 | test_varchar_258 | t258        | t258    | Sat Aug 09 00:00:00 2014 |   1.09
 test_varchar_265 | test_varchar_265 | test_varchar_265 | t265        | t265    | Thu Jul 24 00:00:00 2014 |   1.12
 test_varchar_266 | test_varchar_266 | test_varchar_266 | t266        | t266    | Wed Jul 16 00:00:00 2014 |   1.12
 test_varchar_266 | test_varchar_266 | test_varchar_266 | t266        | t266    | Tue Aug 19 00:00:00 2014 |   1.12
 test_varchar_271 | test_varchar_271 | test_varchar_271 | t271        | t271    | Sun Aug 24 00:00:00 2014 |   1.14
 test_varchar_272 | test_varchar_272 | test_varchar_272 | t272        | t272    | Mon Jul 14 00:00:00 2014 |   1.15
 test_varchar_273 | test_varchar_273 | test_varchar_273 | t273        | t273    | Fri Aug 15 00:00:00 2014 |   1.15
 test_varchar_275 | test_varchar_275 |                  | t275        | t275    | Sat Jul 26 00:00:00 2014 |   1.16
 test_varchar_277 | test_varchar_277 |                  | t277        | t277    | Tue Jul 22 00:00:00 2014 |   1.17
 test_varchar_278 | test_varchar_278 |                  | t278        | t278    | Sun Jul 27 00:00:00 2014 |   1.17
 test_varchar_284 | test_varchar_284 | test_varchar_284 | t284        | t284    | Sat Jul 12 00:00:00 2014 |   1.20
 test_varchar_288 | test_varchar_288 | test_varchar_288 | t288        | t288    | Fri Jul 25 00:00:00 2014 |   1.22
 test_varchar_292 | test_varchar_292 | test_varchar_292 | t292        | t292    | Sun Jul 20 00:00:00 2014 |   1.23
 test_varchar_296 | test_varchar_296 |                  | t296        | t296    | Sun Aug 10 00:00:00 2014 |   1.25
 test_varchar_297 | test_varchar_297 |                  | t297        | t297    | Wed Jul 23 00:00:00 2014 |   1.25
 test_varchar_31  | test_varchar_31  |                  | t31         | t31     | Tue Jul 15 00:00:00 2014 |    .13
 test_varchar_36  | test_varchar_36  | test_varchar_36  | t36         | t36     | Mon Aug 18 00:00:00 2014 |    .15
 test_varchar_38  | test_varchar_38  |                  | t38         | t38     | Sun Jul 20 00:00:00 2014 |    .16
 test_varchar_43  | test_varchar_43  |                  | t43         | t43     | Wed Aug 20 00:00:00 2014 |    .18
 test_varchar_57  | test_varchar_57  | test_varchar_57  | t57         | t57     | Tue Aug 12 00:00:00 2014 |    .24
 test_varchar_58  | test_varchar_58  | test_varchar_58  | t58         | t58     | Thu Aug 07 00:00:00 2014 |    .24
 test_varchar_65  | test_varchar_65  | test_varchar_65  | t65         | t65     | Tue Jul 01 00:00:00 2014 |    .27
 test_varchar_7   | test_varchar_7   |                  | t7          | t7      | Mon Aug 11 00:00:00 2014 |    .03
 test_varchar_74  | test_varchar_74  | test_varchar_74  | t74         | t74     | Wed Jul 02 00:00:00 2014 |    .31
 test_varchar_76  | test_varchar_76  |                  | t76         | t76     | Tue Aug 12 00:00:00 2014 |    .32
 test_varchar_77  | test_varchar_77  | test_varchar_77  | t77         | t77     | Sun Aug 17 00:00:00 2014 |    .32
 test_varchar_79  | test_varchar_79  |                  | t79         | t79     | Wed Aug 13 00:00:00 2014 |    .33
 test_varchar_8   | test_varchar_8   | test_varchar_8   | t8          | t8      | Wed Jul 23 00:00:00 2014 |    .03
 test_varchar_8   | test_varchar_8   | test_varchar_8   | t8          | t8      | Sat Jul 26 00:00:00 2014 |    .03
 test_varchar_8   | test_varchar_8   | test_varchar_8   | t8          | t8      | Tue Aug 05 00:00:00 2014 |    .03
 test_varchar_82  | test_varchar_82  |                  | t82         | t82     | Mon Aug 04 00:00:00 2014 |    .35
 test_varchar_87  | test_varchar_87  | test_varchar_87  | t87         | t87     | Fri Aug 22 00:00:00 2014 |    .37
 test_varchar_94  | test_varchar_94  |                  | t94         | t94     | Sat Aug 02 00:00:00 2014 |    .40
 test_varchar_94  | test_varchar_94  |                  | t94         | t94     | Sat Aug 16 00:00:00 2014 |    .40
 test_varchar_96  | test_varchar_96  |                  | t96         | t96     | Wed Aug 06 00:00:00 2014 |    .41
 test_varchar_97  | test_varchar_97  |                  | t97         | t97     | Wed Jul 16 00:00:00 2014 |    .41
(106 rows)

SELECT Agt_Num,Agt_Modif_Num, Party_id, Int_Org_Num, Curr_Cd, Open_Dt, avgbal
FROM
(SELECT
   T1.Agt_Num
   ,T1.Agt_Modif_Num
   ,T1.Party_id
   ,CASE WHEN T1.Proc_Org_Num <> '' AND SUBSTR(T1.Proc_Org_Num,9,4) NOT IN ('0000','9999')
           THEN T1.Proc_Org_Num 
           ELSE T1.Int_Org_Num 
    END AS Int_Org_Num
   ,T1.Curr_Cd
   ,T1.Open_Dt
   ,CAST(T1.Year_Dpsit_Accum/(TO_DATE('20140825', 'YYYYMMDD')-TO_DATE('20131231', 'YYYYMMDD')) AS DECIMAL(18,2)) AS avgbal
   ,ROW_NUMBER() OVER(PARTITION BY T1.Agt_Num,T1.Agt_Modif_Num ORDER BY T1.Data_Dt DESC)  AS Agt_Num_ORDER
FROM dwSumData_act.C03_SEMI_CRDT_CARD_ACCT T1
WHERE T1.Data_Dt<=TO_DATE('20140825', 'YYYYMMDD')
   AND T1.Data_Dt>=TO_DATE('20140101', 'YYYYMMDD')
   AND T1.Party_Class_Cd=0
) A WHERE Agt_Num_ORDER = 1 order by 1,2,3,4,5,6,7;  
     agt_num      |  agt_modif_num   |     party_id     | int_org_num | curr_cd |         open_dt          | avgbal 
------------------+------------------+------------------+-------------+---------+--------------------------+--------
 test_varchar_0   | test_varchar_0   | test_varchar_0   | t0          | t0      | Sat Aug 16 00:00:00 2014 |   0.00
 test_varchar_1   | test_varchar_1   |                  | t1          | t1      | Fri Aug 22 00:00:00 2014 |   0.00
 test_varchar_101 | test_varchar_101 |                  | t101        | t101    | Mon Jul 14 00:00:00 2014 |    .43
 test_varchar_104 | test_varchar_104 |                  | t104        | t104    | Sat Jul 12 00:00:00 2014 |    .44
 test_varchar_105 | test_varchar_105 | test_varchar_105 | t105        | t105    | Sun Jul 06 00:00:00 2014 |    .44
 test_varchar_106 | test_varchar_106 | test_varchar_106 | t106        | t106    | Thu Jul 10 00:00:00 2014 |    .45
 test_varchar_107 | test_varchar_107 |                  | t107        | t107    | Fri Jul 18 00:00:00 2014 |    .45
 test_varchar_108 | test_varchar_108 |                  | t108        | t108    | Mon Jul 28 00:00:00 2014 |    .46
 test_varchar_110 | test_varchar_110 |                  | t110        | t110    | Fri Aug 08 00:00:00 2014 |    .46
 test_varchar_112 | test_varchar_112 |                  | t112        | t112    | Fri Aug 15 00:00:00 2014 |    .47
 test_varchar_113 | test_varchar_113 | test_varchar_113 | t113        | t113    | Fri Aug 08 00:00:00 2014 |    .48
 test_varchar_117 | test_varchar_117 | test_varchar_117 | t117        | t117    | Thu Jul 17 00:00:00 2014 |    .49
 test_varchar_118 | test_varchar_118 | test_varchar_118 | t118        | t118    | Sat Aug 23 00:00:00 2014 |    .50
 test_varchar_12  | test_varchar_12  |                  | t12         | t12     | Tue Jul 01 00:00:00 2014 |    .05
 test_varchar_123 | test_varchar_123 |                  | t123        | t123    | Tue Aug 19 00:00:00 2014 |    .52
 test_varchar_128 | test_varchar_128 | test_varchar_128 | t128        | t128    | Sun Jul 27 00:00:00 2014 |    .54
 test_varchar_13  | test_varchar_13  |                  | t13         | t13     | Sat Aug 23 00:00:00 2014 |    .05
 test_varchar_131 | test_varchar_131 | test_varchar_131 | t131        | t131    | Tue Jul 15 00:00:00 2014 |    .55
 test_varchar_134 | test_varchar_134 |                  | t134        | t134    | Wed Jul 09 00:00:00 2014 |    .57
 test_varchar_14  | test_varchar_14  |                  | t14         | t14     | Sun Jul 13 00:00:00 2014 |    .06
 test_varchar_140 | test_varchar_140 | test_varchar_140 | t140        | t140    | Tue Jul 22 00:00:00 2014 |    .59
 test_varchar_143 | test_varchar_143 | test_varchar_143 | t143        | t143    | Thu Aug 21 00:00:00 2014 |    .60
 test_varchar_15  | test_varchar_15  | test_varchar_15  | t15         | t15     | Mon Jul 28 00:00:00 2014 |    .06
 test_varchar_150 | test_varchar_150 |                  | t150        | t150    | Sun Aug 24 00:00:00 2014 |    .63
 test_varchar_151 | test_varchar_151 |                  | t151        | t151    | Thu Jul 10 00:00:00 2014 |    .64
 test_varchar_153 | test_varchar_153 | test_varchar_153 | t153        | t153    | Wed Aug 06 00:00:00 2014 |    .65
 test_varchar_157 | test_varchar_157 |                  | t157        | t157    | Fri Jul 25 00:00:00 2014 |    .66
 test_varchar_159 | test_varchar_159 | test_varchar_159 | t159        | t159    | Mon Aug 25 00:00:00 2014 |    .67
 test_varchar_163 | test_varchar_163 | test_varchar_163 | t163        | t163    | Sun Jul 13 00:00:00 2014 |    .69
 test_varchar_166 | test_varchar_166 | test_varchar_166 | t166        | t166    | Sun Aug 10 00:00:00 2014 |    .70
 test_varchar_167 | test_varchar_167 | test_varchar_167 | t167        | t167    | Wed Jul 09 00:00:00 2014 |    .70
 test_varchar_170 | test_varchar_170 |                  | t170        | t170    | Fri Aug 01 00:00:00 2014 |    .72
 test_varchar_172 | test_varchar_172 | test_varchar_172 | t172        | t172    | Thu Aug 14 00:00:00 2014 |    .73
 test_varchar_173 | test_varchar_173 | test_varchar_173 | t173        | t173    | Sat Jul 05 00:00:00 2014 |    .73
 test_varchar_174 | test_varchar_174 | test_varchar_174 | t174        | t174    | Fri Jul 18 00:00:00 2014 |    .73
 test_varchar_178 | test_varchar_178 | test_varchar_178 | t178        | t178    | Tue Jul 08 00:00:00 2014 |    .75
 test_varchar_185 | test_varchar_185 | test_varchar_185 | t185        | t185    | Fri Jul 04 00:00:00 2014 |    .78
 test_varchar_189 | test_varchar_189 | test_varchar_189 | t189        | t189    | Sat Jul 19 00:00:00 2014 |    .80
 test_varchar_194 | test_varchar_194 | test_varchar_194 | t194        | t194    | Wed Aug 20 00:00:00 2014 |    .82
 test_varchar_197 | test_varchar_197 |                  | t197        | t197    | Tue Jul 08 00:00:00 2014 |    .83
 test_varchar_2   | test_varchar_2   | test_varchar_2   | t2          | t2      | Sun Aug 03 00:00:00 2014 |    .01
 test_varchar_200 | test_varchar_200 |                  | t200        | t200    | Mon Jul 21 00:00:00 2014 |    .84
 test_varchar_205 | test_varchar_205 | test_varchar_205 | t205        | t205    | Wed Aug 13 00:00:00 2014 |    .87
 test_varchar_21  | test_varchar_21  |                  | t21         | t21     | Thu Jul 24 00:00:00 2014 |    .09
 test_varchar_210 | test_varchar_210 |                  | t210        | t210    | Mon Aug 25 00:00:00 2014 |    .89
 test_varchar_213 | test_varchar_213 |                  | t213        | t213    | Fri Jul 11 00:00:00 2014 |    .90
 test_varchar_218 | test_varchar_218 |                  | t218        | t218    | Fri Jul 04 00:00:00 2014 |    .92
 test_varchar_219 | test_varchar_219 | test_varchar_219 | t219        | t219    | Thu Jul 03 00:00:00 2014 |    .92
 test_varchar_220 | test_varchar_220 |                  | t220        | t220    | Thu Aug 14 00:00:00 2014 |    .93
 test_varchar_224 | test_varchar_224 | test_varchar_224 | t224        | t224    | Mon Aug 11 00:00:00 2014 |    .95
 test_varchar_232 | test_varchar_232 |                  | t232        | t232    | Thu Aug 07 00:00:00 2014 |    .98
 test_varchar_234 | test_varchar_234 | test_varchar_234 | t234        | t234    | Sat Aug 02 00:00:00 2014 |    .99
 test_varchar_241 | test_varchar_241 |                  | t241        | t241    | Sat Aug 09 00:00:00 2014 |   1.02
 test_varchar_243 | test_varchar_243 |                  | t243        | t243    | Sun Aug 03 00:00:00 2014 |   1.03
 test_varchar_246 | test_varchar_246 |                  | t246        | t246    | Sat Jul 19 00:00:00 2014 |   1.04
 test_varchar_248 | test_varchar_248 | test_varchar_248 | t248        | t248    | Fri Jul 11 00:00:00 2014 |   1.05
 test_varchar_250 | test_varchar_250 |                  | t250        | t250    | Thu Aug 21 00:00:00 2014 |   1.05
 test_varchar_253 | test_varchar_253 |                  | t253        | t253    | Sun Aug 17 00:00:00 2014 |   1.07
 test_varchar_258 | test_varchar_258 | test_varchar_258 | t258        | t258    | Sat Aug 09 00:00:00 2014 |   1.09
 test_varchar_265 | test_varchar_265 | test_varchar_265 | t265        | t265    | Thu Jul 24 00:00:00 2014 |   1.12
 test_varchar_266 | test_varchar_266 | test_varchar_266 | t266        | t266    | Tue Aug 19 00:00:00 2014 |   1.12
 test_varchar_271 | test_varchar_271 | test_varchar_271 | t271        | t271    | Sun Aug 24 00:00:00 2014 |   1.14
 test_varchar_272 | test_varchar_272 | test_varchar_272 | t272        | t272    | Mon Jul 14 00:00:00 2014 |   1.15
 test_varchar_273 | test_varchar_273 | test_varchar_273 | t273        | t273    | Fri Aug 15 00:00:00 2014 |   1.15
 test_varchar_275 | test_varchar_275 |                  | t275        | t275    | Sat Jul 26 00:00:00 2014 |   1.16
 test_varchar_277 | test_varchar_277 |                  | t277        | t277    | Tue Jul 22 00:00:00 2014 |   1.17
 test_varchar_278 | test_varchar_278 |                  | t278        | t278    | Sun Jul 27 00:00:00 2014 |   1.17
 test_varchar_284 | test_varchar_284 | test_varchar_284 | t284        | t284    | Sat Jul 12 00:00:00 2014 |   1.20
 test_varchar_288 | test_varchar_288 | test_varchar_288 | t288        | t288    | Fri Jul 25 00:00:00 2014 |   1.22
 test_varchar_292 | test_varchar_292 | test_varchar_292 | t292        | t292    | Sun Jul 20 00:00:00 2014 |   1.23
 test_varchar_296 | test_varchar_296 |                  | t296        | t296    | Sun Aug 10 00:00:00 2014 |   1.25
 test_varchar_297 | test_varchar_297 |                  | t297        | t297    | Wed Jul 23 00:00:00 2014 |   1.25
 test_varchar_31  | test_varchar_31  |                  | t31         | t31     | Tue Jul 15 00:00:00 2014 |    .13
 test_varchar_36  | test_varchar_36  | test_varchar_36  | t36         | t36     | Mon Aug 18 00:00:00 2014 |    .15
 test_varchar_38  | test_varchar_38  |                  | t38         | t38     | Sun Jul 20 00:00:00 2014 |    .16
 test_varchar_43  | test_varchar_43  |                  | t43         | t43     | Wed Aug 20 00:00:00 2014 |    .18
 test_varchar_57  | test_varchar_57  | test_varchar_57  | t57         | t57     | Tue Aug 12 00:00:00 2014 |    .24
 test_varchar_58  | test_varchar_58  | test_varchar_58  | t58         | t58     | Thu Aug 07 00:00:00 2014 |    .24
 test_varchar_65  | test_varchar_65  | test_varchar_65  | t65         | t65     | Tue Jul 01 00:00:00 2014 |    .27
 test_varchar_7   | test_varchar_7   |                  | t7          | t7      | Mon Aug 11 00:00:00 2014 |    .03
 test_varchar_74  | test_varchar_74  | test_varchar_74  | t74         | t74     | Wed Jul 02 00:00:00 2014 |    .31
 test_varchar_76  | test_varchar_76  |                  | t76         | t76     | Tue Aug 12 00:00:00 2014 |    .32
 test_varchar_77  | test_varchar_77  | test_varchar_77  | t77         | t77     | Sun Aug 17 00:00:00 2014 |    .32
 test_varchar_79  | test_varchar_79  |                  | t79         | t79     | Wed Aug 13 00:00:00 2014 |    .33
 test_varchar_8   | test_varchar_8   | test_varchar_8   | t8          | t8      | Tue Aug 05 00:00:00 2014 |    .03
 test_varchar_82  | test_varchar_82  |                  | t82         | t82     | Mon Aug 04 00:00:00 2014 |    .35
 test_varchar_87  | test_varchar_87  | test_varchar_87  | t87         | t87     | Fri Aug 22 00:00:00 2014 |    .37
 test_varchar_94  | test_varchar_94  |                  | t94         | t94     | Sat Aug 16 00:00:00 2014 |    .40
 test_varchar_96  | test_varchar_96  |                  | t96         | t96     | Wed Aug 06 00:00:00 2014 |    .41
 test_varchar_97  | test_varchar_97  |                  | t97         | t97     | Wed Jul 16 00:00:00 2014 |    .41
(90 rows)

create table tr_case(
rn bigint,
c1 character varying(60),
c2 character varying(60),
c3 date,
c4 character varying(60),
c5 date,
c6 character varying(60)
);
insert into tr_case values(299295,'2','99991231','2014-10-22','00000000000000001',null,'1');
insert into tr_case values(299296,'2','99991231','2014-10-22','00000000000000001',null,'1');
insert into tr_case values(299294,'2','99991231','2014-10-22','00000000000000001',null,'1');
insert into tr_case values(299290,'2','99991231','2014-10-22','00000000000000001',null,'1');
create table tc_case with (orientation = column) as select * from tr_case;
select case when
    (case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2) and (case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 1)  
	     then c3 
		 else '19000102' end from tc_case;
           case           
--------------------------
 Wed Oct 22 00:00:00 2014
 Wed Oct 22 00:00:00 2014
 Wed Oct 22 00:00:00 2014
 Wed Oct 22 00:00:00 2014
(4 rows)

select rn, c1,c2,c3 ,c4,c5,c6,
case when (case when c1 = '' then 0  else cast(c1 as decimal(20,0)) end = 1 ) 
     then cast(c2 as date)
     when (case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2) and (case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 1) 
     then c3 + case when c4 = '' then 0 else cast(c4 as decimal (17,0)) end
     when (case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 2)
     then coalesce(c5, cast('19000102' as date))
     else cast('19000102' as date)
end
from tc_case order by 1;
   rn   | c1 |    c2    |            c3            |        c4         | c5 | c6 |           case           
--------+----+----------+--------------------------+-------------------+----+----+--------------------------
 299290 | 2  | 99991231 | Wed Oct 22 00:00:00 2014 | 00000000000000001 |    | 1  | Thu Oct 23 00:00:00 2014
 299294 | 2  | 99991231 | Wed Oct 22 00:00:00 2014 | 00000000000000001 |    | 1  | Thu Oct 23 00:00:00 2014
 299295 | 2  | 99991231 | Wed Oct 22 00:00:00 2014 | 00000000000000001 |    | 1  | Thu Oct 23 00:00:00 2014
 299296 | 2  | 99991231 | Wed Oct 22 00:00:00 2014 | 00000000000000001 |    | 1  | Thu Oct 23 00:00:00 2014
(4 rows)

select rn, c1,c2,c3 ,c4,c5,c6,
case when case when c1='' then 0 else cast(c1 as decimal(20,0)) end  = 1 then cast(c2 as date)
 when case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 1
  then c3 + case when c4 = '' then 0 else cast(c4 as decimal (17,0)) end
 when case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 2
  then coalesce(c5, cast('19000102' as date))
 else cast('19000102' as date)
end
from tc_case 
minus all
select rn, c1,c2,c3 ,c4,c5,c6,
case when case when c1='' then 0 else cast(c1 as decimal(20,0)) end  = 1 then cast(c2 as date)
 when case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 1
  then c3 + case when c4 = '' then 0 else cast(c4 as decimal (17,0)) end
 when case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 2
  then coalesce(c5, cast('19000102' as date))
 else cast('19000102' as date)
end
from tr_case order by 1;
 rn | c1 | c2 | c3 | c4 | c5 | c6 | case 
----+----+----+----+----+----+----+------
(0 rows)

select case when
    (case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2) and (case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 1)  
	     then c3 
		 else '19000102' end from tc_case;
           case           
--------------------------
 Wed Oct 22 00:00:00 2014
 Wed Oct 22 00:00:00 2014
 Wed Oct 22 00:00:00 2014
 Wed Oct 22 00:00:00 2014
(4 rows)

select rn, c1,c2,c3 ,c4,c5,c6,
case when (case when c1 = '' then 0  else cast(c1 as decimal(20,0)) end = 1 ) 
     then cast(c2 as date)
     when (case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2) and (case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 1) 
     then c3 + case when c4 = '' then 0 else cast(c4 as decimal (17,0)) end
     when (case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 2)
     then coalesce(c5, cast('19000102' as date))
     else cast('19000102' as date)
end
from tc_case order by 1;
   rn   | c1 |    c2    |            c3            |        c4         | c5 | c6 |           case           
--------+----+----------+--------------------------+-------------------+----+----+--------------------------
 299290 | 2  | 99991231 | Wed Oct 22 00:00:00 2014 | 00000000000000001 |    | 1  | Thu Oct 23 00:00:00 2014
 299294 | 2  | 99991231 | Wed Oct 22 00:00:00 2014 | 00000000000000001 |    | 1  | Thu Oct 23 00:00:00 2014
 299295 | 2  | 99991231 | Wed Oct 22 00:00:00 2014 | 00000000000000001 |    | 1  | Thu Oct 23 00:00:00 2014
 299296 | 2  | 99991231 | Wed Oct 22 00:00:00 2014 | 00000000000000001 |    | 1  | Thu Oct 23 00:00:00 2014
(4 rows)

select rn, c1,c2,c3 ,c4,c5,c6,
case when case when c1='' then 0 else cast(c1 as decimal(20,0)) end  = 1 then cast(c2 as date)
 when case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 1
  then c3 + case when c4 = '' then 0 else cast(c4 as decimal (17,0)) end
 when case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 2
  then coalesce(c5, cast('19000102' as date))
 else cast('19000102' as date)
end
from tc_case 
minus all
select rn, c1,c2,c3 ,c4,c5,c6,
case when case when c1='' then 0 else cast(c1 as decimal(20,0)) end  = 1 then cast(c2 as date)
 when case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 1
  then c3 + case when c4 = '' then 0 else cast(c4 as decimal (17,0)) end
 when case when c1 = '' then 0 else cast(c1 as decimal(20,0)) end = 2 and case when c6 = '' then 0 else cast(c6 as decimal(20,0)) end = 2
  then coalesce(c5, cast('19000102' as date))
 else cast('19000102' as date)
end
from tr_case order by 1;
 rn | c1 | c2 | c3 | c4 | c5 | c6 | case 
----+----+----+----+----+----+----+------
(0 rows)

----
--- Clean Resource and Tables
----
CREATE TABLE t1_case_col
(
      TRANSACTION_ID           CHAR(6)         
      ,AVG_CPU                 DECIMAL(12,4)   
      ,TRANNUM                 DECIMAL(10)     
      ,SUM_CPU                 DECIMAL(12,3)   
      ,DATA_DT                 CHAR(8)         
)
with(orientation=column)
DISTRIBUTE BY HASH (TRANSACTION_ID)
;
insert into t1_case_col values('999999',  0, 0, 0, '20150317');
SELECT (SUM( CASE WHEN TRANSACTION_ID = '999999'
              THEN SUM_CPU
              ELSE 0
              END               
            )/
         CASE  WHEN
         SUM( CASE WHEN TRANSACTION_ID <> '999999'
                   THEN TRANNUM
                   ELSE 0
              END
             ) = 0               
         THEN 99999999999999999   
         ELSE SUM( CASE WHEN TRANSACTION_ID <> '999999'
                        THEN TRANNUM
                        ELSE 0
                   END
                  )
         END )   AS WEIGHT          
  FROM t1_case_col;
                 weight                 
----------------------------------------
 0.000000000000000000000000000000000000
(1 row)

drop table t1_case_col;
CREATE TABLE t1_hashConst_col(col_1 int, col_2 int) with(orientation=column);
insert into t1_hashConst_col values(generate_series(1, 100), generate_series(1, 100));
select col_1, case when col_1 >= 10 then not col_2 when col_1 < 10 then not col_1 end from  t1_hashConst_col order by 1;
 col_1 | case 
-------+------
     1 | f
     2 | f
     3 | f
     4 | f
     5 | f
     6 | f
     7 | f
     8 | f
     9 | f
    10 | f
    11 | f
    12 | f
    13 | f
    14 | f
    15 | f
    16 | f
    17 | f
    18 | f
    19 | f
    20 | f
    21 | f
    22 | f
    23 | f
    24 | f
    25 | f
    26 | f
    27 | f
    28 | f
    29 | f
    30 | f
    31 | f
    32 | f
    33 | f
    34 | f
    35 | f
    36 | f
    37 | f
    38 | f
    39 | f
    40 | f
    41 | f
    42 | f
    43 | f
    44 | f
    45 | f
    46 | f
    47 | f
    48 | f
    49 | f
    50 | f
    51 | f
    52 | f
    53 | f
    54 | f
    55 | f
    56 | f
    57 | f
    58 | f
    59 | f
    60 | f
    61 | f
    62 | f
    63 | f
    64 | f
    65 | f
    66 | f
    67 | f
    68 | f
    69 | f
    70 | f
    71 | f
    72 | f
    73 | f
    74 | f
    75 | f
    76 | f
    77 | f
    78 | f
    79 | f
    80 | f
    81 | f
    82 | f
    83 | f
    84 | f
    85 | f
    86 | f
    87 | f
    88 | f
    89 | f
    90 | f
    91 | f
    92 | f
    93 | f
    94 | f
    95 | f
    96 | f
    97 | f
    98 | f
    99 | f
   100 | f
(100 rows)

drop table t1_hashConst_col;
create table t1_caseAnd_col(col_1 int, col_2 int, col_3 bool, col_4 bool)with(orientation=column);
copy t1_caseAnd_col FROM stdin;
select col_1, col_2, col_3, col_4, (case when (col_1 = 0 and col_2 = 5) then (col_3 and col_4) when (col_1 = 0 and col_2 = 2) then (col_3 and col_4) else 0::bool end) from t1_caseAnd_col order by 1, 2;
 col_1 | col_2 | col_3 | col_4 | case 
-------+-------+-------+-------+------
     0 |     2 | f     | f     | f
     0 |     5 | t     | t     | t
     0 |     5 | t     | t     | t
(3 rows)

drop table t1_caseAnd_col;
create table vector_expr_table_23(a int, b varchar(10), c text)with(orientation=column);
copy vector_expr_table_23 from stdin;
select * from vector_expr_table_23 where NULLIF(b, 3) < 9 OR Coalesce(c, '1') < 5000 order by 1,2,3;
 a |  b  |  c  
---+-----+-----
 1 | 123 | 456
 1 | 123 | 
 1 | 2   | 28
(3 rows)

execute direct on (datanode8) 'select concat(b,b), concat(c,c,c) from vector_expr_table_23 order by 1,2;';
 concat |  concat   
--------+-----------
 123123 | 456456456
 123123 | 
 22     | 282828
(3 rows)

create table customer_info_col 
(   ca_address integer not null,
    ca_id varchar(20) ,
    ca_email varchar(50)
)with (orientation=column) distribute by hash (ca_address);
create table date_text_col
(   d_text varchar(2000),
    d_cost int null
)with (orientation=column) distribute by hash (d_text);
insert into customer_info_col values (49597, '111111111111111111', 'aaaa' );
insert into customer_info_col values (49619, '222222222222222222', null );
insert into date_text_col values ('abcdefghijklmnopqrst', 15);
insert into date_text_col values ('abcdefghijklmnopqrst', null);
select t2.d_text,
    length(t1.ca_id) as start,
    length(t1.ca_email) as len,
    substr(t2.d_text,length(t1.ca_id),length(t1.ca_email)) as vtext_sub
from customer_info_col as t1 , date_text_col as t2 order by 1, 2, 3, 4;
        d_text        | start | len | vtext_sub 
----------------------+-------+-----+-----------
 abcdefghijklmnopqrst |    18 |   4 | rst
 abcdefghijklmnopqrst |    18 |   4 | rst
 abcdefghijklmnopqrst |    18 |     | 
 abcdefghijklmnopqrst |    18 |     | 
(4 rows)

select d_cost, to_hex(d_cost) from date_text_col, customer_info_col order by 1, 2;
 d_cost | to_hex 
--------+--------
     15 | f
     15 | f
        | 0
        | 0
(4 rows)

CREATE TABLE item_less_1 (
    i_item_sk integer NOT NULL,
    i_item_id character(16) NOT NULL,
    i_rec_start_date timestamp(0) without time zone,
    i_rec_end_date timestamp(0) without time zone,
    i_item_desc character varying(200),
    i_current_price numeric(7,2),
    i_wholesale_cost numeric(20,6),
    i_brand_id integer,
    i_brand character(50),
    i_class_id integer,
    i_class character(50),
    i_category_id integer,
    i_category character(50),
    i_manufact_id integer,
    i_manufact character(50),
    i_size numeric(20,2),
    i_formulation character(50),
    i_color numeric(19,18),
    i_units numeric(19,0),
    i_container numeric(39,2),
    i_manager_id integer,
    i_product_name character(50)
)
WITH (orientation=column, compression=low)
DISTRIBUTE BY REPLICATION;
COPY item_less_1 (i_item_sk, i_item_id, i_rec_start_date, i_rec_end_date, i_item_desc, i_current_price, i_wholesale_cost, i_brand_id, i_brand, i_class_id, i_class, i_category_id, i_category, i_manufact_id, i_manufact, i_size, i_formulation, i_color, i_units, i_container, i_manager_id, i_product_name) FROM stdin;
CREATE TABLE catalog_sales_less (
    cs_sold_date_sk integer,
    cs_sold_time_sk integer,
    cs_ship_date_sk integer,
    cs_bill_customer_sk character varying,
    cs_bill_cdemo_sk numeric(30,20),
    cs_bill_hdemo_sk character varying(19),
    cs_bill_addr_sk character varying(39),
    cs_ship_customer_sk bigint,
    cs_ship_cdemo_sk numeric(10,2),
    cs_ship_hdemo_sk numeric(20,7),
    cs_ship_addr_sk numeric(10,0),
    cs_call_center_sk double precision,
    cs_catalog_page_sk numeric(19,0),
    cs_ship_mode_sk numeric(20,18),
    cs_warehouse_sk numeric(30,19),
    cs_item_sk integer NOT NULL,
    cs_promo_sk bigint,
    cs_order_number bigint NOT NULL,
    cs_quantity text,
    cs_wholesale_cost numeric(7,2),
    cs_list_price numeric(15,4),
    cs_sales_price character varying(30),
    cs_ext_discount_amt numeric(15,2),
    cs_ext_sales_price numeric(13,6),
    cs_ext_wholesale_cost double precision,
    cs_ext_list_price numeric(7,2),
    cs_ext_tax numeric(36,18),
    cs_coupon_amt numeric(27,8),
    cs_ext_ship_cost numeric(20,4),
    cs_net_paid numeric(7,2),
    cs_net_paid_inc_tax numeric(20,5),
    cs_net_paid_inc_ship numeric(25,5),
    cs_net_paid_inc_ship_tax numeric(18,9),
    cs_net_profit numeric(30,20)
)
WITH (orientation=column, compression=low)
DISTRIBUTE BY HASH (cs_ext_tax, cs_coupon_amt, cs_net_paid_inc_tax)
PARTITION BY RANGE (cs_net_paid_inc_tax)
(
    PARTITION p1 VALUES LESS THAN (-3768.01),
    PARTITION p2 VALUES LESS THAN (-603.67),
    PARTITION p3 VALUES LESS THAN (-339.35),
    PARTITION p4 VALUES LESS THAN (-46.92),
    PARTITION p5 VALUES LESS THAN (84.24),
    PARTITION p6 VALUES LESS THAN (1098.66),
    PARTITION p7 VALUES LESS THAN (MAXVALUE)
)
ENABLE ROW MOVEMENT;
COPY catalog_sales_less (cs_sold_date_sk, cs_sold_time_sk, cs_ship_date_sk, cs_bill_customer_sk, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_bill_addr_sk, cs_ship_customer_sk, cs_ship_cdemo_sk, cs_ship_hdemo_sk, cs_ship_addr_sk, cs_call_center_sk, cs_catalog_page_sk, cs_ship_mode_sk, cs_warehouse_sk, cs_item_sk, cs_promo_sk, cs_order_number, cs_quantity, cs_wholesale_cost, cs_list_price, cs_sales_price, cs_ext_discount_amt, cs_ext_sales_price, cs_ext_wholesale_cost, cs_ext_list_price, cs_ext_tax, cs_coupon_amt, cs_ext_ship_cost, cs_net_paid, cs_net_paid_inc_tax, cs_net_paid_inc_ship, cs_net_paid_inc_ship_tax, cs_net_profit) FROM stdin;
select cs_wholesale_cost, cs_ext_list_price, i_color, cs_coupon_amt, cs_net_paid_inc_tax, i_container, cs_bill_cdemo_sk from item_less_1 inner join catalog_sales_less on cs_wholesale_cost <> greatest(cs_ext_list_price * i_color, cs_coupon_amt / cs_net_paid_inc_tax) and i_container <> cs_bill_cdemo_sk;
 cs_wholesale_cost | cs_ext_list_price | i_color | cs_coupon_amt | cs_net_paid_inc_tax | i_container |       cs_bill_cdemo_sk       
-------------------+-------------------+---------+---------------+---------------------+-------------+------------------------------
              7.59 |            339.07 |         |    0.00000000 |           236.03000 |      898.40 | 1743406.00000000000000000000
(1 row)

drop table item_less_1;
drop table catalog_sales_less;
-- Both COALESCE and GREATEST Expression
create table test_coalesce_greatest (id int, val1 numeric, val2 numeric) with(orientation=column) distribute by hash(id);
insert into test_coalesce_greatest values (1, 1, NULL), (1, NULL, 2), (1, 3, NULL), (1, NULL, 4);
select id, coalesce(val1, greatest(val2)) from test_coalesce_greatest order by 1, 2;
 id | coalesce 
----+----------
  1 |        1
  1 |        2
  1 |        3
  1 |        4
(4 rows)


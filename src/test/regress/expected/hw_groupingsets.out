create schema hw_groupingsets;
set search_path=hw_groupingsets;
create table gstest1(a int, b int, v int)with(orientation = column);
insert into gstest1 values (1,1,10),(1,1,11),(1,2,12),(1,2,13),(1,3,14),
(2,3,15),  (3,3,16), (3,4,17), (4,1,18), (4,1,19);
create table gstest2 (a integer, b integer, c integer, d integer,
                           e integer, f integer, g integer, h integer) with(orientation = column);
copy gstest2 from stdin;
create table gstest3 (a integer, b integer, c integer, d integer)with(orientation = column);
copy gstest3 from stdin;
select a, b, grouping(a,b), sum(v), count(*), max(v) from gstest1 group by rollup (a,b) order by 1, 2, 3, 4, 5, 6;
 a | b | grouping | sum | count | max 
---+---+----------+-----+-------+-----
 1 | 1 |        0 |  21 |     2 |  11
 1 | 2 |        0 |  25 |     2 |  13
 1 | 3 |        0 |  14 |     1 |  14
 1 |   |        1 |  60 |     5 |  14
 2 | 3 |        0 |  15 |     1 |  15
 2 |   |        1 |  15 |     1 |  15
 3 | 3 |        0 |  16 |     1 |  16
 3 | 4 |        0 |  17 |     1 |  17
 3 |   |        1 |  33 |     2 |  17
 4 | 1 |        0 |  37 |     2 |  19
 4 |   |        1 |  37 |     2 |  19
   |   |        3 | 145 |    10 |  19
(12 rows)

-- nesting with window functions
select a, b, sum(c), sum(sum(c)) over (order by a,b) as rsum from gstest2 group by rollup (a,b)  order by 1, 2, 3, 4;
 a | b | sum | rsum 
---+---+-----+------
 1 | 1 |   8 |    8
 1 | 2 |   2 |   10
 1 |   |  10 |   20
 2 | 2 |   2 |   22
 2 |   |   2 |   24
   |   |  12 |   36
(6 rows)

-- nesting with grouping sets
select sum(c) from gstest2 group by grouping sets((), grouping sets((), grouping sets(()))) order by 1 desc;
 sum 
-----
  12
  12
  12
(3 rows)

select sum(c) from gstest2 group by grouping sets((), grouping sets((), grouping sets(((a, b))))) order by 1 desc;
 sum 
-----
  12
  12
   8
   2
   2
(5 rows)

select sum(c) from gstest2 group by grouping sets(grouping sets(rollup(c), grouping sets(cube(c)))) order by 1 desc;
 sum 
-----
  12
  12
   6
   6
   6
   6
(6 rows)

select sum(c) from gstest2 group by grouping sets(a, grouping sets(a, cube(b))) order by 1 desc;
 sum 
-----
  12
  10
  10
   8
   4
   2
   2
(7 rows)

select sum(c) from gstest2 group by grouping sets(grouping sets((a, (b)))) order by 1 desc;
 sum 
-----
   8
   2
   2
(3 rows)

select sum(c) from gstest2 group by grouping sets(grouping sets((a, b))) order by 1 desc;
 sum 
-----
   8
   2
   2
(3 rows)

select sum(c) from gstest2 group by grouping sets(grouping sets(a, grouping sets(a), a)) order by 1 desc;
 sum 
-----
  10
  10
  10
   2
   2
   2
(6 rows)

select sum(c) from gstest2 group by grouping sets(grouping sets(a, grouping sets(a, grouping sets(a), ((a)), a, grouping sets(a), (a)), a)) order by 1 desc;
 sum 
-----
  10
  10
  10
  10
  10
  10
  10
  10
   2
   2
   2
   2
   2
   2
   2
   2
(16 rows)

select sum(c) from gstest2 group by grouping sets((a,(a,b)), grouping sets((a,(a,b)),a)) order by 1 desc;
 sum 
-----
  10
   8
   8
   2
   2
   2
   2
   2
(8 rows)

create table gstest_empty (a integer, b integer, v integer) with(orientation = column);
select a, b, sum(v), count(*) from gstest_empty group by grouping sets ((a,b),a);
 a | b | sum | count 
---+---+-----+-------
(0 rows)

select a, b, sum(v), count(*) from gstest_empty group by grouping sets ((a,b),());
 a | b | sum | count 
---+---+-----+-------
   |   |     |     0
(1 row)

select a, b, sum(v), count(*) from gstest_empty group by grouping sets ((a,b),(),(),());
 a | b | sum | count 
---+---+-----+-------
   |   |     |     0
   |   |     |     0
   |   |     |     0
(3 rows)

select a, b, avg(v), sum(v), count(*) from gstest_empty group by grouping sets ((a,b),(),(),());
 a | b | avg | sum | count 
---+---+-----+-----+-------
   |   |     |     |     0
   |   |     |     |     0
   |   |     |     |     0
(3 rows)

select sum(v), count(*) from gstest_empty group by grouping sets ((),(),());
 sum | count 
-----+-------
     |     0
     |     0
     |     0
(3 rows)

-- empty input with joins tests some important code paths
select t1.a, t2.b, sum(t1.v), count(*) from gstest_empty t1, gstest_empty t2 group by grouping sets ((t1.a,t2.b),());
 a | b | sum | count 
---+---+-----+-------
   |   |     |     0
(1 row)

-- simple joins, var resolution, GROUPING on join vars
select t1.a, t2.b, grouping(t1.a, t2.b), sum(t1.v), max(t2.a) from gstest1 t1, gstest2 t2 group by grouping sets ((t1.a, t2.b), ()) order by 1, 2, 3, 4, 5;
 a | b | grouping | sum  | max 
---+---+----------+------+-----
 1 | 1 |        0 |  420 |   1
 1 | 2 |        0 |  120 |   2
 2 | 1 |        0 |  105 |   1
 2 | 2 |        0 |   30 |   2
 3 | 1 |        0 |  231 |   1
 3 | 2 |        0 |   66 |   2
 4 | 1 |        0 |  259 |   1
 4 | 2 |        0 |   74 |   2
   |   |        3 | 1305 |   2
(9 rows)

select t1.a, t2.b, grouping(t1.a, t2.b), sum(t1.v), max(t2.a) from gstest1 t1 join gstest2 t2 on (t1.a=t2.a) group by grouping sets ((t1.a, t2.b), ())
order by 1, 2, 3, 4, 5;
 a | b | grouping | sum | max 
---+---+----------+-----+-----
 1 | 1 |        0 | 420 |   1
 1 | 2 |        0 |  60 |   1
 2 | 2 |        0 |  15 |   2
   |   |        3 | 495 |   2
(4 rows)

select a, b, grouping(a, b), sum(t1.v), max(t2.c) from gstest1 t1 join gstest2 t2 using (a,b) group by grouping sets ((a, b), ())  order by 1, 2, 3, 4, 5;;
 a | b | grouping | sum | max 
---+---+----------+-----+-----
 1 | 1 |        0 | 147 |   2
 1 | 2 |        0 |  25 |   2
   |   |        3 | 172 |   2
(3 rows)

-- check that functionally dependent cols are not nulled
select a, d, grouping(a,b,c) from gstest3 group by grouping sets ((a,b), (a,c));
ERROR:  column "gstest3.d" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: select a, d, grouping(a,b,c) from gstest3 group by grouping ...
                  ^
-- Views with GROUPING SET queries
select a, b, grouping(a,b), sum(c), count(*), max(c) from gstest2 group by rollup ((a,b,c),(c,d)) order by 1, 2, 3, 4, 5, 6;
 a | b | grouping | sum | count | max 
---+---+----------+-----+-------+-----
 1 | 1 |        0 |   1 |     1 |   1
 1 | 1 |        0 |   2 |     1 |   2
 1 | 1 |        0 |   2 |     1 |   2
 1 | 1 |        0 |   5 |     5 |   1
 1 | 1 |        0 |   6 |     6 |   1
 1 | 2 |        0 |   2 |     1 |   2
 1 | 2 |        0 |   2 |     1 |   2
 2 | 2 |        0 |   2 |     1 |   2
 2 | 2 |        0 |   2 |     1 |   2
   |   |        3 |  12 |     9 |   2
(10 rows)

select a, b, sum(c), sum(sum(c)) over (order by a,b) as rsum from gstest2 group by cube (a,b)  order by 1, 2, 3, 4;
 a | b | sum | rsum 
---+---+-----+------
 1 | 1 |   8 |    8
 1 | 2 |   2 |   10
 1 |   |  10 |   20
 2 | 2 |   2 |   22
 2 |   |   2 |   24
   | 1 |   8 |   32
   | 2 |   4 |   36
   |   |  12 |   48
(8 rows)

select a, b, sum(c) from (values (1,1,10),(1,1,11),(1,2,12),(1,2,13),(1,3,14),(2,3,15),(3,3,16),(3,4,17),(4,1,18),(4,1,19)) v(a,b,c) 
group by rollup (a,b) order by 1, 2, 3;
 a | b | sum 
---+---+-----
 1 | 1 |  21
 1 | 2 |  25
 1 | 3 |  14
 1 |   |  60
 2 | 3 |  15
 2 |   |  15
 3 | 3 |  16
 3 | 4 |  17
 3 |   |  33
 4 | 1 |  37
 4 |   |  37
   |   | 145
(12 rows)

-- Agg level check. This querys should error out.
select (select grouping(a,b) from gstest2) from gstest2 group by a,b;
ERROR:  arguments to GROUPING must be grouping expressions of the associated query level
LINE 1: select (select grouping(a,b) from gstest2) from gstest2 grou...
                                ^
select a, grouping(a, b, c) from gstest2 group by cube(a, b);
ERROR:  arguments to GROUPING must be grouping expressions of the associated query level
LINE 1: select a, grouping(a, b, c) from gstest2 group by cube(a, b)...
                                 ^
--Nested queries
select a, b, sum(c), count(*) from gstest2 group by grouping sets (rollup(a,b),a) order by 1, 2, 3, 4;
 a | b | sum | count 
---+---+-----+-------
 1 | 1 |   8 |     7
 1 | 2 |   2 |     1
 1 |   |  10 |     8
 1 |   |  10 |     8
 2 | 2 |   2 |     1
 2 |   |   2 |     1
 2 |   |   2 |     1
   |   |  12 |     9
(8 rows)

create table rtest(a int, b varchar(5), c char(5), d text, e numeric(5, 0), f timestamp);
insert into rtest values(1, generate_series(1, 2), generate_series(1, 3), generate_series(1, 4), generate_series(1, 6), '2012-12-16 10:11:15');
create table vec_aptest(a int, b varchar(5), c char(5), d text, e numeric(5, 0), f timestamp)with(orientation = column);
insert into vec_aptest select * from rtest;
select a, b, c, sum(a), avg(e), max(d), min(e) from vec_aptest group by rollup(a, b, c, d, e, f) order by 1, 2, 3, 4, 5, 6, 7;
 a | b |   c   | sum |          avg           | max | min 
---+---+-------+-----+------------------------+-----+-----
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 1 |       |   6 |     3.0000000000000000 | 3   |   1
 1 | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 1 | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 1 | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 1 | 2 |       |   6 |     4.0000000000000000 | 4   |   2
 1 |   |       |  12 |     3.5000000000000000 | 4   |   1
   |   |       |  12 |     3.5000000000000000 | 4   |   1
(46 rows)

select b, c, sum(a), avg(e), max(d), min(e) from vec_aptest group by rollup(b, c, d, e, f) order by 1, 2, 3, 4, 5, 6;
 b |   c   | sum |          avg           | max | min 
---+-------+-----+------------------------+-----+-----
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 |       |   6 |     3.0000000000000000 | 3   |   1
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 2 |       |   6 |     4.0000000000000000 | 4   |   2
   |       |  12 |     3.5000000000000000 | 4   |   1
(45 rows)

select b, c, sum(a), avg(e), max(d), min(e) from vec_aptest group by rollup(b, c, d, e) order by 1, 2, 3, 4, 5, 6;
 b |   c   | sum |          avg           | max | min 
---+-------+-----+------------------------+-----+-----
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 |       |   6 |     3.0000000000000000 | 3   |   1
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 2 |       |   6 |     4.0000000000000000 | 4   |   2
   |       |  12 |     3.5000000000000000 | 4   |   1
(33 rows)

select a, b, c, sum(a), avg(e), max(d), min(e) from vec_aptest group by cube(a, b, c, d, e, f) order by 1, 2, 3, 4, 5, 6, 7;
 a | b |   c   | sum |          avg           | max | min 
---+---+-------+-----+------------------------+-----+-----
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 1 |       |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 |       |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1 |       |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 |       |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1 |       |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 |       |   1 |     3.0000000000000000 | 1   |   3
 1 | 1 |       |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 |       |   1 |     3.0000000000000000 | 3   |   3
 1 | 1 |       |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 |       |   1 |     5.0000000000000000 | 1   |   5
 1 | 1 |       |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 |       |   1 |     5.0000000000000000 | 3   |   5
 1 | 1 |       |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1 |       |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1 |       |   2 |     3.0000000000000000 | 3   |   3
 1 | 1 |       |   2 |     3.0000000000000000 | 3   |   3
 1 | 1 |       |   2 |     5.0000000000000000 | 3   |   5
 1 | 1 |       |   2 |     5.0000000000000000 | 3   |   5
 1 | 1 |       |   3 |     3.0000000000000000 | 1   |   1
 1 | 1 |       |   3 |     3.0000000000000000 | 1   |   1
 1 | 1 |       |   3 |     3.0000000000000000 | 3   |   1
 1 | 1 |       |   3 |     3.0000000000000000 | 3   |   1
 1 | 1 |       |   6 |     3.0000000000000000 | 3   |   1
 1 | 1 |       |   6 |     3.0000000000000000 | 3   |   1
 1 | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 1 | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 1 | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 1 | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 1 | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 1 | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 1 | 2 |       |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 |       |   1 |     2.0000000000000000 | 2   |   2
 1 | 2 |       |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 |       |   1 |     2.0000000000000000 | 4   |   2
 1 | 2 |       |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 |       |   1 |     4.0000000000000000 | 2   |   4
 1 | 2 |       |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 |       |   1 |     4.0000000000000000 | 4   |   4
 1 | 2 |       |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 |       |   1 |     6.0000000000000000 | 2   |   6
 1 | 2 |       |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 |       |   1 |     6.0000000000000000 | 4   |   6
 1 | 2 |       |   2 |     2.0000000000000000 | 4   |   2
 1 | 2 |       |   2 |     2.0000000000000000 | 4   |   2
 1 | 2 |       |   2 |     4.0000000000000000 | 4   |   4
 1 | 2 |       |   2 |     4.0000000000000000 | 4   |   4
 1 | 2 |       |   2 |     6.0000000000000000 | 4   |   6
 1 | 2 |       |   2 |     6.0000000000000000 | 4   |   6
 1 | 2 |       |   3 |     4.0000000000000000 | 2   |   2
 1 | 2 |       |   3 |     4.0000000000000000 | 2   |   2
 1 | 2 |       |   3 |     4.0000000000000000 | 4   |   2
 1 | 2 |       |   3 |     4.0000000000000000 | 4   |   2
 1 | 2 |       |   6 |     4.0000000000000000 | 4   |   2
 1 | 2 |       |   6 |     4.0000000000000000 | 4   |   2
 1 |   | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 |   | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 |   | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 |   | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 |   | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 |   | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 |   | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 |   | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 |   | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 |   | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 |   | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 |   | 1     |   1 |     4.0000000000000000 | 2   |   4
 1 |   | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 |   | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 |   | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 |   | 1     |   1 |     4.0000000000000000 | 4   |   4
 1 |   | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 |   | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 |   | 1     |   2 |     4.0000000000000000 | 4   |   4
 1 |   | 1     |   2 |     4.0000000000000000 | 4   |   4
 1 |   | 1     |   4 |     2.5000000000000000 | 4   |   1
 1 |   | 1     |   4 |     2.5000000000000000 | 4   |   1
 1 |   | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 |   | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 |   | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 |   | 2     |   1 |     2.0000000000000000 | 2   |   2
 1 |   | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 |   | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 |   | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 |   | 2     |   1 |     2.0000000000000000 | 4   |   2
 1 |   | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 |   | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 |   | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 |   | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 |   | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 |   | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 |   | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 |   | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 |   | 2     |   2 |     2.0000000000000000 | 4   |   2
 1 |   | 2     |   2 |     2.0000000000000000 | 4   |   2
 1 |   | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 |   | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 |   | 2     |   4 |     3.5000000000000000 | 4   |   2
 1 |   | 2     |   4 |     3.5000000000000000 | 4   |   2
 1 |   | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 |   | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 |   | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 |   | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 |   | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 |   | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 |   | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 |   | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 |   | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 |   | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 |   | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 |   | 3     |   1 |     6.0000000000000000 | 2   |   6
 1 |   | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 |   | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 |   | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 |   | 3     |   1 |     6.0000000000000000 | 4   |   6
 1 |   | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 |   | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 |   | 3     |   2 |     6.0000000000000000 | 4   |   6
 1 |   | 3     |   2 |     6.0000000000000000 | 4   |   6
 1 |   | 3     |   4 |     4.5000000000000000 | 4   |   3
 1 |   | 3     |   4 |     4.5000000000000000 | 4   |   3
 1 |   |       |   1 | 1.00000000000000000000 | 1   |   1
 1 |   |       |   1 | 1.00000000000000000000 | 1   |   1
 1 |   |       |   1 | 1.00000000000000000000 | 3   |   1
 1 |   |       |   1 | 1.00000000000000000000 | 3   |   1
 1 |   |       |   1 |     2.0000000000000000 | 2   |   2
 1 |   |       |   1 |     2.0000000000000000 | 2   |   2
 1 |   |       |   1 |     2.0000000000000000 | 4   |   2
 1 |   |       |   1 |     2.0000000000000000 | 4   |   2
 1 |   |       |   1 |     3.0000000000000000 | 1   |   3
 1 |   |       |   1 |     3.0000000000000000 | 1   |   3
 1 |   |       |   1 |     3.0000000000000000 | 3   |   3
 1 |   |       |   1 |     3.0000000000000000 | 3   |   3
 1 |   |       |   1 |     4.0000000000000000 | 2   |   4
 1 |   |       |   1 |     4.0000000000000000 | 2   |   4
 1 |   |       |   1 |     4.0000000000000000 | 4   |   4
 1 |   |       |   1 |     4.0000000000000000 | 4   |   4
 1 |   |       |   1 |     5.0000000000000000 | 1   |   5
 1 |   |       |   1 |     5.0000000000000000 | 1   |   5
 1 |   |       |   1 |     5.0000000000000000 | 3   |   5
 1 |   |       |   1 |     5.0000000000000000 | 3   |   5
 1 |   |       |   1 |     6.0000000000000000 | 2   |   6
 1 |   |       |   1 |     6.0000000000000000 | 2   |   6
 1 |   |       |   1 |     6.0000000000000000 | 4   |   6
 1 |   |       |   1 |     6.0000000000000000 | 4   |   6
 1 |   |       |   2 | 1.00000000000000000000 | 3   |   1
 1 |   |       |   2 | 1.00000000000000000000 | 3   |   1
 1 |   |       |   2 |     2.0000000000000000 | 4   |   2
 1 |   |       |   2 |     2.0000000000000000 | 4   |   2
 1 |   |       |   2 |     3.0000000000000000 | 3   |   3
 1 |   |       |   2 |     3.0000000000000000 | 3   |   3
 1 |   |       |   2 |     4.0000000000000000 | 4   |   4
 1 |   |       |   2 |     4.0000000000000000 | 4   |   4
 1 |   |       |   2 |     5.0000000000000000 | 3   |   5
 1 |   |       |   2 |     5.0000000000000000 | 3   |   5
 1 |   |       |   2 |     6.0000000000000000 | 4   |   6
 1 |   |       |   2 |     6.0000000000000000 | 4   |   6
 1 |   |       |   3 |     3.0000000000000000 | 1   |   1
 1 |   |       |   3 |     3.0000000000000000 | 1   |   1
 1 |   |       |   3 |     3.0000000000000000 | 3   |   1
 1 |   |       |   3 |     3.0000000000000000 | 3   |   1
 1 |   |       |   3 |     4.0000000000000000 | 2   |   2
 1 |   |       |   3 |     4.0000000000000000 | 2   |   2
 1 |   |       |   3 |     4.0000000000000000 | 4   |   2
 1 |   |       |   3 |     4.0000000000000000 | 4   |   2
 1 |   |       |  12 |     3.5000000000000000 | 4   |   1
 1 |   |       |  12 |     3.5000000000000000 | 4   |   1
   | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
   | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
   | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
   | 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
   | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
   | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
   | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
   | 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
   | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
   | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
   | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
   | 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
   | 1 |       |   1 | 1.00000000000000000000 | 1   |   1
   | 1 |       |   1 | 1.00000000000000000000 | 1   |   1
   | 1 |       |   1 | 1.00000000000000000000 | 3   |   1
   | 1 |       |   1 | 1.00000000000000000000 | 3   |   1
   | 1 |       |   1 |     3.0000000000000000 | 1   |   3
   | 1 |       |   1 |     3.0000000000000000 | 1   |   3
   | 1 |       |   1 |     3.0000000000000000 | 3   |   3
   | 1 |       |   1 |     3.0000000000000000 | 3   |   3
   | 1 |       |   1 |     5.0000000000000000 | 1   |   5
   | 1 |       |   1 |     5.0000000000000000 | 1   |   5
   | 1 |       |   1 |     5.0000000000000000 | 3   |   5
   | 1 |       |   1 |     5.0000000000000000 | 3   |   5
   | 1 |       |   2 | 1.00000000000000000000 | 3   |   1
   | 1 |       |   2 | 1.00000000000000000000 | 3   |   1
   | 1 |       |   2 |     3.0000000000000000 | 3   |   3
   | 1 |       |   2 |     3.0000000000000000 | 3   |   3
   | 1 |       |   2 |     5.0000000000000000 | 3   |   5
   | 1 |       |   2 |     5.0000000000000000 | 3   |   5
   | 1 |       |   3 |     3.0000000000000000 | 1   |   1
   | 1 |       |   3 |     3.0000000000000000 | 1   |   1
   | 1 |       |   3 |     3.0000000000000000 | 3   |   1
   | 1 |       |   3 |     3.0000000000000000 | 3   |   1
   | 1 |       |   6 |     3.0000000000000000 | 3   |   1
   | 1 |       |   6 |     3.0000000000000000 | 3   |   1
   | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
   | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
   | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
   | 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
   | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
   | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
   | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
   | 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
   | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
   | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
   | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
   | 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
   | 2 |       |   1 |     2.0000000000000000 | 2   |   2
   | 2 |       |   1 |     2.0000000000000000 | 2   |   2
   | 2 |       |   1 |     2.0000000000000000 | 4   |   2
   | 2 |       |   1 |     2.0000000000000000 | 4   |   2
   | 2 |       |   1 |     4.0000000000000000 | 2   |   4
   | 2 |       |   1 |     4.0000000000000000 | 2   |   4
   | 2 |       |   1 |     4.0000000000000000 | 4   |   4
   | 2 |       |   1 |     4.0000000000000000 | 4   |   4
   | 2 |       |   1 |     6.0000000000000000 | 2   |   6
   | 2 |       |   1 |     6.0000000000000000 | 2   |   6
   | 2 |       |   1 |     6.0000000000000000 | 4   |   6
   | 2 |       |   1 |     6.0000000000000000 | 4   |   6
   | 2 |       |   2 |     2.0000000000000000 | 4   |   2
   | 2 |       |   2 |     2.0000000000000000 | 4   |   2
   | 2 |       |   2 |     4.0000000000000000 | 4   |   4
   | 2 |       |   2 |     4.0000000000000000 | 4   |   4
   | 2 |       |   2 |     6.0000000000000000 | 4   |   6
   | 2 |       |   2 |     6.0000000000000000 | 4   |   6
   | 2 |       |   3 |     4.0000000000000000 | 2   |   2
   | 2 |       |   3 |     4.0000000000000000 | 2   |   2
   | 2 |       |   3 |     4.0000000000000000 | 4   |   2
   | 2 |       |   3 |     4.0000000000000000 | 4   |   2
   | 2 |       |   6 |     4.0000000000000000 | 4   |   2
   | 2 |       |   6 |     4.0000000000000000 | 4   |   2
   |   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   |   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   |   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   |   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   |   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   |   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   |   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   |   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   |   | 1     |   1 |     4.0000000000000000 | 2   |   4
   |   | 1     |   1 |     4.0000000000000000 | 2   |   4
   |   | 1     |   1 |     4.0000000000000000 | 2   |   4
   |   | 1     |   1 |     4.0000000000000000 | 2   |   4
   |   | 1     |   1 |     4.0000000000000000 | 4   |   4
   |   | 1     |   1 |     4.0000000000000000 | 4   |   4
   |   | 1     |   1 |     4.0000000000000000 | 4   |   4
   |   | 1     |   1 |     4.0000000000000000 | 4   |   4
   |   | 1     |   2 | 1.00000000000000000000 | 3   |   1
   |   | 1     |   2 | 1.00000000000000000000 | 3   |   1
   |   | 1     |   2 |     4.0000000000000000 | 4   |   4
   |   | 1     |   2 |     4.0000000000000000 | 4   |   4
   |   | 1     |   4 |     2.5000000000000000 | 4   |   1
   |   | 1     |   4 |     2.5000000000000000 | 4   |   1
   |   | 2     |   1 |     2.0000000000000000 | 2   |   2
   |   | 2     |   1 |     2.0000000000000000 | 2   |   2
   |   | 2     |   1 |     2.0000000000000000 | 2   |   2
   |   | 2     |   1 |     2.0000000000000000 | 2   |   2
   |   | 2     |   1 |     2.0000000000000000 | 4   |   2
   |   | 2     |   1 |     2.0000000000000000 | 4   |   2
   |   | 2     |   1 |     2.0000000000000000 | 4   |   2
   |   | 2     |   1 |     2.0000000000000000 | 4   |   2
   |   | 2     |   1 |     5.0000000000000000 | 1   |   5
   |   | 2     |   1 |     5.0000000000000000 | 1   |   5
   |   | 2     |   1 |     5.0000000000000000 | 1   |   5
   |   | 2     |   1 |     5.0000000000000000 | 1   |   5
   |   | 2     |   1 |     5.0000000000000000 | 3   |   5
   |   | 2     |   1 |     5.0000000000000000 | 3   |   5
   |   | 2     |   1 |     5.0000000000000000 | 3   |   5
   |   | 2     |   1 |     5.0000000000000000 | 3   |   5
   |   | 2     |   2 |     2.0000000000000000 | 4   |   2
   |   | 2     |   2 |     2.0000000000000000 | 4   |   2
   |   | 2     |   2 |     5.0000000000000000 | 3   |   5
   |   | 2     |   2 |     5.0000000000000000 | 3   |   5
   |   | 2     |   4 |     3.5000000000000000 | 4   |   2
   |   | 2     |   4 |     3.5000000000000000 | 4   |   2
   |   | 3     |   1 |     3.0000000000000000 | 1   |   3
   |   | 3     |   1 |     3.0000000000000000 | 1   |   3
   |   | 3     |   1 |     3.0000000000000000 | 1   |   3
   |   | 3     |   1 |     3.0000000000000000 | 1   |   3
   |   | 3     |   1 |     3.0000000000000000 | 3   |   3
   |   | 3     |   1 |     3.0000000000000000 | 3   |   3
   |   | 3     |   1 |     3.0000000000000000 | 3   |   3
   |   | 3     |   1 |     3.0000000000000000 | 3   |   3
   |   | 3     |   1 |     6.0000000000000000 | 2   |   6
   |   | 3     |   1 |     6.0000000000000000 | 2   |   6
   |   | 3     |   1 |     6.0000000000000000 | 2   |   6
   |   | 3     |   1 |     6.0000000000000000 | 2   |   6
   |   | 3     |   1 |     6.0000000000000000 | 4   |   6
   |   | 3     |   1 |     6.0000000000000000 | 4   |   6
   |   | 3     |   1 |     6.0000000000000000 | 4   |   6
   |   | 3     |   1 |     6.0000000000000000 | 4   |   6
   |   | 3     |   2 |     3.0000000000000000 | 3   |   3
   |   | 3     |   2 |     3.0000000000000000 | 3   |   3
   |   | 3     |   2 |     6.0000000000000000 | 4   |   6
   |   | 3     |   2 |     6.0000000000000000 | 4   |   6
   |   | 3     |   4 |     4.5000000000000000 | 4   |   3
   |   | 3     |   4 |     4.5000000000000000 | 4   |   3
   |   |       |   1 | 1.00000000000000000000 | 1   |   1
   |   |       |   1 | 1.00000000000000000000 | 1   |   1
   |   |       |   1 | 1.00000000000000000000 | 3   |   1
   |   |       |   1 | 1.00000000000000000000 | 3   |   1
   |   |       |   1 |     2.0000000000000000 | 2   |   2
   |   |       |   1 |     2.0000000000000000 | 2   |   2
   |   |       |   1 |     2.0000000000000000 | 4   |   2
   |   |       |   1 |     2.0000000000000000 | 4   |   2
   |   |       |   1 |     3.0000000000000000 | 1   |   3
   |   |       |   1 |     3.0000000000000000 | 1   |   3
   |   |       |   1 |     3.0000000000000000 | 3   |   3
   |   |       |   1 |     3.0000000000000000 | 3   |   3
   |   |       |   1 |     4.0000000000000000 | 2   |   4
   |   |       |   1 |     4.0000000000000000 | 2   |   4
   |   |       |   1 |     4.0000000000000000 | 4   |   4
   |   |       |   1 |     4.0000000000000000 | 4   |   4
   |   |       |   1 |     5.0000000000000000 | 1   |   5
   |   |       |   1 |     5.0000000000000000 | 1   |   5
   |   |       |   1 |     5.0000000000000000 | 3   |   5
   |   |       |   1 |     5.0000000000000000 | 3   |   5
   |   |       |   1 |     6.0000000000000000 | 2   |   6
   |   |       |   1 |     6.0000000000000000 | 2   |   6
   |   |       |   1 |     6.0000000000000000 | 4   |   6
   |   |       |   1 |     6.0000000000000000 | 4   |   6
   |   |       |   2 | 1.00000000000000000000 | 3   |   1
   |   |       |   2 | 1.00000000000000000000 | 3   |   1
   |   |       |   2 |     2.0000000000000000 | 4   |   2
   |   |       |   2 |     2.0000000000000000 | 4   |   2
   |   |       |   2 |     3.0000000000000000 | 3   |   3
   |   |       |   2 |     3.0000000000000000 | 3   |   3
   |   |       |   2 |     4.0000000000000000 | 4   |   4
   |   |       |   2 |     4.0000000000000000 | 4   |   4
   |   |       |   2 |     5.0000000000000000 | 3   |   5
   |   |       |   2 |     5.0000000000000000 | 3   |   5
   |   |       |   2 |     6.0000000000000000 | 4   |   6
   |   |       |   2 |     6.0000000000000000 | 4   |   6
   |   |       |   3 |     3.0000000000000000 | 1   |   1
   |   |       |   3 |     3.0000000000000000 | 1   |   1
   |   |       |   3 |     3.0000000000000000 | 3   |   1
   |   |       |   3 |     3.0000000000000000 | 3   |   1
   |   |       |   3 |     4.0000000000000000 | 2   |   2
   |   |       |   3 |     4.0000000000000000 | 2   |   2
   |   |       |   3 |     4.0000000000000000 | 4   |   2
   |   |       |   3 |     4.0000000000000000 | 4   |   2
   |   |       |  12 |     3.5000000000000000 | 4   |   1
   |   |       |  12 |     3.5000000000000000 | 4   |   1
(464 rows)

select b, c, sum(a), avg(e), max(d), min(e) from vec_aptest group by cube(b, c, d, e, f) order by 1, 2, 3, 4, 5, 6;
 b |   c   | sum |          avg           | max | min 
---+-------+-----+------------------------+-----+-----
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 |       |   1 | 1.00000000000000000000 | 1   |   1
 1 |       |   1 | 1.00000000000000000000 | 1   |   1
 1 |       |   1 | 1.00000000000000000000 | 3   |   1
 1 |       |   1 | 1.00000000000000000000 | 3   |   1
 1 |       |   1 |     3.0000000000000000 | 1   |   3
 1 |       |   1 |     3.0000000000000000 | 1   |   3
 1 |       |   1 |     3.0000000000000000 | 3   |   3
 1 |       |   1 |     3.0000000000000000 | 3   |   3
 1 |       |   1 |     5.0000000000000000 | 1   |   5
 1 |       |   1 |     5.0000000000000000 | 1   |   5
 1 |       |   1 |     5.0000000000000000 | 3   |   5
 1 |       |   1 |     5.0000000000000000 | 3   |   5
 1 |       |   2 | 1.00000000000000000000 | 3   |   1
 1 |       |   2 | 1.00000000000000000000 | 3   |   1
 1 |       |   2 |     3.0000000000000000 | 3   |   3
 1 |       |   2 |     3.0000000000000000 | 3   |   3
 1 |       |   2 |     5.0000000000000000 | 3   |   5
 1 |       |   2 |     5.0000000000000000 | 3   |   5
 1 |       |   3 |     3.0000000000000000 | 1   |   1
 1 |       |   3 |     3.0000000000000000 | 1   |   1
 1 |       |   3 |     3.0000000000000000 | 3   |   1
 1 |       |   3 |     3.0000000000000000 | 3   |   1
 1 |       |   6 |     3.0000000000000000 | 3   |   1
 1 |       |   6 |     3.0000000000000000 | 3   |   1
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 2 |       |   1 |     2.0000000000000000 | 2   |   2
 2 |       |   1 |     2.0000000000000000 | 2   |   2
 2 |       |   1 |     2.0000000000000000 | 4   |   2
 2 |       |   1 |     2.0000000000000000 | 4   |   2
 2 |       |   1 |     4.0000000000000000 | 2   |   4
 2 |       |   1 |     4.0000000000000000 | 2   |   4
 2 |       |   1 |     4.0000000000000000 | 4   |   4
 2 |       |   1 |     4.0000000000000000 | 4   |   4
 2 |       |   1 |     6.0000000000000000 | 2   |   6
 2 |       |   1 |     6.0000000000000000 | 2   |   6
 2 |       |   1 |     6.0000000000000000 | 4   |   6
 2 |       |   1 |     6.0000000000000000 | 4   |   6
 2 |       |   2 |     2.0000000000000000 | 4   |   2
 2 |       |   2 |     2.0000000000000000 | 4   |   2
 2 |       |   2 |     4.0000000000000000 | 4   |   4
 2 |       |   2 |     4.0000000000000000 | 4   |   4
 2 |       |   2 |     6.0000000000000000 | 4   |   6
 2 |       |   2 |     6.0000000000000000 | 4   |   6
 2 |       |   3 |     4.0000000000000000 | 2   |   2
 2 |       |   3 |     4.0000000000000000 | 2   |   2
 2 |       |   3 |     4.0000000000000000 | 4   |   2
 2 |       |   3 |     4.0000000000000000 | 4   |   2
 2 |       |   6 |     4.0000000000000000 | 4   |   2
 2 |       |   6 |     4.0000000000000000 | 4   |   2
   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 1     |   2 | 1.00000000000000000000 | 3   |   1
   | 1     |   2 | 1.00000000000000000000 | 3   |   1
   | 1     |   2 |     4.0000000000000000 | 4   |   4
   | 1     |   2 |     4.0000000000000000 | 4   |   4
   | 1     |   4 |     2.5000000000000000 | 4   |   1
   | 1     |   4 |     2.5000000000000000 | 4   |   1
   | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 2     |   2 |     2.0000000000000000 | 4   |   2
   | 2     |   2 |     2.0000000000000000 | 4   |   2
   | 2     |   2 |     5.0000000000000000 | 3   |   5
   | 2     |   2 |     5.0000000000000000 | 3   |   5
   | 2     |   4 |     3.5000000000000000 | 4   |   2
   | 2     |   4 |     3.5000000000000000 | 4   |   2
   | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 3     |   2 |     3.0000000000000000 | 3   |   3
   | 3     |   2 |     3.0000000000000000 | 3   |   3
   | 3     |   2 |     6.0000000000000000 | 4   |   6
   | 3     |   2 |     6.0000000000000000 | 4   |   6
   | 3     |   4 |     4.5000000000000000 | 4   |   3
   | 3     |   4 |     4.5000000000000000 | 4   |   3
   |       |   1 | 1.00000000000000000000 | 1   |   1
   |       |   1 | 1.00000000000000000000 | 1   |   1
   |       |   1 | 1.00000000000000000000 | 3   |   1
   |       |   1 | 1.00000000000000000000 | 3   |   1
   |       |   1 |     2.0000000000000000 | 2   |   2
   |       |   1 |     2.0000000000000000 | 2   |   2
   |       |   1 |     2.0000000000000000 | 4   |   2
   |       |   1 |     2.0000000000000000 | 4   |   2
   |       |   1 |     3.0000000000000000 | 1   |   3
   |       |   1 |     3.0000000000000000 | 1   |   3
   |       |   1 |     3.0000000000000000 | 3   |   3
   |       |   1 |     3.0000000000000000 | 3   |   3
   |       |   1 |     4.0000000000000000 | 2   |   4
   |       |   1 |     4.0000000000000000 | 2   |   4
   |       |   1 |     4.0000000000000000 | 4   |   4
   |       |   1 |     4.0000000000000000 | 4   |   4
   |       |   1 |     5.0000000000000000 | 1   |   5
   |       |   1 |     5.0000000000000000 | 1   |   5
   |       |   1 |     5.0000000000000000 | 3   |   5
   |       |   1 |     5.0000000000000000 | 3   |   5
   |       |   1 |     6.0000000000000000 | 2   |   6
   |       |   1 |     6.0000000000000000 | 2   |   6
   |       |   1 |     6.0000000000000000 | 4   |   6
   |       |   1 |     6.0000000000000000 | 4   |   6
   |       |   2 | 1.00000000000000000000 | 3   |   1
   |       |   2 | 1.00000000000000000000 | 3   |   1
   |       |   2 |     2.0000000000000000 | 4   |   2
   |       |   2 |     2.0000000000000000 | 4   |   2
   |       |   2 |     3.0000000000000000 | 3   |   3
   |       |   2 |     3.0000000000000000 | 3   |   3
   |       |   2 |     4.0000000000000000 | 4   |   4
   |       |   2 |     4.0000000000000000 | 4   |   4
   |       |   2 |     5.0000000000000000 | 3   |   5
   |       |   2 |     5.0000000000000000 | 3   |   5
   |       |   2 |     6.0000000000000000 | 4   |   6
   |       |   2 |     6.0000000000000000 | 4   |   6
   |       |   3 |     3.0000000000000000 | 1   |   1
   |       |   3 |     3.0000000000000000 | 1   |   1
   |       |   3 |     3.0000000000000000 | 3   |   1
   |       |   3 |     3.0000000000000000 | 3   |   1
   |       |   3 |     4.0000000000000000 | 2   |   2
   |       |   3 |     4.0000000000000000 | 2   |   2
   |       |   3 |     4.0000000000000000 | 4   |   2
   |       |   3 |     4.0000000000000000 | 4   |   2
   |       |  12 |     3.5000000000000000 | 4   |   1
   |       |  12 |     3.5000000000000000 | 4   |   1
(232 rows)

select b, c, sum(a), avg(e), max(d), min(e) from vec_aptest group by cube(b, c, d, e) order by 1, 2, 3, 4, 5, 6;
 b |   c   | sum |          avg           | max | min 
---+-------+-----+------------------------+-----+-----
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 1   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   1 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 1     |   2 | 1.00000000000000000000 | 3   |   1
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 1   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   1 |     5.0000000000000000 | 3   |   5
 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 2     |   2 |     5.0000000000000000 | 3   |   5
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 1   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   1 |     3.0000000000000000 | 3   |   3
 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 | 3     |   2 |     3.0000000000000000 | 3   |   3
 1 |       |   1 | 1.00000000000000000000 | 1   |   1
 1 |       |   1 | 1.00000000000000000000 | 3   |   1
 1 |       |   1 |     3.0000000000000000 | 1   |   3
 1 |       |   1 |     3.0000000000000000 | 3   |   3
 1 |       |   1 |     5.0000000000000000 | 1   |   5
 1 |       |   1 |     5.0000000000000000 | 3   |   5
 1 |       |   2 | 1.00000000000000000000 | 3   |   1
 1 |       |   2 |     3.0000000000000000 | 3   |   3
 1 |       |   2 |     5.0000000000000000 | 3   |   5
 1 |       |   3 |     3.0000000000000000 | 1   |   1
 1 |       |   3 |     3.0000000000000000 | 3   |   1
 1 |       |   6 |     3.0000000000000000 | 3   |   1
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 2   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   1 |     4.0000000000000000 | 4   |   4
 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 2 | 1     |   2 |     4.0000000000000000 | 4   |   4
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 2   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   1 |     2.0000000000000000 | 4   |   2
 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 2 | 2     |   2 |     2.0000000000000000 | 4   |   2
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 2   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   1 |     6.0000000000000000 | 4   |   6
 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 2 | 3     |   2 |     6.0000000000000000 | 4   |   6
 2 |       |   1 |     2.0000000000000000 | 2   |   2
 2 |       |   1 |     2.0000000000000000 | 4   |   2
 2 |       |   1 |     4.0000000000000000 | 2   |   4
 2 |       |   1 |     4.0000000000000000 | 4   |   4
 2 |       |   1 |     6.0000000000000000 | 2   |   6
 2 |       |   1 |     6.0000000000000000 | 4   |   6
 2 |       |   2 |     2.0000000000000000 | 4   |   2
 2 |       |   2 |     4.0000000000000000 | 4   |   4
 2 |       |   2 |     6.0000000000000000 | 4   |   6
 2 |       |   3 |     4.0000000000000000 | 2   |   2
 2 |       |   3 |     4.0000000000000000 | 4   |   2
 2 |       |   6 |     4.0000000000000000 | 4   |   2
   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1     |   1 | 1.00000000000000000000 | 1   |   1
   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1     |   1 | 1.00000000000000000000 | 3   |   1
   | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 1     |   1 |     4.0000000000000000 | 2   |   4
   | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 1     |   1 |     4.0000000000000000 | 4   |   4
   | 1     |   2 | 1.00000000000000000000 | 3   |   1
   | 1     |   2 |     4.0000000000000000 | 4   |   4
   | 1     |   4 |     2.5000000000000000 | 4   |   1
   | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2     |   1 |     2.0000000000000000 | 2   |   2
   | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2     |   1 |     2.0000000000000000 | 4   |   2
   | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 2     |   1 |     5.0000000000000000 | 1   |   5
   | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 2     |   1 |     5.0000000000000000 | 3   |   5
   | 2     |   2 |     2.0000000000000000 | 4   |   2
   | 2     |   2 |     5.0000000000000000 | 3   |   5
   | 2     |   4 |     3.5000000000000000 | 4   |   2
   | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 3     |   1 |     3.0000000000000000 | 1   |   3
   | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 3     |   1 |     3.0000000000000000 | 3   |   3
   | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 3     |   1 |     6.0000000000000000 | 2   |   6
   | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 3     |   1 |     6.0000000000000000 | 4   |   6
   | 3     |   2 |     3.0000000000000000 | 3   |   3
   | 3     |   2 |     6.0000000000000000 | 4   |   6
   | 3     |   4 |     4.5000000000000000 | 4   |   3
   |       |   1 | 1.00000000000000000000 | 1   |   1
   |       |   1 | 1.00000000000000000000 | 3   |   1
   |       |   1 |     2.0000000000000000 | 2   |   2
   |       |   1 |     2.0000000000000000 | 4   |   2
   |       |   1 |     3.0000000000000000 | 1   |   3
   |       |   1 |     3.0000000000000000 | 3   |   3
   |       |   1 |     4.0000000000000000 | 2   |   4
   |       |   1 |     4.0000000000000000 | 4   |   4
   |       |   1 |     5.0000000000000000 | 1   |   5
   |       |   1 |     5.0000000000000000 | 3   |   5
   |       |   1 |     6.0000000000000000 | 2   |   6
   |       |   1 |     6.0000000000000000 | 4   |   6
   |       |   2 | 1.00000000000000000000 | 3   |   1
   |       |   2 |     2.0000000000000000 | 4   |   2
   |       |   2 |     3.0000000000000000 | 3   |   3
   |       |   2 |     4.0000000000000000 | 4   |   4
   |       |   2 |     5.0000000000000000 | 3   |   5
   |       |   2 |     6.0000000000000000 | 4   |   6
   |       |   3 |     3.0000000000000000 | 1   |   1
   |       |   3 |     3.0000000000000000 | 3   |   1
   |       |   3 |     4.0000000000000000 | 2   |   2
   |       |   3 |     4.0000000000000000 | 4   |   2
   |       |  12 |     3.5000000000000000 | 4   |   1
(116 rows)

explain (costs off)select a, b, c from vec_aptest where b = '12' 
group by rollup(a), grouping sets(b, c)
order by 1,2,3;
                         QUERY PLAN                         
------------------------------------------------------------
 Row Adapter
   ->  Vector Sort
         Sort Key: a, b, c
         ->  Vector Sort Aggregate
               Group By Key: b, a
               Group By Key: b
               Sort Key: c, a
                 Group By Key: c, a
                 Group By Key: c
               ->  Vector Sort
                     Sort Key: b, a
                     ->  CStore Scan on vec_aptest
                           Filter: ((b)::text = '12'::text)
(13 rows)

explain (costs off)select a, b, c, d from vec_aptest where d = '12' 
group by rollup(a, b, c), grouping sets(d)
order by 1, 2, 3, 4;
                     QUERY PLAN                     
----------------------------------------------------
 Row Adapter
   ->  Vector Sort
         Sort Key: a, b, c
         ->  Vector Sort Aggregate
               Group By Key: d, a, b, c
               Group By Key: d, a, b
               Group By Key: d, a
               Group By Key: d
               ->  Vector Sort
                     Sort Key: d, a, b, c
                     ->  CStore Scan on vec_aptest
                           Filter: (d = '12'::text)
(12 rows)

drop table rtest;
delete from vec_aptest;
--test include duplicate columns
insert into vec_aptest values(generate_series(1, 10), generate_series(1, 10), generate_series(1, 10), generate_series(1, 10), generate_series(1, 10), '2012-12-16 10:11:15');
select a, b, sum(a), avg(e), max(d), min(e) from vec_aptest group by rollup(a, a, b) order by 1, 2, 3, 4, 5, 6;
 a  | b  | sum |          avg           | max | min 
----+----+-----+------------------------+-----+-----
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 |    |   1 | 1.00000000000000000000 | 1   |   1
  1 |    |   1 | 1.00000000000000000000 | 1   |   1
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 |    |   2 |     2.0000000000000000 | 2   |   2
  2 |    |   2 |     2.0000000000000000 | 2   |   2
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 |    |   3 |     3.0000000000000000 | 3   |   3
  3 |    |   3 |     3.0000000000000000 | 3   |   3
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 |    |   4 |     4.0000000000000000 | 4   |   4
  4 |    |   4 |     4.0000000000000000 | 4   |   4
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 |    |   5 |     5.0000000000000000 | 5   |   5
  5 |    |   5 |     5.0000000000000000 | 5   |   5
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 |    |   6 |     6.0000000000000000 | 6   |   6
  6 |    |   6 |     6.0000000000000000 | 6   |   6
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 |    |   7 |     7.0000000000000000 | 7   |   7
  7 |    |   7 |     7.0000000000000000 | 7   |   7
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 |    |   8 |     8.0000000000000000 | 8   |   8
  8 |    |   8 |     8.0000000000000000 | 8   |   8
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 |    |   9 |     9.0000000000000000 | 9   |   9
  9 |    |   9 |     9.0000000000000000 | 9   |   9
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 |    |  10 |    10.0000000000000000 | 10  |  10
 10 |    |  10 |    10.0000000000000000 | 10  |  10
    |    |  55 |     5.5000000000000000 | 9   |   1
(31 rows)

select a, b, sum(a), avg(e), max(d), min(e) from vec_aptest group by rollup((a, b), (a, b)) order by 1, 2, 3, 4, 5, 6;
 a  | b  | sum |          avg           | max | min 
----+----+-----+------------------------+-----+-----
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
    |    |  55 |     5.5000000000000000 | 9   |   1
(21 rows)

select a, b, sum(a), avg(e), max(d), min(e) from vec_aptest group by rollup((a, b), (c, d)) order by 1, 2, 3, 4, 5, 6;
 a  | b  | sum |          avg           | max | min 
----+----+-----+------------------------+-----+-----
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
    |    |  55 |     5.5000000000000000 | 9   |   1
(21 rows)

select a, b, sum(a), avg(e), max(d), min(e) from vec_aptest group by cube(a, a, b) order by 1, 2, 3, 4, 5, 6;
 a  | b  | sum |          avg           | max | min 
----+----+-----+------------------------+-----+-----
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 |    |   1 | 1.00000000000000000000 | 1   |   1
  1 |    |   1 | 1.00000000000000000000 | 1   |   1
  1 |    |   1 | 1.00000000000000000000 | 1   |   1
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 |    |   2 |     2.0000000000000000 | 2   |   2
  2 |    |   2 |     2.0000000000000000 | 2   |   2
  2 |    |   2 |     2.0000000000000000 | 2   |   2
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 |    |   3 |     3.0000000000000000 | 3   |   3
  3 |    |   3 |     3.0000000000000000 | 3   |   3
  3 |    |   3 |     3.0000000000000000 | 3   |   3
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 |    |   4 |     4.0000000000000000 | 4   |   4
  4 |    |   4 |     4.0000000000000000 | 4   |   4
  4 |    |   4 |     4.0000000000000000 | 4   |   4
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 |    |   5 |     5.0000000000000000 | 5   |   5
  5 |    |   5 |     5.0000000000000000 | 5   |   5
  5 |    |   5 |     5.0000000000000000 | 5   |   5
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 |    |   6 |     6.0000000000000000 | 6   |   6
  6 |    |   6 |     6.0000000000000000 | 6   |   6
  6 |    |   6 |     6.0000000000000000 | 6   |   6
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 |    |   7 |     7.0000000000000000 | 7   |   7
  7 |    |   7 |     7.0000000000000000 | 7   |   7
  7 |    |   7 |     7.0000000000000000 | 7   |   7
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 |    |   8 |     8.0000000000000000 | 8   |   8
  8 |    |   8 |     8.0000000000000000 | 8   |   8
  8 |    |   8 |     8.0000000000000000 | 8   |   8
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 |    |   9 |     9.0000000000000000 | 9   |   9
  9 |    |   9 |     9.0000000000000000 | 9   |   9
  9 |    |   9 |     9.0000000000000000 | 9   |   9
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 |    |  10 |    10.0000000000000000 | 10  |  10
 10 |    |  10 |    10.0000000000000000 | 10  |  10
 10 |    |  10 |    10.0000000000000000 | 10  |  10
    | 1  |   1 | 1.00000000000000000000 | 1   |   1
    | 10 |  10 |    10.0000000000000000 | 10  |  10
    | 2  |   2 |     2.0000000000000000 | 2   |   2
    | 3  |   3 |     3.0000000000000000 | 3   |   3
    | 4  |   4 |     4.0000000000000000 | 4   |   4
    | 5  |   5 |     5.0000000000000000 | 5   |   5
    | 6  |   6 |     6.0000000000000000 | 6   |   6
    | 7  |   7 |     7.0000000000000000 | 7   |   7
    | 8  |   8 |     8.0000000000000000 | 8   |   8
    | 9  |   9 |     9.0000000000000000 | 9   |   9
    |    |  55 |     5.5000000000000000 | 9   |   1
(71 rows)

select a, b, sum(a), avg(e), max(d), min(e) from vec_aptest group by cube((a, b), (a, b)) order by 1, 2, 3, 4, 5, 6;
 a  | b  | sum |          avg           | max | min 
----+----+-----+------------------------+-----+-----
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
    |    |  55 |     5.5000000000000000 | 9   |   1
(31 rows)

select a, b, sum(a), avg(e), max(d), min(e) from vec_aptest group by cube((a, b), (c, d)) order by 1, 2, 3, 4, 5, 6;
 a  | b  | sum |          avg           | max | min 
----+----+-----+------------------------+-----+-----
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  1 | 1  |   1 | 1.00000000000000000000 | 1   |   1
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  2 | 2  |   2 |     2.0000000000000000 | 2   |   2
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  3 | 3  |   3 |     3.0000000000000000 | 3   |   3
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  4 | 4  |   4 |     4.0000000000000000 | 4   |   4
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  5 | 5  |   5 |     5.0000000000000000 | 5   |   5
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  6 | 6  |   6 |     6.0000000000000000 | 6   |   6
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  7 | 7  |   7 |     7.0000000000000000 | 7   |   7
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  8 | 8  |   8 |     8.0000000000000000 | 8   |   8
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
  9 | 9  |   9 |     9.0000000000000000 | 9   |   9
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
 10 | 10 |  10 |    10.0000000000000000 | 10  |  10
    |    |   1 | 1.00000000000000000000 | 1   |   1
    |    |   2 |     2.0000000000000000 | 2   |   2
    |    |   3 |     3.0000000000000000 | 3   |   3
    |    |   4 |     4.0000000000000000 | 4   |   4
    |    |   5 |     5.0000000000000000 | 5   |   5
    |    |   6 |     6.0000000000000000 | 6   |   6
    |    |   7 |     7.0000000000000000 | 7   |   7
    |    |   8 |     8.0000000000000000 | 8   |   8
    |    |   9 |     9.0000000000000000 | 9   |   9
    |    |  10 |    10.0000000000000000 | 10  |  10
    |    |  55 |     5.5000000000000000 | 9   |   1
(31 rows)

create table vec_t1(a int, b int, c int)with(orientation = column);
explain (verbose on, costs off) select a, rank() over (partition by grouping(a)) from vec_t1 group by rollup(a, b, c) order by 1, 2;
                                       QUERY PLAN                                       
----------------------------------------------------------------------------------------
 Row Adapter
   Output: a, (rank() OVER (PARTITION BY (GROUPING(a)))), b, c, (GROUPING(a))
   ->  Vector Sort
         Output: a, (rank() OVER (PARTITION BY (GROUPING(a)))), b, c, (GROUPING(a))
         Sort Key: vec_t1.a, (rank() OVER (PARTITION BY (GROUPING(vec_t1.a))))
         ->  Vector WindowAgg
               Output: a, rank() OVER (PARTITION BY (GROUPING(a))), b, c, (GROUPING(a))
               ->  Vector Sort
                     Output: a, b, c, (GROUPING(a))
                     Sort Key: (GROUPING(vec_t1.a))
                     ->  Vector Sort Aggregate
                           Output: a, b, c, GROUPING(a)
                           Group By Key: vec_t1.a, vec_t1.b, vec_t1.c
                           Group By Key: vec_t1.a, vec_t1.b
                           Group By Key: vec_t1.a
                           Group By Key: ()
                           ->  Vector Sort
                                 Output: a, b, c
                                 Sort Key: vec_t1.a, vec_t1.b, vec_t1.c
                                 ->  CStore Scan on hw_groupingsets.vec_t1
                                       Output: a, b, c
(21 rows)

insert into vec_t1 values(generate_series(1, 10), generate_series(1, 10), generate_series(1, 10));
explain (verbose on, costs off) select avg(a), count(distinct b), count(distinct c) from vec_t1 group by ();
                          QUERY PLAN                          
--------------------------------------------------------------
 Row Adapter
   Output: (avg(a)), (count(DISTINCT b)), (count(DISTINCT c))
   ->  Vector Aggregate
         Output: avg(a), count(DISTINCT b), count(DISTINCT c)
         Group By Key: ()
         ->  CStore Scan on hw_groupingsets.vec_t1
               Output: a, b, c
(7 rows)

explain (verbose on, costs off) select a, count(distinct b), count(distinct b) from vec_t1 group by rollup(a, b);
                         QUERY PLAN                         
------------------------------------------------------------
 Row Adapter
   Output: a, (count(DISTINCT b)), (count(DISTINCT b)), b
   ->  Vector Sort Aggregate
         Output: a, count(DISTINCT b), count(DISTINCT b), b
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a
         Group By Key: ()
         ->  Vector Sort
               Output: a, b
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b
(12 rows)

explain (verbose on, costs off) select a, count(distinct b), count(distinct c) from vec_t1 group by rollup(a, b);
                         QUERY PLAN                         
------------------------------------------------------------
 Row Adapter
   Output: a, (count(DISTINCT b)), (count(DISTINCT c)), b
   ->  Vector Sort Aggregate
         Output: a, count(DISTINCT b), count(DISTINCT c), b
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a
         Group By Key: ()
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(12 rows)

select avg(a), count(distinct b), count(distinct c) from vec_t1 group by () order by 1, 2, 3; 
        avg         | count | count 
--------------------+-------+-------
 5.5000000000000000 |    10 |    10
(1 row)

select a, count(distinct b), count(distinct b) from vec_t1 group by rollup(a, b) order by 1, 2, 3;
 a  | count | count 
----+-------+-------
  1 |     1 |     1
  1 |     1 |     1
  2 |     1 |     1
  2 |     1 |     1
  3 |     1 |     1
  3 |     1 |     1
  4 |     1 |     1
  4 |     1 |     1
  5 |     1 |     1
  5 |     1 |     1
  6 |     1 |     1
  6 |     1 |     1
  7 |     1 |     1
  7 |     1 |     1
  8 |     1 |     1
  8 |     1 |     1
  9 |     1 |     1
  9 |     1 |     1
 10 |     1 |     1
 10 |     1 |     1
    |    10 |    10
(21 rows)

select a, count(distinct b), count(distinct c) from vec_t1 group by rollup(a, b) order by 1, 2, 3;
 a  | count | count 
----+-------+-------
  1 |     1 |     1
  1 |     1 |     1
  2 |     1 |     1
  2 |     1 |     1
  3 |     1 |     1
  3 |     1 |     1
  4 |     1 |     1
  4 |     1 |     1
  5 |     1 |     1
  5 |     1 |     1
  6 |     1 |     1
  6 |     1 |     1
  7 |     1 |     1
  7 |     1 |     1
  8 |     1 |     1
  8 |     1 |     1
  9 |     1 |     1
  9 |     1 |     1
 10 |     1 |     1
 10 |     1 |     1
    |    10 |    10
(21 rows)

explain (verbose on, costs off) select a, sum(c), grouping(c) from vec_t1 group by rollup(a, b), grouping sets(c) order by 1, 2, 3;
                            QUERY PLAN                             
-------------------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), (GROUPING(c)), b, c
   ->  Vector Sort
         Output: a, (sum(c)), (GROUPING(c)), b, c
         Sort Key: vec_t1.a, (sum(vec_t1.c)), (GROUPING(vec_t1.c))
         ->  Vector Sort Aggregate
               Output: a, sum(c), GROUPING(c), b, c
               Group By Key: vec_t1.c, vec_t1.a, vec_t1.b
               Group By Key: vec_t1.c, vec_t1.a
               Group By Key: vec_t1.c
               ->  Vector Sort
                     Output: a, b, c
                     Sort Key: vec_t1.c, vec_t1.a, vec_t1.b
                     ->  CStore Scan on hw_groupingsets.vec_t1
                           Output: a, b, c
(15 rows)

explain (verbose on, costs off) select a, sum(c), grouping(c) from vec_t1 group by rollup(a, b), cube(c) order by 1, 2, 3;
                            QUERY PLAN                             
-------------------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), (GROUPING(c)), b, c
   ->  Vector Sort
         Output: a, (sum(c)), (GROUPING(c)), b, c
         Sort Key: vec_t1.a, (sum(vec_t1.c)), (GROUPING(vec_t1.c))
         ->  Vector Sort Aggregate
               Output: a, sum(c), GROUPING(c), b, c
               Group By Key: vec_t1.a, vec_t1.b, vec_t1.c
               Group By Key: vec_t1.a, vec_t1.b
               Group By Key: vec_t1.a
               Group By Key: ()
               Sort Key: vec_t1.c, vec_t1.a
                 Group By Key: vec_t1.c, vec_t1.a
                 Group By Key: vec_t1.c
               ->  Vector Sort
                     Output: a, b, c
                     Sort Key: vec_t1.a, vec_t1.b, vec_t1.c
                     ->  CStore Scan on hw_groupingsets.vec_t1
                           Output: a, b, c
(19 rows)

select a, sum(c), grouping(c) from vec_t1 group by rollup(a, b), grouping sets(c) order by 1, 2, 3;
 a  | sum | grouping 
----+-----+----------
  1 |   1 |        0
  1 |   1 |        0
  2 |   2 |        0
  2 |   2 |        0
  3 |   3 |        0
  3 |   3 |        0
  4 |   4 |        0
  4 |   4 |        0
  5 |   5 |        0
  5 |   5 |        0
  6 |   6 |        0
  6 |   6 |        0
  7 |   7 |        0
  7 |   7 |        0
  8 |   8 |        0
  8 |   8 |        0
  9 |   9 |        0
  9 |   9 |        0
 10 |  10 |        0
 10 |  10 |        0
    |   1 |        0
    |   2 |        0
    |   3 |        0
    |   4 |        0
    |   5 |        0
    |   6 |        0
    |   7 |        0
    |   8 |        0
    |   9 |        0
    |  10 |        0
(30 rows)

select a, sum(c), grouping(c) from vec_t1 group by rollup(a, b), cube(c) order by 1, 2, 3;
 a  | sum | grouping 
----+-----+----------
  1 |   1 |        0
  1 |   1 |        0
  1 |   1 |        1
  1 |   1 |        1
  2 |   2 |        0
  2 |   2 |        0
  2 |   2 |        1
  2 |   2 |        1
  3 |   3 |        0
  3 |   3 |        0
  3 |   3 |        1
  3 |   3 |        1
  4 |   4 |        0
  4 |   4 |        0
  4 |   4 |        1
  4 |   4 |        1
  5 |   5 |        0
  5 |   5 |        0
  5 |   5 |        1
  5 |   5 |        1
  6 |   6 |        0
  6 |   6 |        0
  6 |   6 |        1
  6 |   6 |        1
  7 |   7 |        0
  7 |   7 |        0
  7 |   7 |        1
  7 |   7 |        1
  8 |   8 |        0
  8 |   8 |        0
  8 |   8 |        1
  8 |   8 |        1
  9 |   9 |        0
  9 |   9 |        0
  9 |   9 |        1
  9 |   9 |        1
 10 |  10 |        0
 10 |  10 |        0
 10 |  10 |        1
 10 |  10 |        1
    |   1 |        0
    |   2 |        0
    |   3 |        0
    |   4 |        0
    |   5 |        0
    |   6 |        0
    |   7 |        0
    |   8 |        0
    |   9 |        0
    |  10 |        0
    |  55 |        1
(51 rows)

explain (verbose on, costs off) select a, sum(c), grouping(c) from vec_t1 group by cube(a, b), grouping sets(c) order by 1, 2, 3;
                            QUERY PLAN                             
-------------------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), (GROUPING(c)), b, c
   ->  Vector Sort
         Output: a, (sum(c)), (GROUPING(c)), b, c
         Sort Key: vec_t1.a, (sum(vec_t1.c)), (GROUPING(vec_t1.c))
         ->  Vector Sort Aggregate
               Output: a, sum(c), GROUPING(c), b, c
               Group By Key: vec_t1.c, vec_t1.a, vec_t1.b
               Group By Key: vec_t1.c, vec_t1.a
               Group By Key: vec_t1.c
               Sort Key: vec_t1.b, vec_t1.c
                 Group By Key: vec_t1.b, vec_t1.c
               ->  Vector Sort
                     Output: a, b, c
                     Sort Key: vec_t1.c, vec_t1.a, vec_t1.b
                     ->  CStore Scan on hw_groupingsets.vec_t1
                           Output: a, b, c
(17 rows)

select a, sum(c), grouping(c) from vec_t1 group by cube(a, b), grouping sets(c) order by 1, 2, 3;
 a  | sum | grouping 
----+-----+----------
  1 |   1 |        0
  1 |   1 |        0
  2 |   2 |        0
  2 |   2 |        0
  3 |   3 |        0
  3 |   3 |        0
  4 |   4 |        0
  4 |   4 |        0
  5 |   5 |        0
  5 |   5 |        0
  6 |   6 |        0
  6 |   6 |        0
  7 |   7 |        0
  7 |   7 |        0
  8 |   8 |        0
  8 |   8 |        0
  9 |   9 |        0
  9 |   9 |        0
 10 |  10 |        0
 10 |  10 |        0
    |   1 |        0
    |   1 |        0
    |   2 |        0
    |   2 |        0
    |   3 |        0
    |   3 |        0
    |   4 |        0
    |   4 |        0
    |   5 |        0
    |   5 |        0
    |   6 |        0
    |   6 |        0
    |   7 |        0
    |   7 |        0
    |   8 |        0
    |   8 |        0
    |   9 |        0
    |   9 |        0
    |  10 |        0
    |  10 |        0
(40 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by grouping sets(a);
                    QUERY PLAN                     
---------------------------------------------------
 Row Adapter
   Output: a, (sum(c))
   ->  Vector Sonic Hash Aggregate
         Output: a, sum(c)
         Group By Key: vec_t1.a
         ->  CStore Scan on hw_groupingsets.vec_t1
               Output: a, c
(7 rows)

select a, sum(c)  from vec_t1 group by grouping sets(a) order by 1, 2;
 a  | sum 
----+-----
  1 |   1
  2 |   2
  3 |   3
  4 |   4
  5 |   5
  6 |   6
  7 |   7
  8 |   8
  9 |   9
 10 |  10
(10 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by cube(a, b), grouping sets(a);
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), b
   ->  Vector Sort Aggregate
         Output: a, sum(c), b
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a
         Group By Key: vec_t1.a
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

select a, sum(c)  from vec_t1 group by cube(a, b), grouping sets(a) order by 1, 2;
 a  | sum 
----+-----
  1 |   1
  1 |   1
  1 |   1
  1 |   1
  2 |   2
  2 |   2
  2 |   2
  2 |   2
  3 |   3
  3 |   3
  3 |   3
  3 |   3
  4 |   4
  4 |   4
  4 |   4
  4 |   4
  5 |   5
  5 |   5
  5 |   5
  5 |   5
  6 |   6
  6 |   6
  6 |   6
  6 |   6
  7 |   7
  7 |   7
  7 |   7
  7 |   7
  8 |   8
  8 |   8
  8 |   8
  8 |   8
  9 |   9
  9 |   9
  9 |   9
  9 |   9
 10 |  10
 10 |  10
 10 |  10
 10 |  10
(40 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by cube(a, b), a;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), b
   ->  Vector Sort Aggregate
         Output: a, sum(c), b
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a
         Group By Key: vec_t1.a
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

select a, sum(c)  from vec_t1 group by cube(a, b), a order by 1, 2;
 a  | sum 
----+-----
  1 |   1
  1 |   1
  1 |   1
  1 |   1
  2 |   2
  2 |   2
  2 |   2
  2 |   2
  3 |   3
  3 |   3
  3 |   3
  3 |   3
  4 |   4
  4 |   4
  4 |   4
  4 |   4
  5 |   5
  5 |   5
  5 |   5
  5 |   5
  6 |   6
  6 |   6
  6 |   6
  6 |   6
  7 |   7
  7 |   7
  7 |   7
  7 |   7
  8 |   8
  8 |   8
  8 |   8
  8 |   8
  9 |   9
  9 |   9
  9 |   9
  9 |   9
 10 |  10
 10 |  10
 10 |  10
 10 |  10
(40 rows)

explain (verbose on, costs off) select a, sum(c), avg(b) from vec_t1 group by rollup(a, b), grouping sets(a);
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), (avg(b)), b
   ->  Vector Sort Aggregate
         Output: a, sum(c), avg(b), b
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a
         Group By Key: vec_t1.a
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(12 rows)

select a, sum(c), avg(b)  from vec_t1 group by rollup(a, b), grouping sets(a) order by 1, 2;
 a  | sum |          avg           
----+-----+------------------------
  1 |   1 | 1.00000000000000000000
  1 |   1 | 1.00000000000000000000
  1 |   1 | 1.00000000000000000000
  2 |   2 |     2.0000000000000000
  2 |   2 |     2.0000000000000000
  2 |   2 |     2.0000000000000000
  3 |   3 |     3.0000000000000000
  3 |   3 |     3.0000000000000000
  3 |   3 |     3.0000000000000000
  4 |   4 |     4.0000000000000000
  4 |   4 |     4.0000000000000000
  4 |   4 |     4.0000000000000000
  5 |   5 |     5.0000000000000000
  5 |   5 |     5.0000000000000000
  5 |   5 |     5.0000000000000000
  6 |   6 |     6.0000000000000000
  6 |   6 |     6.0000000000000000
  6 |   6 |     6.0000000000000000
  7 |   7 |     7.0000000000000000
  7 |   7 |     7.0000000000000000
  7 |   7 |     7.0000000000000000
  8 |   8 |     8.0000000000000000
  8 |   8 |     8.0000000000000000
  8 |   8 |     8.0000000000000000
  9 |   9 |     9.0000000000000000
  9 |   9 |     9.0000000000000000
  9 |   9 |     9.0000000000000000
 10 |  10 |    10.0000000000000000
 10 |  10 |    10.0000000000000000
 10 |  10 |    10.0000000000000000
(30 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by rollup(a, b), a;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), b
   ->  Vector Sort Aggregate
         Output: a, sum(c), b
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a
         Group By Key: vec_t1.a
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(12 rows)

select a, sum(c)  from vec_t1 group by rollup(a, b), a order by 1, 2;
 a  | sum 
----+-----
  1 |   1
  1 |   1
  1 |   1
  2 |   2
  2 |   2
  2 |   2
  3 |   3
  3 |   3
  3 |   3
  4 |   4
  4 |   4
  4 |   4
  5 |   5
  5 |   5
  5 |   5
  6 |   6
  6 |   6
  6 |   6
  7 |   7
  7 |   7
  7 |   7
  8 |   8
  8 |   8
  8 |   8
  9 |   9
  9 |   9
  9 |   9
 10 |  10
 10 |  10
 10 |  10
(30 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by grouping sets(a, b);
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), b
   ->  Vector Sort Aggregate
         Output: a, sum(c), b
         Group By Key: vec_t1.a
         Sort Key: vec_t1.b
           Group By Key: vec_t1.b
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(12 rows)

explain (verbose on, costs off) select a, b, sum(c)  from vec_t1 group by grouping sets(a, b) having grouping(a) = 0;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, b, (sum(c))
   ->  Vector Sort Aggregate
         Output: a, b, sum(c)
         Group By Key: vec_t1.a
         Sort Key: vec_t1.b
           Group By Key: vec_t1.b
         Filter: (GROUPING(vec_t1.a) = 0)
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

select a, b, sum(c)  from vec_t1 group by grouping sets(a, b) having grouping(a) = 0 order by 1, 2, 3;
 a  | b | sum 
----+---+-----
  1 |   |   1
  2 |   |   2
  3 |   |   3
  4 |   |   4
  5 |   |   5
  6 |   |   6
  7 |   |   7
  8 |   |   8
  9 |   |   9
 10 |   |  10
(10 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by grouping sets(a) having grouping(a) = 0;
                    QUERY PLAN                     
---------------------------------------------------
 Row Adapter
   Output: a, (sum(c))
   ->  Vector Sonic Hash Aggregate
         Output: a, sum(c)
         Group By Key: vec_t1.a
         Filter: (GROUPING(vec_t1.a) = 0)
         ->  CStore Scan on hw_groupingsets.vec_t1
               Output: a, c
(8 rows)

select a, sum(c)  from vec_t1 group by grouping sets(a) having grouping(a) = 0 order by 1, 2;
 a  | sum 
----+-----
  1 |   1
  2 |   2
  3 |   3
  4 |   4
  5 |   5
  6 |   6
  7 |   7
  8 |   8
  9 |   9
 10 |  10
(10 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by grouping sets(a, b) having sum(a) = 1;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), b
   ->  Vector Sort Aggregate
         Output: a, sum(c), b
         Group By Key: vec_t1.a
         Sort Key: vec_t1.b
           Group By Key: vec_t1.b
         Filter: (sum(vec_t1.a) = 1)
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by grouping sets(a, b) having sum(b) = 1;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), b
   ->  Vector Sort Aggregate
         Output: a, sum(c), b
         Group By Key: vec_t1.a
         Sort Key: vec_t1.b
           Group By Key: vec_t1.b
         Filter: (sum(vec_t1.b) = 1)
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by a, grouping sets(b, c) having sum(b) > 10;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), b, c
   ->  Vector Sort Aggregate
         Output: a, sum(c), b, c
         Group By Key: vec_t1.a, vec_t1.b
         Sort Key: vec_t1.a, vec_t1.c
           Group By Key: vec_t1.a, vec_t1.c
         Filter: (sum(vec_t1.b) > 10)
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

explain (verbose on, costs off) select a, sum(c)  from vec_t1 group by grouping sets(a, b) having sum(a)+sum(b) > 1 or grouping(a)=0;
                                     QUERY PLAN                                      
-------------------------------------------------------------------------------------
 Row Adapter
   Output: a, (sum(c)), b
   ->  Vector Sort Aggregate
         Output: a, sum(c), b
         Group By Key: vec_t1.a
         Sort Key: vec_t1.b
           Group By Key: vec_t1.b
         Filter: (((sum(vec_t1.a) + sum(vec_t1.b)) > 1) OR (GROUPING(vec_t1.a) = 0))
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

explain (verbose on, costs off) select a, b, sum(c)  from vec_t1 group by rollup(a, b) having b is not null;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, b, (sum(c))
   ->  Vector Sort Aggregate
         Output: a, b, sum(c)
         Group By Key: vec_t1.a, vec_t1.b
         Group By Key: vec_t1.a
         Group By Key: ()
         Filter: (vec_t1.b IS NOT NULL)
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

select a, b, sum(c)  from vec_t1 group by rollup(a, b) having b is not null order by 1,2,3;
 a  | b  | sum 
----+----+-----
  1 |  1 |   1
  2 |  2 |   2
  3 |  3 |   3
  4 |  4 |   4
  5 |  5 |   5
  6 |  6 |   6
  7 |  7 |   7
  8 |  8 |   8
  9 |  9 |   9
 10 | 10 |  10
(10 rows)

explain (verbose on, costs off) select a, b, sum(c)  from vec_t1 group by a, grouping sets(b, c) having b is not null;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: a, b, (sum(c)), c
   ->  Vector Sort Aggregate
         Output: a, b, sum(c), c
         Group By Key: vec_t1.a, vec_t1.b
         Sort Key: vec_t1.a, vec_t1.c
           Group By Key: vec_t1.a, vec_t1.c
         Filter: (vec_t1.b IS NOT NULL)
         ->  Vector Sort
               Output: a, b, c
               Sort Key: vec_t1.a, vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: a, b, c
(13 rows)

select a, b, sum(c)  from vec_t1 group by a, grouping sets(b, c) having b is not null order by 1,2,3;
 a  | b  | sum 
----+----+-----
  1 |  1 |   1
  2 |  2 |   2
  3 |  3 |   3
  4 |  4 |   4
  5 |  5 |   5
  6 |  6 |   6
  7 |  7 |   7
  8 |  8 |   8
  9 |  9 |   9
 10 | 10 |  10
(10 rows)

SELECT 1 Column_006 GROUP BY cube(Column_006) order by 1 nulls first;
 column_006 
------------
           
          1
(2 rows)

explain (verbose on, costs off) select distinct b from vec_t1 group by a, grouping sets(b, c);
                          QUERY PLAN                           
---------------------------------------------------------------
 Row Adapter
   Output: b, a, c
   ->  Vector Sonic Hash Aggregate
         Output: b, a, c
         Group By Key: vec_t1.b
         ->  Vector Sort Aggregate
               Output: b, a, c
               Group By Key: vec_t1.a, vec_t1.b
               Sort Key: vec_t1.a, vec_t1.c
                 Group By Key: vec_t1.a, vec_t1.c
               ->  Vector Sort
                     Output: b, a, c
                     Sort Key: vec_t1.a, vec_t1.b
                     ->  CStore Scan on hw_groupingsets.vec_t1
                           Output: b, a, c
(15 rows)

explain (verbose on, costs off) select avg(distinct b) from vec_t1 group by grouping sets(b, c) having avg(distinct b) > 600;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: (avg(DISTINCT b)), b, c
   ->  Vector Sort Aggregate
         Output: avg(DISTINCT b), b, c
         Group By Key: vec_t1.b
         Sort Key: vec_t1.c
           Group By Key: vec_t1.c
         Filter: (avg(DISTINCT vec_t1.b) > 600::numeric)
         ->  Vector Sort
               Output: b, c
               Sort Key: vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: b, c
(13 rows)

explain (verbose on, costs off) select avg(distinct b) from vec_t1 group by grouping sets(b, c) having sum(distinct b) > 600;
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: (avg(DISTINCT b)), b, c
   ->  Vector Sort Aggregate
         Output: avg(DISTINCT b), b, c
         Group By Key: vec_t1.b
         Sort Key: vec_t1.c
           Group By Key: vec_t1.c
         Filter: (sum(DISTINCT vec_t1.b) > 600)
         ->  Vector Sort
               Output: b, c
               Sort Key: vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: b, c
(13 rows)

explain (verbose on, costs off) select avg(distinct a) from vec_t1 group by grouping sets(b, c);
                       QUERY PLAN                        
---------------------------------------------------------
 Row Adapter
   Output: (avg(DISTINCT a)), b, c
   ->  Vector Sort Aggregate
         Output: avg(DISTINCT a), b, c
         Group By Key: vec_t1.b
         Sort Key: vec_t1.c
           Group By Key: vec_t1.c
         ->  Vector Sort
               Output: b, c, a
               Sort Key: vec_t1.b
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: b, c, a
(12 rows)

explain (verbose on, costs off) select a, b, b from vec_t1 group by rollup(1, 2), 3 order by 1, 2, 3;
                          QUERY PLAN                           
---------------------------------------------------------------
 Row Adapter
   Output: a, b, b
   ->  Vector Sort
         Output: a, b, b
         Sort Key: vec_t1.a, vec_t1.b
         ->  Vector Sort Aggregate
               Output: a, b, b
               Group By Key: vec_t1.b, vec_t1.a
               Group By Key: vec_t1.b, vec_t1.a
               Group By Key: vec_t1.b
               ->  Vector Sort
                     Output: a, b
                     Sort Key: vec_t1.b, vec_t1.a
                     ->  CStore Scan on hw_groupingsets.vec_t1
                           Output: a, b
(15 rows)

analyze vec_t1;
explain (verbose on, costs off) select a, grouping(a) from vec_t1 where 0 = 1 group by a;
                    QUERY PLAN                     
---------------------------------------------------
 Row Adapter
   Output: a, (NULL::integer)
   ->  Vector Result
         Output: a, NULL::integer
         One-Time Filter: false
         ->  CStore Scan on hw_groupingsets.vec_t1
               Output: a
(7 rows)

-- test AP func with const target list used in setop branch
-- hashagg subplan
explain (costs off, verbose on)
select 1 from vec_t1 minus SELECT 1 Column_006 where 1=0 GROUP BY cube(Column_006);
                          QUERY PLAN                           
---------------------------------------------------------------
 Row Adapter
   Output: (1), (0)
   ->  Vector HashSetOp Except
         Output: (1), (0)
         ->  Vector Append
               ->  Vector Subquery Scan on "*SELECT* 1"
                     Output: 1, 0
                     ->  CStore Scan on hw_groupingsets.vec_t1
                           Output: 1
               ->  Vector Subquery Scan on "*SELECT* 2"
                     Output: "*SELECT* 2".column_006, 1
                     ->  Vector Sort Aggregate
                           Output: (1)
                           Group By Key: (1)
                           Group By Key: ()
                           ->  Vector Adapter
                                 Output: (1)
                                 ->  Result
                                       Output: 1
                                       One-Time Filter: false
(20 rows)

select 1 from vec_t1 minus SELECT 1 Column_006 where 1=0 GROUP BY cube(Column_006);
 ?column? 
----------
        1
(1 row)

-- non-hashagg subplan
explain (costs off, verbose on)
select 1 from vec_t1 minus (SELECT 1 Column_006 where 1=0 GROUP BY cube(Column_006) limit 1);
                             QUERY PLAN                             
--------------------------------------------------------------------
 Row Adapter
   Output: (1), (0)
   ->  Vector HashSetOp Except
         Output: (1), (0)
         ->  Vector Append
               ->  Vector Subquery Scan on "*SELECT* 1"
                     Output: 1, 0
                     ->  CStore Scan on hw_groupingsets.vec_t1
                           Output: 1
               ->  Vector Subquery Scan on "*SELECT* 2"
                     Output: "*SELECT* 2".column_006, 1
                     ->  Vector Limit
                           Output: (1)
                           ->  Vector Sort Aggregate
                                 Output: (1)
                                 Group By Key: (1)
                                 Group By Key: ()
                                 ->  Vector Adapter
                                       Output: (1)
                                       ->  Result
                                             Output: 1
                                             One-Time Filter: false
(22 rows)

select 1 from vec_t1 minus (SELECT 1 Column_006 where 1=0 GROUP BY cube(Column_006) limit 1);
 ?column? 
----------
        1
(1 row)

-- stream added plan 
explain (costs off, verbose on)
select 1,1 from vec_t1 union SELECT 2 c1, 2 c2 from vec_t1 where 1=0 GROUP BY cube(c1, c2);
                             QUERY PLAN                              
---------------------------------------------------------------------
 Row Adapter
   Output: (1), (1)
   ->  Vector Sonic Hash Aggregate
         Output: (1), (1)
         Group By Key: (1), (1)
         ->  Vector Append
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: 1, 1
               ->  Vector Sort Aggregate
                     Output: (2), (2)
                     Group By Key: 2, 2
                     Group By Key: 2
                     Group By Key: ()
                     Sort Key: 2
                       Group By Key: 2
                     ->  Vector Result
                           Output: 2, 2
                           One-Time Filter: false
                           ->  CStore Scan on hw_groupingsets.vec_t1
                                 Output: 'Dummy'
(20 rows)

select 1,1 from vec_t1 union SELECT 2 c1, 2 c2 from vec_t1 where 1=0 GROUP BY cube(c1, c2) order by 1;
 ?column? | ?column? 
----------+----------
        1 |        1
          |         
(2 rows)

explain (costs off, verbose on)
select 1,1 from vec_t1 union SELECT 2 c1, count(distinct(b)) from vec_t1 where 1=0 GROUP BY cube(a, c1);
                                                QUERY PLAN                                                 
-----------------------------------------------------------------------------------------------------------
 Row Adapter
   Output: (1), ((1)::bigint)
   ->  Vector Sonic Hash Aggregate
         Output: (1), ((1)::bigint)
         Group By Key: (1), ((1)::bigint)
         ->  Vector Append
               ->  Vector Subquery Scan on "*SELECT* 1"
                     Output: 1, 1
                     ->  CStore Scan on hw_groupingsets.vec_t1
                           Output: 1, 1
               ->  Vector Subquery Scan on "*SELECT* 2"
                     Output: "*SELECT* 2".c1, "*SELECT* 2".count
                     ->  Vector Sort Aggregate
                           Output: (2), count(DISTINCT hw_groupingsets.vec_t1.b), hw_groupingsets.vec_t1.a
                           Group By Key: hw_groupingsets.vec_t1.a, (2)
                           Group By Key: hw_groupingsets.vec_t1.a
                           Group By Key: ()
                           Sort Key: (2)
                             Group By Key: (2)
                           ->  Vector Sort
                                 Output: (2), hw_groupingsets.vec_t1.a, hw_groupingsets.vec_t1.b
                                 Sort Key: hw_groupingsets.vec_t1.a, (2)
                                 ->  Vector Result
                                       Output: 2, hw_groupingsets.vec_t1.a, hw_groupingsets.vec_t1.b
                                       One-Time Filter: false
                                       ->  CStore Scan on hw_groupingsets.vec_t1
                                             Output: hw_groupingsets.vec_t1.a, hw_groupingsets.vec_t1.b
(27 rows)

select 1,1 from vec_t1 union SELECT 2 c1, count(distinct(b)) from vec_t1 where 1=0 GROUP BY cube(a, c1) order by 1;
 ?column? | ?column? 
----------+----------
        1 |        1
          |        0
(2 rows)

-- const column in AP func and non-AP func
explain (costs off, verbose on)
select 1,1,1 from vec_t1 union SELECT 2 c1, 2 c2, 4 c3 from vec_t1 where 1=0 GROUP BY cube(c1, c2);
                             QUERY PLAN                              
---------------------------------------------------------------------
 Row Adapter
   Output: (1), (1), (1)
   ->  Vector Sonic Hash Aggregate
         Output: (1), (1), (1)
         Group By Key: (1), (1), (1)
         ->  Vector Append
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: 1, 1, 1
               ->  Vector Sort Aggregate
                     Output: (2), (2), 4
                     Group By Key: 2, 2
                     Group By Key: 2
                     Group By Key: ()
                     Sort Key: 2
                       Group By Key: 2
                     ->  Vector Result
                           Output: 2, 2
                           One-Time Filter: false
                           ->  CStore Scan on hw_groupingsets.vec_t1
                                 Output: 'Dummy'
(20 rows)

select 1,1,1 from vec_t1 union SELECT 2 c1, 2 c2, 4 c3 from vec_t1 where 1=0 GROUP BY cube(c1, c2) order by 1;
 ?column? | ?column? | ?column? 
----------+----------+----------
        1 |        1 |        1
          |          |        4
(2 rows)

-- unknown type
explain (costs off, verbose on)
select 1, '1' from vec_t1 union select 1, '243' xx from vec_t1 where 1=0 group by cube(1);
                             QUERY PLAN                              
---------------------------------------------------------------------
 Row Adapter
   Output: (1), ('1'::text)
   ->  Vector Sonic Hash Aggregate
         Output: (1), ('1'::text)
         Group By Key: (1), ('1'::text)
         ->  Vector Append
               ->  CStore Scan on hw_groupingsets.vec_t1
                     Output: 1, '1'::text
               ->  Vector Sort Aggregate
                     Output: (1), '243'::text
                     Group By Key: 1
                     Group By Key: ()
                     ->  Vector Result
                           Output: 1
                           One-Time Filter: false
                           ->  CStore Scan on hw_groupingsets.vec_t1
                                 Output: 'Dummy'
(17 rows)

select 1, '1' from vec_t1 union select 1, '243' xx from vec_t1 where 1=0 group by cube(1) order by 1;
 ?column? | ?column? 
----------+----------
        1 | 1
          | 243
(2 rows)

create table temp_grouping_table as select a, b, c from vec_t1 group by grouping sets(a, b), rollup(b), cube(c);
\o xml_explain_temp.txt
explain (format xml) select a, b, c from vec_t1 group by rollup(a, b, c);
explain (format JSON) select a, b, c from vec_t1 group by rollup(a, b, c);
explain (format YAML) select a, b, c from vec_t1 group by rollup(a, b, c);
\o
drop table vec_t1;
create table vec_t1(a int)with(orientation = column);
insert into vec_t1 values(1);
select 1 a, 2, count(*) from vec_t1 group by cube(1, 2) having count(*) = 1 order by 1, 2;  
 a | ?column? | count 
---+----------+-------
 1 |        2 |     1
 1 |          |     1
   |        2 |     1
   |          |     1
(4 rows)

drop table vec_t1;
drop table temp_grouping_table;
drop table vec_aptest;
drop table gstest1;
drop table gstest2;
drop table gstest3;
drop table gstest_empty;
-- adjust distribute key from equivalence class
create table adj_t(a varchar(10), b varchar(10));
drop table adj_t;
create table hash_partition_002
(
    abstime_02 abstime,
    bit_02 bit(2),
    blob_02 blob,
    bytea_02 bytea,
    int2_02 SMALLINT,
    int4_02 INTEGER,
    int8_02 BIGINT,
    nvarchar2_02 NVARCHAR2(100),
    raw_02 raw,
    reltime_02 reltime,
    text_02 text,
    varbit_02 varbit,
    varchar_02 varchar(50),
    bpchar_02 bpchar(60),
    date_02 date,
    timestamp_02 timestamp,
    timestamptz_02 timestamptz
)partition by range(date_02)
(
    partition p1 start('0002-01-01') end ('0006-01-01') every('1 year'),
    partition p2 end(maxvalue)
);
create table hash_partition_003
(
    abstime_03 abstime,
    bit_03 bit(3),
    blob_03 blob,
    bytea_03 bytea,
    int2_03 SMALLINT,
    int4_03 INTEGER,
    int8_03 BIGINT,
    nvarchar2_03 NVARCHAR2(100),
    raw_03 raw,
    reltime_03 reltime,
    text_03 text,
    varbit_03 varbit,
    varchar_03 varchar(50),
    bpchar_03 bpchar(60),
    date_03 date,
    timestamp_03 timestamp,
    timestamptz_03 timestamptz
)partition by range(timestamp_03)
(
    partition p1 start('0003-01-01') end ('0006-01-01') every('1 year'),
    partition p2 end(maxvalue)
);
insert into hash_partition_002 values ('1999-01-01',B'10','9999999999999',E'\\000',-32768,-2147483648,-9223372036854775808,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_002 values ('1999-01-01',B'11','9999999999999',E'\\000',32767,2147483647,9223372036854775807,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_002 values ('1999-01-01',B'01','9999999999999',E'\\000',32767,2147483647,9223372036854775807,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_002 values ('1999-01-01',B'11','9999999999999',E'\\000',-32768,-2147483648,-9223372036854775808,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_002 values ('1999-01-01',B'10','9999999999999',E'\\000',-32768,-2147483648,-9223372036854775808,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_002 values ('1999-01-01',B'11','9999999999999',E'\\000',-32768,-2147483648,-9223372036854775808,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_003 values ('1999-01-01',B'101','9999999999999',E'\\000',-32768,-2147483648,-9223372036854775808,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_003 values ('1999-01-01',B'110','9999999999999',E'\\000',32767,2147483647,9223372036854775807,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_003 values ('1999-01-01',B'011','9999999999999',E'\\000',32767,2147483647,9223372036854775807,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_003 values ('1999-01-01',B'010','9999999999999',E'\\000',-32768,-2147483648,-9223372036854775808,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_003 values ('1999-01-01',B'001','9999999999999',E'\\000',-32768,-2147483648,-9223372036854775808,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
insert into hash_partition_003 values ('1999-01-01',B'111','9999999999999',E'\\000',-32768,-2147483648,-9223372036854775808,0.115145415,'DEADBEEF',' 2009 days 23:59:59','XXXXXXXXXXXXXXXXX ',B'1101100011','0.222','1212','2011-01-01','0002-09-09 23:59:59','0003-09-09 00:02:01');
SELECT
    nullif(bit_02,varbit_03) as a , 
    varbit_02::bit,
    '01' lx,
    'v_dt' ::VARCHAR AS rq
FROM hash_partition_002 left join hash_partition_003 on bit_02 = varbit_03 or varbit_03>bit_02 
WHERE rq = 'v_dt'
GROUP BY bit_02, varbit_03,varbit_02,
rollup(text_03,int4_03,nvarchar2_02,varchar_02)
having max(abstime_03)::int <> 1
order by 1, 2, 3, 4;
 a  | varbit_02 | lx |  rq  
----+-----------+----+------
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
(24 rows)

select 
    distinct(count(bit_03)),
    length(varbit_03),
    'ee'::text as a
from hash_partition_002 right join hash_partition_003  on  varbit_03>bit_02  
group by  bit_03, varbit_03,rollup(varbit_03,bit_03,'ee'::text)
HAVING count(1)>0
order by 1, 2, 3;
 count | length | a  
-------+--------+----
     6 |     10 | ee
     6 |     10 | 
(2 rows)

SELECT
    count(bit_02)
FROM hash_partition_002
GROUP BY bit_02,rollup(text_02)
HAVING max(abstime_02)::int <> 1;
 count 
-------
     1
     1
     2
     2
     3
     3
(6 rows)

SELECT
    nullif(bit_02,varbit_03) as a , 
    varbit_02::bit,
    '01' lx,
    'v_dt' ::VARCHAR AS rq
FROM hash_partition_002 left join hash_partition_003 on bit_02 = varbit_03 or varbit_03>bit_02 
WHERE rq = 'v_dt'
GROUP BY bit_02, varbit_03,varbit_02,
rollup(text_03,int4_03,nvarchar2_02,varchar_02)
having max(abstime_03)::int <> 1
order by 1, 2, 3, 4;
 a  | varbit_02 | lx |  rq  
----+-----------+----+------
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 01 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 10 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
 11 | 1         | 01 | v_dt
(24 rows)

select 
    distinct(count(bit_03)),
    length(varbit_03),
    'ee'::text as a
from hash_partition_002 right join hash_partition_003  on  varbit_03>bit_02  
group by  bit_03, varbit_03,rollup(varbit_03,bit_03,'ee'::text)
HAVING count(1)>0
order by 1, 2, 3;
 count | length | a  
-------+--------+----
     6 |     10 | ee
     6 |     10 | 
(2 rows)

SELECT
    bit_02
FROM hash_partition_002
GROUP BY bit_02,rollup(text_02)
HAVING max(abstime_02)::int <> 1
ORDER BY 1;
 bit_02 
--------
 01
 01
 10
 10
 11
 11
(6 rows)

SELECT
    count(bit_02)
FROM hash_partition_002
GROUP BY bit_02,rollup(text_02)
HAVING max(abstime_02)::int <> 1
ORDER BY 1;
 count 
-------
     1
     1
     2
     2
     3
     3
(6 rows)

drop schema hw_groupingsets cascade;
NOTICE:  drop cascades to 2 other objects
DETAIL:  drop cascades to table hash_partition_002
drop cascades to table hash_partition_003

set enable_compress_hll = on;
create schema hll_func;
set current_schema = hll_func;
create table test(id int);
create table test1(id int);
insert into test values (generate_series(1,5));
insert into test1 values (generate_series(1,500));
--------------CONTENTS--------------------
-- hyperloglog compare function test cases
------------------------------------------
--1. hll_eq hll_ne
--2. smallint integer bigint
--3. bytea text
--4. hll_hash_any
------------------------------------------
------------------------------------------
-- 1. compare function
------------------------------------------
select hll_eq((hll_empty() || hll_hash_integer(1)), (hll_empty() || hll_hash_integer(1) || hll_hash_integer(2)));
 hll_eq 
--------
 f
(1 row)

select hll_ne((hll_empty() || hll_hash_integer(1)), (hll_empty() || hll_hash_integer(1) || hll_hash_integer(2)));
 hll_ne 
--------
 t
(1 row)

-- test hll_eq with four parameters, default paramters are (11, 5, -1, 1)
select hll_eq((hll_empty() || hll_hash_integer(1)), (hll_empty(10,5,-1,1) || hll_hash_integer(1)));
 hll_eq 
--------
 f
(1 row)

select hll_eq((hll_empty() || hll_hash_integer(1)), (hll_empty(11,5,-1,0) || hll_hash_integer(1)));
 hll_eq 
--------
 f
(1 row)

select hll_eq((hll_empty() || hll_hash_integer(1)), (hll_empty(11,4,-1,1) || hll_hash_integer(1)));
 hll_eq 
--------
 f
(1 row)

select hll_eq((hll_empty() || hll_hash_integer(1)), (hll_empty(11,5,0,1) || hll_hash_integer(1)));
 hll_eq 
--------
 f
(1 row)

-- test hll_ne with four parameter, default paramters are (11, 5, -1, 1)
select hll_ne((hll_empty() || hll_hash_integer(1)), (hll_empty(10,5,-1,1) || hll_hash_integer(1)));
 hll_ne 
--------
 t
(1 row)

select hll_ne((hll_empty() || hll_hash_integer(1)), (hll_empty(11,5,-1,0) || hll_hash_integer(1)));
 hll_ne 
--------
 t
(1 row)

select hll_ne((hll_empty() || hll_hash_integer(1)), (hll_empty(11,4,-1,1) || hll_hash_integer(1)));
 hll_ne 
--------
 t
(1 row)

select hll_ne((hll_empty() || hll_hash_integer(1)), (hll_empty(11,5,0,1) || hll_hash_integer(1)));
 hll_ne 
--------
 t
(1 row)

select hll_hashval_eq(hll_hash_integer(1), hll_hash_integer(1));
 hll_hashval_eq 
----------------
 t
(1 row)

select hll_hashval_ne(hll_hash_integer(1), hll_hash_integer(1));
 hll_hashval_ne 
----------------
 f
(1 row)

-- test hll_hashval_eq and hll_hashval_ne with hash seed
select hll_hashval_eq(hll_hash_integer(1), hll_hash_integer(1,123));
 hll_hashval_eq 
----------------
 f
(1 row)

select hll_hashval_ne(hll_hash_integer(1), hll_hash_integer(1,123));
 hll_hashval_ne 
----------------
 t
(1 row)

select hll_hashval_ne(hll_hash_integer(1), hll_hash_integer(1,0));
 hll_hashval_ne 
----------------
 f
(1 row)

------------------------------------------
-- 2. debug function
------------------------------------------
select hll_print(hll_empty());
                         hll_print                         
-----------------------------------------------------------
 EMPTY, nregs=2048, nbits=5, expthresh=-1(160), sparseon=1
(1 row)

select hll_print(hll_empty(10,5,-1,1));
                        hll_print                         
----------------------------------------------------------
 EMPTY, nregs=1024, nbits=5, expthresh=-1(80), sparseon=1
(1 row)

select hll_print(hll_empty() || E'\\x108b7f');
                          hll_print                           
--------------------------------------------------------------
 UNDEFINED nregs=2048, nbits=5, expthresh=-1(160), sparseon=1
(1 row)

select hll_print(hll_union_agg(hll_add_value))
    from (
        select hll_add_agg(hll_hash_integer(id)) hll_add_value from test
        );
                                 hll_print                                 
---------------------------------------------------------------------------
 EXPLICIT, 5 elements, nregs=2048, nbits=5, expthresh=-1(160), sparseon=1:+
 0: -8604791237420463362                                                  +
 1: -2734554653617988768                                                  +
 2:  2072756739463403504                                                  +
 3:  5208657608173592891                                                  +
 4:  6655367218388208063 
(1 row)

select hll_print(hll_union_agg(hll_add_value))
	from (
		select hll_add_agg(hll_hash_integer(id)) hll_add_value from test1
		);
                                               hll_print                                                
--------------------------------------------------------------------------------------------------------
 COMPRESSED, 454 filled nregs=2048, nbits=5, expthresh=-1(160), sparseon=1:                            +
    0:  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0 +
   32:  0  0  0  0  0  1  1  0  1  4  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  2  0  5  0  3  0 +
   64:  0  0  0  0  0  1  0  3  0  3  0  0  0  0  0  0  0  0  2  2  0  1  1  0  2  0  0  0  0  1  0  5 +
   96:  0  5  0  0  0  0  0  0  0  0  0  0  0  0  2  1  0  1  0  0  3  0  0  0  1  0  0  0  0  0  0  0 +
  128:  0  0  0  0  0  2  1  0  0  0  5  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  3  1  0  0  0 +
  160:  1  2  1  0  1  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  1  0  2  0  0  0  0 +
  192:  0  0  8  0  2  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  2  0  0  3  0  0  0  0  0  0  0  0 +
  224:  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  2  0  0 +
  256:  0  3  0  0  0  2  0  3  0  0  0  0  0  1  0  0  0  0  0  1  0  3  0  2  0  1  0  0  0  2  0  0 +
  288:  0  0  0  0  0  0  0  1  0  0  0  0  0  1  2  0  0  0  0  3  5  0  0  0  0  0  5  3  0  3  1  0 +
  320:  1  0  0  0  0  0  0  2  0  0  0  1  0  0  0  5  0  0  0  0  0  1  0  0  0  0  2  0  1  0  0  0 +
  352:  0  0  0  0  0  1  0  0  0  2  3  0  1  4  0  0  0  0  1  5  0  0  0  1  1  1  0  0  0  0  0  2 +
  384:  0  0  0  0  1  6  0  0  0  0  0  0 10  0  0  0  1  0  0  0  0  2  1  0  1  0  0  0  0  0  0  3 +
  416:  0  0  0  0  0  0  0  1  0  0  0  0  0  5  0  2  0  2  1  0  2  2  0  0  0  1  2  0  0  0  0  1 +
  448:  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  2  2  0  0  0  0  0 +
  480:  1  4  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  1  0  0  4  0  0  0  0  2  0  0  0  3 +
  512:  0  0  0  0  5  0  0  3  0  0  3  0  5  0  0  0  0  0  0  0  0  0  0  1  4  0  1  0  0  0  0  0 +
  544:  0  0  0  0  0  0  5  0  0  0  0  0  4  1  0  0  0  0  0  0  0  0  3  1  1  0  0  0  0  1  0  0 +
  576:  1  0  0  0  0  2  0  1  0  0  1  0  0  0  0  0  3  0  0  0  0  1  0  0  1  1  0  0  0  0  0  0 +
  608:  0  0  2  0  1  0  5  3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0 +
  640:  0  0  0  0  2  0  1  0  4  0  0  0  0  0  0  0  1  0  0  0  3  0  0  2  1  1  0  0  1  2  0  0 +
  672:  0  0  0  0  0  0  0  1  0  0  0  1  2  1  0  0  0  0  1  1  0  1  0  0  0  0  2  0  0  0  0  1 +
  704:  0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0  0  1  0  0  0  0  2  0  0  6  0  1  0  0  0  0 +
  736:  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  3 +
  768:  0  0  0  0  0  0  0  0  1  0  4  0  1  0  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 +
  800:  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  0  2  0  0  1  3  0  0  0  0  0  0  0  0  0  0 +
  832:  0  2  0  0  1  0  0  0  0  2  0  0  0  0  0  2  0  0  1  2  0  1  0  0  0  0  0  0  0  0  0  0 +
  864:  1  1  2  0  1  0  0  0  0  0  1  7  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 +
  896:  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  1  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0  0 +
  928:  0  1  0  0  2  3  0  0  0  0  0  1  3  0  0  0  0  1  0  0  0  0  0  0  0  0  1  0  1  0  0  0 +
  960:  0  0  0  0  0  1  0  0  2  0  0  0  0  1  0  0  0  0  1  3  1  1  3  0  3  0  0  1  0  0  0  0 +
  992:  0  4  2  0  0  0  1  0  2  0  0  7  0  0  0  0  0  3  0  0  0  0  0  0  1  0  4  1  0  0  0  0 +
 1024:  0  0  0  0  0  0  0  1  1  0  0  2  0  2  0  0  5  0  0  3  0  0  0  1  0  0  0  0  0  0  0  0 +
 1056:  0  0  0  1  0  0  0  1  0  0  1  0  2  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0  1 +
 1088:  1  0  0  1  0  0  0  4  1  1  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  1  1  0  3  0 +
 1120:  0  1  0  0  0  1  0  0  3  0  0  0  0  0  0  4  1  0  0  0  0  2  0  0  0  0  0  0  0  0  0  0 +
 1152:  0  0  0  1  0  1  0  0  0  1  0  0  0  0  2  0  0  0  4  1  0  1  2  3  0  7  0  0  2  0  0  1 +
 1184:  0  0  0  0  0  1  0  5  0  0  0  0  0  5  0  4  0  0  0  0  2  0  1  0  2  0  0  0  0  0  0  0 +
 1216:  0  0  0  0  1  3  2  0  0  0  0  0  0  1  0  2  0  0  0  0  0  0  0  0  2  3  1  0  0  0  0  1 +
 1248:  0  0  1  0  2  0  0  4  0  0  0  0  0  1  0  2  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  0 +
 1280:  0  0  0  0  0  0  0  1  0  0  0  0  1  0  0  1  0  0  0  0  3  0  0  1  0  1  0  0  1  0  0  0 +
 1312:  0  2  0  0  1  0  1  0  3  2  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0 +
 1344:  0  0  0  0  2  1  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  0  0  0  0  2  3  0  0 +
 1376:  0  0  0  0  0  0  2  0  0  0  0  0  3  0  0  2  1  0  0  0  7  0  0  0  0  0  1  0  0  0  0  0 +
 1408:  0  0  0  0  0  1  2  1  1  0  2  1  0  0  0  0  0  0  0  0  2  0  0  0  0  0  1  0  3  0  1  1 +
 1440:  0  0  3  0  0  0  0  0  4  0  0  0  1  0  0  0  4  0  2  0  4  0  0  0  0  0  0  0  0  0  0  0 +
 1472:  1  0  0  0  0  0  0  0  0  0  4  0  4  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  1  0 +
 1504:  1  0  0  0  1  0  0  0  2  0  0  1  0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0 +
 1536:  0  0  0  0  0  0  2  0  0  0  0  2  0  0  0  0  0  0  0  3  1  0  0  0  0  0  0  0  0  0  0  0 +
 1568:  0  0  0  0  0  3  0  0  1  0  1  0  0  0  0  0  0  2  0  0  0  0  7  0  0  0  0  0  1  1  0  0 +
 1600:  0  0  0  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  1  1  0  3  0  0  0  0  0  0  0 +
 1632:  0  0  0  0  5  0  0  0  3  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  3  0  2  2  0  0  0  0 +
 1664:  0  1  0  0  2  0  0  0  0  3  0  0  0  0  0  0  0  3  0  0  0  1  1  5  0  0  0  0  0  0  0  0 +
 1696:  0  0  0  0  0  0  3  0  0  0  2  0  0  0  0  0  6  0  0  2  6  0  0  1  0  0  4  1  0  0  0  0 +
 1728:  0  0  0  0  0  1  0  0  1  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1 +
 1760:  0  0  0  2  0  2  0  0  2  0  0  0  0  0  0  0  3  0  0  0  0  0  0  3  0  0  2  0  1  1  0  2 +
 1792:  1  0  0  0  1  2  1  2  2  0  1  0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0  2  1  0  0  0 +
 1824:  0  0  2  0  0  0  0  3  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  3 +
 1856:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  1  0  0  2  0  0  1  0 +
 1888:  0  0  0  0  0  0  2  0  0  0  2  0  0  0  1  0  2  2  0  2  0  0  0  0  0  0  0  0  1  1  0  0 +
 1920:  0  0  0  0  0  2  0  0  2  0  1  0  0  2  1  0  3  1  0  0  0  0  5  0  1  0  0  1  0  0  0  0 +
 1952:  0  0  0  0  4  0  0  0  0  0  0  2  0  0  4  0  0  0  0  0  0  0  2  0  2  0  0  3  0  0  0  0 +
 1984:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  4  0  0  0  0  1  0  3  0  0  0  0  0  0 +
 2016:  0  0  1  0  4  0  0  0  1  0  2  0  0  0  1  0  2  0  0  0  0  1  0  6  2  5  0  0  0  0  0  0 
(1 row)

select hll_schema_version(hll_empty());
 hll_schema_version 
--------------------
                  1
(1 row)

select hll_regwidth(hll_empty());
 hll_regwidth 
--------------
            5
(1 row)

select hll_regwidth(hll_empty(11,5));
 hll_regwidth 
--------------
            5
(1 row)

select hll_expthresh(hll_empty());
 hll_expthresh 
---------------
 (-1,160)
(1 row)

select hll_expthresh(hll_empty(11,5,0));
 hll_expthresh 
---------------
 (0,0)
(1 row)

select hll_sparseon(hll_empty());
 hll_sparseon 
--------------
            1
(1 row)

select hll_sparseon(hll_empty(11,5,-1,0));
 hll_sparseon 
--------------
            0
(1 row)

select hll_log2m(hll_empty());
 hll_log2m 
-----------
        11
(1 row)

select hll_log2m(hll_empty(10));
 hll_log2m 
-----------
        10
(1 row)

select hll_type(hll_empty());
 hll_type 
----------
        1
(1 row)

------------------------------------------
-- 3. operator function
------------------------------------------
select (hll_empty() || hll_hash_integer(1)) = (hll_empty() || hll_hash_integer(1));
 ?column? 
----------
 t
(1 row)

select (hll_empty() || hll_hash_integer(1)) <> (hll_empty() || hll_hash_integer(2));
 ?column? 
----------
 t
(1 row)

select (hll_hash_integer(1) || hll_empty()) = (hll_hash_integer(1) || hll_empty());
 ?column? 
----------
 t
(1 row)

select hll_cardinality((hll_empty() || hll_hash_integer(1)) || (hll_empty() || hll_hash_integer(2)));
 hll_cardinality 
-----------------
               2
(1 row)

select #((hll_empty() || hll_hash_integer(1)) || (hll_empty() || hll_hash_integer(2)));
 ?column? 
----------
        2
(1 row)

select hll_hash_integer(1) = hll_hash_integer(1);
 ?column? 
----------
 t
(1 row)

select hll_hash_integer(1) <> hll_hash_integer(1);
 ?column? 
----------
 f
(1 row)

-- test with hll parameters, default paramters are (11, 5, -1, 1)
select (hll_empty() || hll_hash_integer(1)) = (hll_empty(10,5,-1,1) || hll_hash_integer(1));
 ?column? 
----------
 f
(1 row)

select (hll_empty() || hll_hash_integer(1)) <> (hll_empty(10,5,-1,1) || hll_hash_integer(1));
 ?column? 
----------
 t
(1 row)

select hll_empty(11,5,3,1) = hll_empty(11,5,3,1);
 ?column? 
----------
 t
(1 row)

select hll_empty(11,5,3,1) = hll_empty(11,5,3,0);
 ?column? 
----------
 f
(1 row)

select hll_empty(11,5,3,1) = hll_empty(11,5,7,1);
 ?column? 
----------
 f
(1 row)

select hll_empty(11,5,3,1) = hll_empty(11,4,3,1);
 ?column? 
----------
 f
(1 row)

select hll_empty(11,5,3,1) = hll_empty(10,5,3,1);
 ?column? 
----------
 f
(1 row)

-- ERROR:	hll with different parameters cannot union
select hll_cardinality((hll_empty() || hll_hash_integer(1)) || (hll_empty(10,5,-1,1) || hll_hash_integer(2)));
ERROR:  register count does not match: source uses 1024 and dest uses 2048
CONTEXT:  referenced column: hll_cardinality
select hll_hash_integer(1) = hll_hash_integer(1,123);
 ?column? 
----------
 f
(1 row)

select hll_hash_integer(1) <> hll_hash_integer(1,123);
 ?column? 
----------
 t
(1 row)

------------------------------------------
-- 4. cast function
------------------------------------------
-- Empty Casts ----
SELECT E'\\x118b7f'::hll;
   hll    
----------
 \x118b7f
(1 row)

SELECT E'\\x118b7f'::hll(11,5,-1,1);
   hll    
----------
 \x118b7f
(1 row)

-- ERROR:  register count does not match: source uses 2048 and dest uses 1024
SELECT E'\\x118b7f'::hll(10,5,-1,1);
ERROR:  register count does not match: source uses 2048 and dest uses 1024
CONTEXT:  referenced column: hll
-- ERROR:  register width does not match: source uses 5 and dest uses 4
SELECT E'\\x118b7f'::hll(11,4,-1,1);
ERROR:  register width does not match: source uses 5 and dest uses 4
CONTEXT:  referenced column: hll
-- ERROR:  explicit threshold does not match: source uses -1 and dest uses 64
SELECT E'\\x118b7f'::hll(11,5,6,1);
ERROR:  explicit threshold does not match: source uses -1 and dest uses 64
CONTEXT:  referenced column: hll
-- ERROR:  sparse enable does not match: source uses 1 and dest uses 0
SELECT E'\\x118b7f'::hll(11,5,-1,0);
ERROR:  sparse enable does not match: source uses 1 and dest uses 0
CONTEXT:  referenced column: hll
-- Explicit Vector Casts ----
SELECT E'\\x128b7f1111111111111111'::hll;
           hll            
--------------------------
 \x128b7f1111111111111111
(1 row)

SELECT E'\\x128b7f1111111111111111'::hll(11,5,-1,1);
           hll            
--------------------------
 \x128b7f1111111111111111
(1 row)

-- ERROR:  register count does not match: source uses 2048 and dest uses 1024
SELECT E'\\x128b7f1111111111111111'::hll(10,5,-1,1);
ERROR:  register count does not match: source uses 2048 and dest uses 1024
CONTEXT:  referenced column: hll
-- ERROR:  register width does not match: source uses 5 and dest uses 4
SELECT E'\\x128b7f1111111111111111'::hll(11,4,-1,1);
ERROR:  register width does not match: source uses 5 and dest uses 4
CONTEXT:  referenced column: hll
-- ERROR:  explicit threshold does not match: source uses -1 and dest uses 64
SELECT E'\\x128b7f1111111111111111'::hll(11,5,6,1);
ERROR:  explicit threshold does not match: source uses -1 and dest uses 64
CONTEXT:  referenced column: hll
-- ERROR:  sparse enable does not match: source uses 1 and dest uses 0
SELECT E'\\x128b7f1111111111111111'::hll(11,5,-1,0);
ERROR:  sparse enable does not match: source uses 1 and dest uses 0
CONTEXT:  referenced column: hll
-- Sparse Vector Casts ----
SELECT E'\\x138b7f0001'::hll;
     hll      
--------------
 \x138b7f0001
(1 row)

SELECT E'\\x138b7f0001'::hll(11,5,-1,1);
     hll      
--------------
 \x138b7f0001
(1 row)

-- ERROR:  register count does not match: source uses 2048 and dest uses 1024
SELECT E'\\x138b7f0001'::hll(10,5,-1,1);
ERROR:  register count does not match: source uses 2048 and dest uses 1024
CONTEXT:  referenced column: hll
-- ERROR:  register width does not match: source uses 5 and dest uses 4
SELECT E'\\x138b7f0001'::hll(11,4,-1,1);
ERROR:  register width does not match: source uses 5 and dest uses 4
CONTEXT:  referenced column: hll
-- ERROR:  explicit threshold does not match: source uses -1 and dest uses 64
SELECT E'\\x138b7f0001'::hll(11,5,6,1);
ERROR:  explicit threshold does not match: source uses -1 and dest uses 64
CONTEXT:  referenced column: hll
-- ERROR:  sparse enable does not match: source uses 1 and dest uses 0
SELECT E'\\x138b7f0001'::hll(11,5,-1,0);
ERROR:  sparse enable does not match: source uses 1 and dest uses 0
CONTEXT:  referenced column: hll
-- Compressed Vector Casts ----
SELECT E'\\x148b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000'::hll;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   hll                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 \x148b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000
(1 row)

SELECT E'\\x148b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000'::hll(11,5,-1,1);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   hll                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 \x148b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000
(1 row)

-- ERROR:  register count does not match: source uses 2048 and dest uses 1024
SELECT E'\\x148b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000'::hll(10,5,-1,1);
ERROR:  register count does not match: source uses 2048 and dest uses 1024
CONTEXT:  referenced column: hll
-- ERROR:  register width does not match: source uses 5 and dest uses 4
SELECT E'\\x148b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000'::hll(11,4,-1,1);
ERROR:  register width does not match: source uses 5 and dest uses 4
CONTEXT:  referenced column: hll
-- ERROR:  explicit threshold does not match: source uses -1 and dest uses 64
SELECT E'\\x148b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000'::hll(11,5,6,1);
ERROR:  explicit threshold does not match: source uses -1 and dest uses 64
CONTEXT:  referenced column: hll
-- ERROR:  sparse enable does not match: source uses 1 and dest uses 0
SELECT E'\\x148b7f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000'::hll(11,5,-1,0);
ERROR:  sparse enable does not match: source uses 1 and dest uses 0
CONTEXT:  referenced column: hll
-- cleaning up
drop table test;
drop table test1;
--final cleaning up
drop schema hll_func cascade;
reset current_schema;

--function test
select gs_encrypt_aes128('along','1234@abc');
select gs_decrypt_aes128(gs_encrypt_aes128('along','1234@abc'),'1234@abc');
select gs_decrypt_aes128(gs_encrypt_aes128('world','1234@abc'),'abc@4321');           --difference key cause error
select gs_decrypt_aes128('h0pTXTyPJ3zEaXdv6ArxHEXl77RhCG84q+V80uYtcXV+OwPu3SDI5iTPG+LoH4AX+MqIrwRcl7xhaC5/WIk2iMP6LRc=','abc@4321');		--difference key cause mac error
select gs_encrypt_aes128('along','1234@abc5678abcdefghi');					--key longer than 16 Byte cause error
select gs_decrypt_aes128('along','1234@abc');								--wrong cipher cause error
select gs_decrypt_aes128('sfwsniPmaP57t8ICMkPy9dgKWGvfNpsxX9AWYDJnv9qYShAniNVVinz2DjUln4Uk+MqIrwRcl7xhaC5/WIk2iMP6LRc=','1234@abc');
--insert/select test
create table aes_table(name text);
insert into aes_table values(gs_encrypt_aes128('he@#llo','1234@abc'));		--special characters
select gs_decrypt_aes128(name,'1234@abc') from aes_table order by 1;
drop table aes_table;
--column type test
create table aes_type_bytea(name bytea);
create table aes_type_varchar(name varchar(100));
create table aes_type_nvarchar2(name nvarchar2(100));
create table aes_type_int(id int);
create table aes_type_numeric(id numeric);
insert into aes_type_bytea values(gs_encrypt_aes128('along','1234@abc'));
insert into aes_type_varchar values(gs_encrypt_aes128('along','1234@abc'));
insert into aes_type_nvarchar2 values(gs_encrypt_aes128('along','1234@abc'));
insert into aes_type_int values(gs_encrypt_aes128('along','1234@abc'));
insert into aes_type_numeric values(gs_encrypt_aes128('along','1234@abc'));
drop table aes_type_bytea;
drop table aes_type_varchar;
drop table aes_type_nvarchar2;
drop table aes_type_int;
drop table aes_type_numeric;
--data type test
create table aes_data_type(c1 int4, c2 int8, c3 numeric(18,2), c4 float8, c5 money, c6 boolean, c7 varchar(15), c8 text, c9 date, c10 bytea);
insert into aes_data_type values(123456,654321,123.21,654321.123456,100,TRUE,'varchar','text','2017-12-07', 'bytea');
create table aes_data_encrypt(e1 text, e2 text, e3 text, e4 text, e5 text, e6 text, e7 text, e8 text, e9 text, e10 text);
insert into aes_data_encrypt select gs_encrypt_aes128(c1,'1234@abc'), gs_encrypt_aes128(c2,'1234@abc'), gs_encrypt_aes128(c3,'1234@abc'),
gs_encrypt_aes128(c4,'1234@abc'), gs_encrypt_aes128(c7,'1234@abc'), gs_encrypt_aes128(c8,'1234@abc'), gs_encrypt_aes128(c9,'1234@abc') from aes_data_type;
select gs_encrypt_aes128(c5,'1234@abc') from aes_data_type;
select gs_encrypt_aes128(c6,'1234@abc') from aes_data_type;
select gs_encrypt_aes128(c10,'1234@abc') from aes_data_type;
drop table aes_data_type;
drop table aes_data_encrypt;
--boundary test
select gs_decrypt_aes128(gs_encrypt_aes128('','1234@abc'),'1234@abc');
select gs_decrypt_aes128(gs_encrypt_aes128('along','1234@abc'),null);
select gs_encrypt_aes128('along',null);
select gs_decrypt_aes128(gs_encrypt_aes128('comeon','1234567@abcdefgh'),'1234567@abcdefgh');
select gs_decrypt_aes128(gs_encrypt_aes128('aessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfalflsasssasdfaessdsllaessdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfassasdfaessdsllaessdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfdfaessasdfasdfasdfsdfadllaessdsllsdlflsasssasdfaessfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessllaessdsllsdlflsasssasdfaessfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessllsdlflsasssasdfaesssdlflssasdfassdllsdlflsasssasdfaesssdlflssasdfassdsdllsdlflsasssasdfaesssdlflssasdfassdaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlllsdlsdlaaabbllsdlsdlaaabbllsdlsdlaaabbdasdfsdfaasdfasdfsdfsdasdfadsadfasdfadsadfasssdlflssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssssssssdlflssassssdlflssasssasssssssdlflssasssasssassssdlflssasssasssssssdssdlfldlflsasssassssdlflssssdlflssasasssassssdlflssasssasssssssdlflssasssasssssssdlflssasssasssasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssssssssssdlfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfalflsasssasdfaessdsllaessdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfassasdfaessdsllaessdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfdsllsdlflsasssasdfaessasdfasdfasdfsdfadfdfadfdfaessasdfasdfasdfsdfadllaessdsllsdlflsasssasdfaessfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessllaessdsllsdlflsasssasdfaessfaessdsllsdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflsasssasdfsdlflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessllsdlflsasssasdfaesssdlflssasdfassdllsdlflsasssasdfaesssdlflssasdfassdsdllsdlflsasssasdfaesssdlflssasdfassdaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlflsasssasdfaessdsllaessdsllsdlflsasssasdfaesssdlflssasdfaessflsasasdfaessflsasssasdfaessllsdlflsasssasdfaesssdlflssasdfassdlflssasdfaessflsasssasdfaessdsllsdlllsdlsdlaaabbllsdlsdlaaabbllsdlsdlaaabbdasdfsdfaasdfasdfsdfsdasdfadsadfasdfadsadfasssdlflssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssdlflssasssassssdlflssaslssassssdlflssasssassssdlflssasssassssdlflssasssassssdlflssasasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssssssssdlflssassssdlflssasssasssssssdlflssasssasssassssdlflssasssasssssssdssdlfldlflsasssassssdlflssssdlflssasasssassssdlflssasssasssssssdlflssasssasssssssdlflssasssasssasssassssdlflssasssassssdlflssasasssassssdlflssasssasssssssdlflssasssassssssssssssdlf','1234@abc'),'1234@abc');
select gs_encrypt_aes128('along','1234');
select gs_decrypt_aes128(gs_encrypt_aes128('comeon','12345678@abcdefgh'),'12345678@abcdefgh');